<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 16 Dependence Modeling | Loss Data Analytics</title>
  <meta name="description" content="Chapter 16 Dependence Modeling | Loss Data Analytics is an interactive, online, freely available text. - The online version will contain many interactive objects (quizzes, computer demonstrations, interactive graphs, video, and the like) to promote deeper learning. - A subset of the book will be available in pdf format for low-cost printing. - The online text will be available in multiple languages to promote access to a worldwide audience." />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 16 Dependence Modeling | Loss Data Analytics" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Chapter 16 Dependence Modeling | Loss Data Analytics is an interactive, online, freely available text. - The online version will contain many interactive objects (quizzes, computer demonstrations, interactive graphs, video, and the like) to promote deeper learning. - A subset of the book will be available in pdf format for low-cost printing. - The online text will be available in multiple languages to promote access to a worldwide audience." />
  <meta name="github-repo" content="https://github.com/openacttexts/Loss-Data-Analytics" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 16 Dependence Modeling | Loss Data Analytics" />
  
  <meta name="twitter:description" content="Chapter 16 Dependence Modeling | Loss Data Analytics is an interactive, online, freely available text. - The online version will contain many interactive objects (quizzes, computer demonstrations, interactive graphs, video, and the like) to promote deeper learning. - A subset of the book will be available in pdf format for low-cost printing. - The online text will be available in multiple languages to promote access to a worldwide audience." />
  

<meta name="author" content="An open text authored by the Actuarial Community" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ChapBonusMalus.html"/>
<link rel="next" href="CAppA.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>

<!-- Mathjax Version 2-->
<script type='text/x-mathjax-config'>
		MathJax.Hub.Config({
			extensions: ['tex2jax.js'],
			jax: ['input/TeX', 'output/HTML-CSS'],
			tex2jax: {
				inlineMath: [ ['$','$'], ['\\(','\\)'] ],
				displayMath: [ ['$$','$$'], ['\\[','\\]'] ],
				processEscapes: true
			},
			'HTML-CSS': { availableFonts: ['TeX'] }
		});
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS_HTML"> </script>


<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script type="text/javascript" src="https://unpkg.com/survey-jquery/survey.jquery.min.js"></script>
<link href="https://unpkg.com/survey-jquery/modern.min.css" type="text/css" rel="stylesheet">
<script src="https://unpkg.com/showdown/dist/showdown.min.js"></script>


<script>
function markdownConverterEWF() {  
//Create showdown markdown converter
var converter = new showdown.Converter();
converter.setOption('ghCompatibleHeaderId', true);
survey
    .onTextMarkdown
    .add(function (survey, options) {
        //convert the markdown text to html
        var str = converter.makeHtml(options.text);
        //remove root paragraphs <p></p>
        str = str.substring(3);
        str = str.substring(0, str.length - 4);
        //set html
        options.html = str;
        MathJax.Hub.Queue(['Typeset',MathJax.Hub, 'options']);
    });  
};

// Quiz Header info
const jsonHeader = { 
    showProgressBar: "bottom",
    showTimerPanel: "none",
    maxTimeToFinishPage: 10000,
    maxTimeToFinish: 25000,
    firstPageIsStarted: true,
    startSurveyText: "Start Quiz" //,
//    title: "Does This Make Sense?"
}


// One and Two question quizzes
function jsonSummary1EWF(json) {  
let jsonEnd1 = { 
completedHtml: 
json["pages"][1]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][1]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][1]["questions"][0]["correctAnswer"]
};  
return jsonEnd1;
};


function jsonSummary2EWF(json) {  
let jsonEnd2 = { 
completedHtml: 
json["pages"][1]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][1]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][1]["questions"][0]["correctAnswer"]
+"<br>"+
json["pages"][2]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][2]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][2]["questions"][0]["correctAnswer"]
};  
return jsonEnd2;
};

// Three, four, and five question quizzes
function jsonSummary3EWF(json) {  
let jsonEnd3 = { 
completedHtml: 
json["pages"][1]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][1]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][1]["questions"][0]["correctAnswer"]
+"<br>"+
json["pages"][2]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][2]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][2]["questions"][0]["correctAnswer"]
+"<br>"+
json["pages"][3]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][3]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][3]["questions"][0]["correctAnswer"]
};  
return jsonEnd3;
};

function jsonSummary4EWF(json) {  
jsonEnd4 = jsonSummary3EWF(json);
jsonEnd4.completedHtml = jsonEnd4.completedHtml +  
"<br>"+
json["pages"][4]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][4]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][4]["questions"][0]["correctAnswer"]
;  
return jsonEnd4;
};

function jsonSummary5EWF(json) {  
jsonEnd5 = jsonSummary4EWF(json);
jsonEnd5.completedHtml = jsonEnd5.completedHtml +  
"<br>"+
json["pages"][5]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][5]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][5]["questions"][0]["correctAnswer"]
;  
return jsonEnd5;
};

function jsonSummary6EWF(json) {  
jsonEnd6 = jsonSummary5EWF(json);
jsonEnd6.completedHtml = jsonEnd6.completedHtml +  
"<br>"+
json["pages"][6]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][6]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][6]["questions"][0]["correctAnswer"]
;  
return jsonEnd6;
};

function jsonSummary7EWF(json) {  
jsonEnd7 = jsonSummary6EWF(json);
jsonEnd7.completedHtml = jsonEnd7.completedHtml +  
"<br>"+
json["pages"][7]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][7]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][7]["questions"][0]["correctAnswer"]
;  
return jsonEnd7;
};

function jsonSummary8EWF(json) {  
jsonEnd8 = jsonSummary7EWF(json);
jsonEnd8.completedHtml = jsonEnd8.completedHtml +  
"<br>"+
json["pages"][8]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][8]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][8]["questions"][0]["correctAnswer"]
;  
return jsonEnd8;
};

function jsonSummary9EWF(json) {  
jsonEnd9 = jsonSummary8EWF(json);
jsonEnd9.completedHtml = jsonEnd9.completedHtml +  
"<br>"+
json["pages"][9]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][9]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][9]["questions"][0]["correctAnswer"]
;  
return jsonEnd9;
};


function jsonSummary10EWF(json) {  
jsonEnd10 = jsonSummary9EWF(json);
jsonEnd10.completedHtml = jsonEnd10.completedHtml +  
"<br>"+
json["pages"][10]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][10]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][10]["questions"][0]["correctAnswer"]
;  
return jsonEnd10;
};


function jsonSummary11EWF(json) {  
jsonEnd11 = jsonSummary10EWF(json);
jsonEnd11.completedHtml = jsonEnd11.completedHtml +  
"<br>"+
json["pages"][11]["questions"][0]["name"]+ "<br>"+
"<i>Question: </i>"+json["pages"][11]["questions"][0]["title"]+"<br>"+
"<i>Answer: </i>"+json["pages"][11]["questions"][0]["correctAnswer"]
;  
return jsonEnd11;
};

Survey.StylesManager.applyTheme("modern");

</script>  
<!-- This completes the code for the quizzes -->

<!-- Various toggle functions used throughout --> 
<script language="javascript">
function toggle(id1,id2) {
	var ele = document.getElementById(id1); var text = document.getElementById(id2);
	if (ele.style.display == "block") {ele.style.display = "none"; text.innerHTML = "Show Solution";}
		else {ele.style.display = "block"; text.innerHTML = "Hide Solution";}}
function togglecode(id1,id2) {
   var ele = document.getElementById(id1); var text = document.getElementById(id2);
   if (ele.style.display == "block") {ele.style.display = "none"; text.innerHTML = "Show R Code";}
      else {ele.style.display = "block"; text.innerHTML = "Hide R Code";}}
function toggleEX(id1,id2) {
   var ele = document.getElementById(id1); var text = document.getElementById(id2);
   if (ele.style.display == "block") {ele.style.display = "none"; text.innerHTML = "Show Example";}
      else {ele.style.display = "block"; text.innerHTML = "Hide Example";}}
function toggleTheory(id1,id2) {
   var ele = document.getElementById(id1); var text = document.getElementById(id2);
   if (ele.style.display == "block") {ele.style.display = "none"; text.innerHTML = "Show Theory";}
      else {ele.style.display = "block"; text.innerHTML = "Hide Theory";}}
function toggleQuiz(id1,id2) {
   var ele = document.getElementById(id1); var text = document.getElementById(id2);
   if (ele.style.display == "block") {ele.style.display = "none"; text.innerHTML = "Show Quiz Solution";}
      else {ele.style.display = "block"; text.innerHTML = "Hide Quiz Solution";}}      
</script>

<!-- A few functions for revealing definitions -->
<script language="javascript">
<!--   $( function() {
    $("#tabs").tabs();
  } ); -->

$(document).ready(function(){
    $('[data-toggle="tooltip"]').tooltip();
});

$(document).ready(function(){
    $('[data-toggle="popover"]').popover(); 
});
</script>

<script language="javascript">
function openTab(evt, tabName) {
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
    }
    tablinks = document.getElementsByClassName("tablinks");
    for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
    }
    document.getElementById(tabName).style.display = "block";
    evt.currentTarget.className += " active";
}

// Get the element with id="defaultOpen" and click on it
document.getElementById("defaultOpen").click();
</script>

<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;
    
    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");
  
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");
  
  var cl = this.classList
  
  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }
  
  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="Format/style.css" type="text/css" />
<link rel="stylesheet" href="includeWebex/webex.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Loss Data Analytics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i>Contributors</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#reviewers"><i class="fa fa-check"></i>Reviewers</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#other-collaborators"><i class="fa fa-check"></i>Other Collaborators</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version"><i class="fa fa-check"></i>Version</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#for-our-readers"><i class="fa fa-check"></i>For our Readers</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="ChapIntro.html"><a href="ChapIntro.html"><i class="fa fa-check"></i><b>1</b> Loss Data and Insurance Activities</a>
<ul>
<li class="chapter" data-level="1.1" data-path="ChapIntro.html"><a href="ChapIntro.html#S:Intro"><i class="fa fa-check"></i><b>1.1</b> Data Driven Insurance Activities</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="ChapIntro.html"><a href="ChapIntro.html#nature-and-relevance-of-insurance"><i class="fa fa-check"></i><b>1.1.1</b> Nature and Relevance of Insurance</a></li>
<li class="chapter" data-level="1.1.2" data-path="ChapIntro.html"><a href="ChapIntro.html#S:DataDriven"><i class="fa fa-check"></i><b>1.1.2</b> Why Data Driven?</a></li>
<li class="chapter" data-level="1.1.3" data-path="ChapIntro.html"><a href="ChapIntro.html#S:InsProcesses"><i class="fa fa-check"></i><b>1.1.3</b> Insurance Processes</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="ChapIntro.html"><a href="ChapIntro.html#S:PredModApps"><i class="fa fa-check"></i><b>1.2</b> Insurance Company Operations</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="ChapIntro.html"><a href="ChapIntro.html#initiating-insurance"><i class="fa fa-check"></i><b>1.2.1</b> Initiating Insurance</a></li>
<li class="chapter" data-level="1.2.2" data-path="ChapIntro.html"><a href="ChapIntro.html#renewing-insurance"><i class="fa fa-check"></i><b>1.2.2</b> Renewing Insurance</a></li>
<li class="chapter" data-level="1.2.3" data-path="ChapIntro.html"><a href="ChapIntro.html#claims-and-product-management"><i class="fa fa-check"></i><b>1.2.3</b> Claims and Product Management</a></li>
<li class="chapter" data-level="1.2.4" data-path="ChapIntro.html"><a href="ChapIntro.html#S:Reserving"><i class="fa fa-check"></i><b>1.2.4</b> Loss Reserving</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="ChapIntro.html"><a href="ChapIntro.html#S:LGPIF"><i class="fa fa-check"></i><b>1.3</b> Case Study: Wisconsin Property Fund</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="ChapIntro.html"><a href="ChapIntro.html#S:OutComes"><i class="fa fa-check"></i><b>1.3.1</b> Fund Claims Variables: Frequency and Severity</a></li>
<li class="chapter" data-level="1.3.2" data-path="ChapIntro.html"><a href="ChapIntro.html#S:FundVariables"><i class="fa fa-check"></i><b>1.3.2</b> Fund Rating Variables</a></li>
<li class="chapter" data-level="1.3.3" data-path="ChapIntro.html"><a href="ChapIntro.html#fund-operations"><i class="fa fa-check"></i><b>1.3.3</b> Fund Operations</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="ChapIntro.html"><a href="ChapIntro.html#exercises"><i class="fa fa-check"></i><b>1.4</b> Exercises</a></li>
<li class="chapter" data-level="1.5" data-path="ChapIntro.html"><a href="ChapIntro.html#Intro-further-reading-and-resources"><i class="fa fa-check"></i><b>1.5</b> Further Resources and Contributors</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html"><i class="fa fa-check"></i><b>2</b> Introduction to Data Analytics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:Elements"><i class="fa fa-check"></i><b>2.1</b> Elements of Data Analytics</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#key-data-analytic-concepts"><i class="fa fa-check"></i><b>2.1.1</b> Key Data Analytic Concepts</a></li>
<li class="chapter" data-level="2.1.2" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:DataAlgorithm"><i class="fa fa-check"></i><b>2.1.2</b> Data versus Algorithmic Modeling</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:Process"><i class="fa fa-check"></i><b>2.2</b> Data Analysis Process</a></li>
<li class="chapter" data-level="2.3" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:SingleVarAnalytics"><i class="fa fa-check"></i><b>2.3</b> Single Variable Analytics</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:VarTypes"><i class="fa fa-check"></i><b>2.3.1</b> Variable Types</a></li>
<li class="chapter" data-level="2.3.2" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:EDACDA"><i class="fa fa-check"></i><b>2.3.2</b> Exploratory versus Confirmatory</a></li>
<li class="chapter" data-level="2.3.3" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#model-construction"><i class="fa fa-check"></i><b>2.3.3</b> Model Construction</a></li>
<li class="chapter" data-level="2.3.4" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#model-selection"><i class="fa fa-check"></i><b>2.3.4</b> Model Selection</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:ManyVarAnalytics"><i class="fa fa-check"></i><b>2.4</b> Analytics with Many Variables</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#supervised-and-unsupervised-learning"><i class="fa fa-check"></i><b>2.4.1</b> Supervised and Unsupervised Learning</a></li>
<li class="chapter" data-level="2.4.2" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#algorithmic-modeling"><i class="fa fa-check"></i><b>2.4.2</b> Algorithmic Modeling</a></li>
<li class="chapter" data-level="2.4.3" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#data-modeling"><i class="fa fa-check"></i><b>2.4.3</b> Data Modeling</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:DataLearn"><i class="fa fa-check"></i><b>2.5</b> Data</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#data-types"><i class="fa fa-check"></i><b>2.5.1</b> Data Types</a></li>
<li class="chapter" data-level="2.5.2" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#data-structures-and-storage"><i class="fa fa-check"></i><b>2.5.2</b> Data Structures and Storage</a></li>
<li class="chapter" data-level="2.5.3" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#data-cleaning"><i class="fa fa-check"></i><b>2.5.3</b> Data Cleaning</a></li>
<li class="chapter" data-level="2.5.4" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#Sec:BigDataAnalysis"><i class="fa fa-check"></i><b>2.5.4</b> Big Data Analysis</a></li>
<li class="chapter" data-level="2.5.5" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#ethical-issues"><i class="fa fa-check"></i><b>2.5.5</b> Ethical Issues</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#DS:further-reading-and-resources"><i class="fa fa-check"></i><b>2.6</b> Further Resources and Contributors</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#S:MultiEDA"><i class="fa fa-check"></i><b>2.6.1</b> Technical Supplement: Multivariate Exploratory Analysis</a></li>
<li class="chapter" data-level="2.6.2" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#tree-based-models"><i class="fa fa-check"></i><b>2.6.2</b> Tree-based Models</a></li>
<li class="chapter" data-level="2.6.3" data-path="ChapDataAnalytics.html"><a href="ChapDataAnalytics.html#technical-supplement-some-r-functions"><i class="fa fa-check"></i><b>2.6.3</b> Technical Supplement: Some R Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html"><i class="fa fa-check"></i><b>3</b> Frequency Modeling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:frequency-distributions"><i class="fa fa-check"></i><b>3.1</b> Frequency Distributions</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:how-frequency-augments-severity-information"><i class="fa fa-check"></i><b>3.1.1</b> How Frequency Augments Severity Information</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:basic-frequency-distributions"><i class="fa fa-check"></i><b>3.2</b> Basic Frequency Distributions</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:foundations"><i class="fa fa-check"></i><b>3.2.1</b> Foundations</a></li>
<li class="chapter" data-level="3.2.2" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:generating-functions"><i class="fa fa-check"></i><b>3.2.2</b> Moment and Probability Generating Functions</a></li>
<li class="chapter" data-level="3.2.3" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:important-frequency-distributions"><i class="fa fa-check"></i><b>3.2.3</b> Important Frequency Distributions</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:the-a-b-0-class"><i class="fa fa-check"></i><b>3.3</b> The (<em>a</em>, <em>b</em>, 0) Class</a></li>
<li class="chapter" data-level="3.4" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:estimating-frequency-distributions"><i class="fa fa-check"></i><b>3.4</b> Estimating Frequency Distributions</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:parameter-estimation"><i class="fa fa-check"></i><b>3.4.1</b> Parameter Estimation</a></li>
<li class="chapter" data-level="3.4.2" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:frequency-distributions-mle"><i class="fa fa-check"></i><b>3.4.2</b> Frequency Distributions MLE</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:other-frequency-distributions"><i class="fa fa-check"></i><b>3.5</b> Other Frequency Distributions</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:zero-truncation-or-modification"><i class="fa fa-check"></i><b>3.5.1</b> Zero Truncation or Modification</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:mixture-distributions"><i class="fa fa-check"></i><b>3.6</b> Mixture Distributions</a></li>
<li class="chapter" data-level="3.7" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:freq-real-example"><i class="fa fa-check"></i><b>3.7</b> Real Data Example</a></li>
<li class="chapter" data-level="3.8" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:exercises"><i class="fa fa-check"></i><b>3.8</b> Exercises</a></li>
<li class="chapter" data-level="3.9" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#Freq-further-reading-and-resources"><i class="fa fa-check"></i><b>3.9</b> Further Resources and Contributors</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="ChapFrequency-Modeling.html"><a href="ChapFrequency-Modeling.html#S:rcode"><i class="fa fa-check"></i><b>3.9.1</b> TS 3.A. R Code for Plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ChapSeverity.html"><a href="ChapSeverity.html"><i class="fa fa-check"></i><b>4</b> Modeling Loss Severity</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:BasicQuantities"><i class="fa fa-check"></i><b>4.1</b> Basic Distributional Quantities</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Chap3Moments"><i class="fa fa-check"></i><b>4.1.1</b> Moments and Moment Generating Functions</a></li>
<li class="chapter" data-level="4.1.2" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:LS:Quantiles"><i class="fa fa-check"></i><b>4.1.2</b> Quantiles</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:ContinuousDistn"><i class="fa fa-check"></i><b>4.2</b> Continuous Distributions for Modeling Loss Severity</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Loss:Gamma"><i class="fa fa-check"></i><b>4.2.1</b> Gamma Distribution</a></li>
<li class="chapter" data-level="4.2.2" data-path="ChapSeverity.html"><a href="ChapSeverity.html#pareto-distribution"><i class="fa fa-check"></i><b>4.2.2</b> Pareto Distribution</a></li>
<li class="chapter" data-level="4.2.3" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:LS:Weibull"><i class="fa fa-check"></i><b>4.2.3</b> Weibull Distribution</a></li>
<li class="chapter" data-level="4.2.4" data-path="ChapSeverity.html"><a href="ChapSeverity.html#the-generalized-beta-distribution-of-the-second-kind"><i class="fa fa-check"></i><b>4.2.4</b> The Generalized Beta Distribution of the Second Kind</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:MethodsCreation"><i class="fa fa-check"></i><b>4.3</b> Methods of Creating New Distributions</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="ChapSeverity.html"><a href="ChapSeverity.html#functions-of-random-variables-and-their-distributions"><i class="fa fa-check"></i><b>4.3.1</b> Functions of Random Variables and their Distributions</a></li>
<li class="chapter" data-level="4.3.2" data-path="ChapSeverity.html"><a href="ChapSeverity.html#mixture-distributions-for-severity"><i class="fa fa-check"></i><b>4.3.2</b> Mixture Distributions for Severity</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="ChapSeverity.html"><a href="ChapSeverity.html#estimating-loss-distributions"><i class="fa fa-check"></i><b>4.4</b> Estimating Loss Distributions</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:MS:NonParEst"><i class="fa fa-check"></i><b>4.4.1</b> Nonparametric Estimation</a></li>
<li class="chapter" data-level="4.4.2" data-path="ChapSeverity.html"><a href="ChapSeverity.html#S:Parametric"><i class="fa fa-check"></i><b>4.4.2</b> Parametric Estimation</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="ChapSeverity.html"><a href="ChapSeverity.html#LM-further-reading-and-resources"><i class="fa fa-check"></i><b>4.5</b> Further Resources and Contributors</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html"><i class="fa fa-check"></i><b>5</b> Modeling Claim Severity</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:CoverageModifications"><i class="fa fa-check"></i><b>5.1</b> Coverage Modifications</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:PolicyDeduct"><i class="fa fa-check"></i><b>5.1.1</b> Policy Deductibles</a></li>
<li class="chapter" data-level="5.1.2" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:PolicyLimits"><i class="fa fa-check"></i><b>5.1.2</b> Policy Limits</a></li>
<li class="chapter" data-level="5.1.3" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#coinsurance-and-inflation"><i class="fa fa-check"></i><b>5.1.3</b> Coinsurance and Inflation</a></li>
<li class="chapter" data-level="5.1.4" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:Chap3Reinsurance"><i class="fa fa-check"></i><b>5.1.4</b> Reinsurance</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:MS:ModifiedData1"><i class="fa fa-check"></i><b>5.2</b> Parametric Estimation using Modified Data</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:MS:GroupedData"><i class="fa fa-check"></i><b>5.2.1</b> Parametric Estimation using Grouped Data</a></li>
<li class="chapter" data-level="5.2.2" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#censored-data"><i class="fa fa-check"></i><b>5.2.2</b> Censored Data</a></li>
<li class="chapter" data-level="5.2.3" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#truncated-data"><i class="fa fa-check"></i><b>5.2.3</b> Truncated Data</a></li>
<li class="chapter" data-level="5.2.4" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#parametric-estimation-using-censored-and-truncated-data"><i class="fa fa-check"></i><b>5.2.4</b> Parametric Estimation using Censored and Truncated Data</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#nonparametric-estimation-using-modified-data"><i class="fa fa-check"></i><b>5.3</b> Nonparametric Estimation using Modified Data</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#grouped-data"><i class="fa fa-check"></i><b>5.3.1</b> Grouped Data</a></li>
<li class="chapter" data-level="5.3.2" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:MS:PlugIn"><i class="fa fa-check"></i><b>5.3.2</b> Plug-in Principle</a></li>
<li class="chapter" data-level="5.3.3" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#S:MS:RightCensored"><i class="fa fa-check"></i><b>5.3.3</b> Right-Censored Empirical Distribution Function</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="ChapClaimSeverity.html"><a href="ChapClaimSeverity.html#CS:further-reading-and-resources"><i class="fa fa-check"></i><b>5.4</b> Further Resources and Contributors</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ChapModelSelection.html"><a href="ChapModelSelection.html"><i class="fa fa-check"></i><b>6</b> Model Selection and Estimation</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ChapModelSelection.html"><a href="ChapModelSelection.html#S:MS:ModelSelection"><i class="fa fa-check"></i><b>6.1</b> Model Selection</a></li>
<li class="chapter" data-level="6.2" data-path="ChapModelSelection.html"><a href="ChapModelSelection.html#S:MS:ToolsModelSelection"><i class="fa fa-check"></i><b>6.2</b> Tools for Model Selection and Diagnostics</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="ChapModelSelection.html"><a href="ChapModelSelection.html#S:MS:GraphComparison"><i class="fa fa-check"></i><b>6.2.1</b> Graphical Comparison of Distributions</a></li>
<li class="chapter" data-level="6.2.2" data-path="ChapModelSelection.html"><a href="ChapModelSelection.html#S:MS:Tools:Stats"><i class="fa fa-check"></i><b>6.2.2</b> Statistical Comparison of Distributions</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="ChapModelSelection.html"><a href="ChapModelSelection.html#S:MS:Iterative:Selection"><i class="fa fa-check"></i><b>6.3</b> Iterative Model Selection</a></li>
<li class="chapter" data-level="6.4" data-path="ChapModelSelection.html"><a href="ChapModelSelection.html#S:MS:Tools:Stats:Likelihood"><i class="fa fa-check"></i><b>6.4</b> Model Selection Based on a Training Dataset</a></li>
<li class="chapter" data-level="6.5" data-path="ChapModelSelection.html"><a href="ChapModelSelection.html#model-selection-based-on-a-test-dataset"><i class="fa fa-check"></i><b>6.5</b> Model Selection Based on a Test Dataset</a></li>
<li class="chapter" data-level="6.6" data-path="ChapModelSelection.html"><a href="ChapModelSelection.html#S:MS:Cross-Validation"><i class="fa fa-check"></i><b>6.6</b> Model Selection Based on Cross-Validation</a></li>
<li class="chapter" data-level="6.7" data-path="ChapModelSelection.html"><a href="ChapModelSelection.html#S:MS:Modified-Data"><i class="fa fa-check"></i><b>6.7</b> Model Selection for Modified Data</a></li>
<li class="chapter" data-level="6.8" data-path="ChapModelSelection.html"><a href="ChapModelSelection.html#MS:further-reading-and-resources"><i class="fa fa-check"></i><b>6.8</b> Further Resources and Contributors</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html"><i class="fa fa-check"></i><b>7</b> Aggregate Loss Models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#introduction"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#individual-risk-model"><i class="fa fa-check"></i><b>7.2</b> Individual Risk Model</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#moments-and-distribution"><i class="fa fa-check"></i><b>7.2.1</b> Moments and Distribution</a></li>
<li class="chapter" data-level="7.2.2" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#aggregate-loss-distribution"><i class="fa fa-check"></i><b>7.2.2</b> Aggregate Loss Distribution</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:AggLoss:CRM"><i class="fa fa-check"></i><b>7.3</b> Collective Risk Model</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#moments-and-distribution-1"><i class="fa fa-check"></i><b>7.3.1</b> Moments and Distribution</a></li>
<li class="chapter" data-level="7.3.2" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#stop-loss-insurance"><i class="fa fa-check"></i><b>7.3.2</b> Stop-loss Insurance</a></li>
<li class="chapter" data-level="7.3.3" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#closed-form-distributions"><i class="fa fa-check"></i><b>7.3.3</b> Closed-form Distributions</a></li>
<li class="chapter" data-level="7.3.4" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:AggLoss:Tweedie"><i class="fa fa-check"></i><b>7.3.4</b> Tweedie Distribution</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#computing-the-aggregate-claims-distribution"><i class="fa fa-check"></i><b>7.4</b> Computing the Aggregate Claims Distribution</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#recursive-method"><i class="fa fa-check"></i><b>7.4.1</b> Recursive Method</a></li>
<li class="chapter" data-level="7.4.2" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#simulation"><i class="fa fa-check"></i><b>7.4.2</b> Simulation</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#effects-of-coverage-modifications"><i class="fa fa-check"></i><b>7.5</b> Effects of Coverage Modifications</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#impact-of-exposure-on-frequency"><i class="fa fa-check"></i><b>7.5.1</b> Impact of Exposure on Frequency</a></li>
<li class="chapter" data-level="7.5.2" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#S:MS:DedImpactClmFreq"><i class="fa fa-check"></i><b>7.5.2</b> Impact of Deductibles on Claim Frequency</a></li>
<li class="chapter" data-level="7.5.3" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#impact-of-policy-modifications-on-aggregate-claims"><i class="fa fa-check"></i><b>7.5.3</b> Impact of Policy Modifications on Aggregate Claims</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#AL-further-reading-and-resources"><i class="fa fa-check"></i><b>7.6</b> Further Resources and Contributors</a>
<ul>
<li class="chapter" data-level="" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#ts-7.a.1.-individual-risk-model-properties"><i class="fa fa-check"></i>TS 7.A.1. Individual Risk Model Properties</a></li>
<li class="chapter" data-level="" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#ts-7.a.2.-relationship-between-probability-generating-functions-of-x_i-and-x_it"><i class="fa fa-check"></i>TS 7.A.2. Relationship Between Probability Generating Functions of <span class="math inline">\(X_i\)</span> and <span class="math inline">\(X_i^T\)</span></a></li>
<li class="chapter" data-level="" data-path="ChapAggLossModels.html"><a href="ChapAggLossModels.html#ts-7.a.3.-moment-generating-function-of-aggregate-loss-s_n-in-example-7.3.8"><i class="fa fa-check"></i>TS 7.A.3. Moment Generating Function of Aggregate Loss <span class="math inline">\(S_N\)</span> in Example 7.3.8</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ChapSimulation.html"><a href="ChapSimulation.html"><i class="fa fa-check"></i><b>8</b> Simulation and Resampling</a>
<ul>
<li class="chapter" data-level="8.1" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:SimulationFundamentals"><i class="fa fa-check"></i><b>8.1</b> Simulation Fundamentals</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="ChapSimulation.html"><a href="ChapSimulation.html#generating-independent-uniform-observations"><i class="fa fa-check"></i><b>8.1.1</b> Generating Independent Uniform Observations</a></li>
<li class="chapter" data-level="8.1.2" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:InverseTransform"><i class="fa fa-check"></i><b>8.1.2</b> Inverse Transform Method</a></li>
<li class="chapter" data-level="8.1.3" data-path="ChapSimulation.html"><a href="ChapSimulation.html#simulation-precision"><i class="fa fa-check"></i><b>8.1.3</b> Simulation Precision</a></li>
<li class="chapter" data-level="8.1.4" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:SimulationStatInference"><i class="fa fa-check"></i><b>8.1.4</b> Simulation and Statistical Inference</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Bootstrap"><i class="fa fa-check"></i><b>8.2</b> Bootstrapping and Resampling</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="ChapSimulation.html"><a href="ChapSimulation.html#bootstrap-foundations"><i class="fa fa-check"></i><b>8.2.1</b> Bootstrap Foundations</a></li>
<li class="chapter" data-level="8.2.2" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:Sim:Precision"><i class="fa fa-check"></i><b>8.2.2</b> Bootstrap Precision: Bias, Standard Deviation, and Mean Square Error</a></li>
<li class="chapter" data-level="8.2.3" data-path="ChapSimulation.html"><a href="ChapSimulation.html#confidence-intervals"><i class="fa fa-check"></i><b>8.2.3</b> Confidence Intervals</a></li>
<li class="chapter" data-level="8.2.4" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:ParametricBootStrap"><i class="fa fa-check"></i><b>8.2.4</b> Parametric Bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:CrossValidation"><i class="fa fa-check"></i><b>8.3</b> Cross-Validation</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="ChapSimulation.html"><a href="ChapSimulation.html#k-fold-cross-validation"><i class="fa fa-check"></i><b>8.3.1</b> k-Fold Cross-Validation</a></li>
<li class="chapter" data-level="8.3.2" data-path="ChapSimulation.html"><a href="ChapSimulation.html#leave-one-out-cross-validation"><i class="fa fa-check"></i><b>8.3.2</b> Leave-One-Out Cross-Validation</a></li>
<li class="chapter" data-level="8.3.3" data-path="ChapSimulation.html"><a href="ChapSimulation.html#cross-validation-and-bootstrap"><i class="fa fa-check"></i><b>8.3.3</b> Cross-Validation and Bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="ChapSimulation.html"><a href="ChapSimulation.html#S:ImportanceSampling"><i class="fa fa-check"></i><b>8.4</b> Importance Sampling</a></li>
<li class="chapter" data-level="8.5" data-path="ChapSimulation.html"><a href="ChapSimulation.html#Simulation:further-reading-and-resources"><i class="fa fa-check"></i><b>8.5</b> Further Resources and Contributors</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="ChapSimulation.html"><a href="ChapSimulation.html#ts-7.a.-bootstrap-applications-in-predictive-modeling"><i class="fa fa-check"></i><b>8.5.1</b> TS 7.A. Bootstrap Applications in Predictive Modeling</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ChBayes.html"><a href="ChBayes.html"><i class="fa fa-check"></i><b>9</b> Bayesian Inference and Modeling</a>
<ul>
<li class="chapter" data-level="9.1" data-path="ChBayes.html"><a href="ChBayes.html#ChBayes:SecIntro"><i class="fa fa-check"></i><b>9.1</b> A Gentle Introduction to Bayesian Statistics</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="ChBayes.html"><a href="ChBayes.html#ChBayes:SubSecBayesVsFreq"><i class="fa fa-check"></i><b>9.1.1</b> Bayesian versus Frequentist Statistics</a></li>
<li class="chapter" data-level="9.1.2" data-path="ChBayes.html"><a href="ChBayes.html#a-brief-history-lesson"><i class="fa fa-check"></i><b>9.1.2</b> A Brief History Lesson</a></li>
<li class="chapter" data-level="9.1.3" data-path="ChBayes.html"><a href="ChBayes.html#ChBayes:SubsecBayesRule"><i class="fa fa-check"></i><b>9.1.3</b> Bayes’ Rule</a></li>
<li class="chapter" data-level="9.1.4" data-path="ChBayes.html"><a href="ChBayes.html#an-introductory-example-of-bayes-rule"><i class="fa fa-check"></i><b>9.1.4</b> An Introductory Example of Bayes’ Rule</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="ChBayes.html"><a href="ChBayes.html#ChBayes:SecBuildingBlocks"><i class="fa fa-check"></i><b>9.2</b> Building Blocks of Bayesian Inference</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="ChBayes.html"><a href="ChBayes.html#ChBayes:SubsecPosterior"><i class="fa fa-check"></i><b>9.2.1</b> Posterior Distribution</a></li>
<li class="chapter" data-level="9.2.2" data-path="ChBayes.html"><a href="ChBayes.html#likelihood-function"><i class="fa fa-check"></i><b>9.2.2</b> Likelihood Function</a></li>
<li class="chapter" data-level="9.2.3" data-path="ChBayes.html"><a href="ChBayes.html#ChBayes:SubsecPrior"><i class="fa fa-check"></i><b>9.2.3</b> Prior Distribution</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="ChBayes.html"><a href="ChBayes.html#ChBayes:SecConjugate"><i class="fa fa-check"></i><b>9.3</b> Conjugate Families</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="ChBayes.html"><a href="ChBayes.html#ChBayes:SubsecBetaBin"><i class="fa fa-check"></i><b>9.3.1</b> The Beta–Binomial Conjugate Family</a></li>
<li class="chapter" data-level="9.3.2" data-path="ChBayes.html"><a href="ChBayes.html#the-gammapoisson-conjugate-family"><i class="fa fa-check"></i><b>9.3.2</b> The Gamma–Poisson Conjugate Family</a></li>
<li class="chapter" data-level="9.3.3" data-path="ChBayes.html"><a href="ChBayes.html#the-normalnormal-conjugate-family"><i class="fa fa-check"></i><b>9.3.3</b> The Normal–Normal Conjugate Family</a></li>
<li class="chapter" data-level="9.3.4" data-path="ChBayes.html"><a href="ChBayes.html#criticism-of-conjugate-family-models"><i class="fa fa-check"></i><b>9.3.4</b> Criticism of Conjugate Family Models</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="ChBayes.html"><a href="ChBayes.html#ChBayes:SecPosterior"><i class="fa fa-check"></i><b>9.4</b> Posterior Simulation</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="ChBayes.html"><a href="ChBayes.html#introduction-to-markov-chain-monte-carlo-methods"><i class="fa fa-check"></i><b>9.4.1</b> Introduction to Markov Chain Monte Carlo Methods</a></li>
<li class="chapter" data-level="9.4.2" data-path="ChBayes.html"><a href="ChBayes.html#the-gibbs-sampler"><i class="fa fa-check"></i><b>9.4.2</b> The Gibbs Sampler</a></li>
<li class="chapter" data-level="9.4.3" data-path="ChBayes.html"><a href="ChBayes.html#the-metropolishastings-algorithm"><i class="fa fa-check"></i><b>9.4.3</b> The Metropolis–Hastings Algorithm</a></li>
<li class="chapter" data-level="9.4.4" data-path="ChBayes.html"><a href="ChBayes.html#ChBayes:SubsecDiag"><i class="fa fa-check"></i><b>9.4.4</b> Markov Chain Diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="ChBayes.html"><a href="ChBayes.html#ChBayes:SecPractice"><i class="fa fa-check"></i><b>9.5</b> Bayesian Inference in Practice</a></li>
<li class="chapter" data-level="9.6" data-path="ChBayes.html"><a href="ChBayes.html#ChBayes:SecFurther"><i class="fa fa-check"></i><b>9.6</b> Further Resources and Contributors</a>
<ul>
<li class="chapter" data-level="" data-path="ChBayes.html"><a href="ChBayes.html#contributors-8"><i class="fa fa-check"></i>Contributors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html"><i class="fa fa-check"></i><b>10</b> Premium Foundations</a>
<ul>
<li class="chapter" data-level="10.1" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:IntroductionRatemaking"><i class="fa fa-check"></i><b>10.1</b> Introduction to Ratemaking</a></li>
<li class="chapter" data-level="10.2" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:AggRateMaking"><i class="fa fa-check"></i><b>10.2</b> Aggregate Ratemaking Methods</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:PurePremium"><i class="fa fa-check"></i><b>10.2.1</b> Pure Premium Method</a></li>
<li class="chapter" data-level="10.2.2" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:LossRatio"><i class="fa fa-check"></i><b>10.2.2</b> Loss Ratio Method</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:PricingPrinciples"><i class="fa fa-check"></i><b>10.3</b> Pricing Principles</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#premium-principles"><i class="fa fa-check"></i><b>10.3.1</b> Premium Principles</a></li>
<li class="chapter" data-level="10.3.2" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#properties-of-premium-principles"><i class="fa fa-check"></i><b>10.3.2</b> Properties of Premium Principles</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:HeterogeneousRisks"><i class="fa fa-check"></i><b>10.4</b> Heterogeneous Risks</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:ExposureToRisk"><i class="fa fa-check"></i><b>10.4.1</b> Exposure to Risk</a></li>
<li class="chapter" data-level="10.4.2" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:RatingFactors"><i class="fa fa-check"></i><b>10.4.2</b> Rating Factors</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:TrendDevelopment"><i class="fa fa-check"></i><b>10.5</b> Development and Trending</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#exposures-and-premiums"><i class="fa fa-check"></i><b>10.5.1</b> Exposures and Premiums</a></li>
<li class="chapter" data-level="10.5.2" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#losses-claims-and-payments"><i class="fa fa-check"></i><b>10.5.2</b> Losses, Claims, and Payments</a></li>
<li class="chapter" data-level="10.5.3" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:CompareMethods"><i class="fa fa-check"></i><b>10.5.3</b> Comparing Pure Premium and Loss Ratio Methods</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#S:GiniStatistic"><i class="fa fa-check"></i><b>10.6</b> Selecting a Premium</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#classic-lorenz-curve"><i class="fa fa-check"></i><b>10.6.1</b> Classic Lorenz Curve</a></li>
<li class="chapter" data-level="10.6.2" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#performance-curve-and-a-gini-statistic"><i class="fa fa-check"></i><b>10.6.2</b> Performance Curve and a Gini Statistic</a></li>
<li class="chapter" data-level="10.6.3" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#out-of-sample-validation"><i class="fa fa-check"></i><b>10.6.3</b> Out-of-Sample Validation</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#further-resources-and-contributors"><i class="fa fa-check"></i><b>10.7</b> Further Resources and Contributors</a>
<ul>
<li class="chapter" data-level="" data-path="ChapPremiumFoundations.html"><a href="ChapPremiumFoundations.html#ts-9.a.-rate-regulation"><i class="fa fa-check"></i>TS 9.A. Rate Regulation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html"><i class="fa fa-check"></i><b>11</b> Risk Classification</a>
<ul>
<li class="chapter" data-level="11.1" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:RC:Introduction"><i class="fa fa-check"></i><b>11.1</b> Introduction</a></li>
<li class="chapter" data-level="11.2" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:RC:PoissonRegression"><i class="fa fa-check"></i><b>11.2</b> Poisson Regression Model</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:RC:Need.Poi.reg"><i class="fa fa-check"></i><b>11.2.1</b> Need for Poisson Regression</a></li>
<li class="chapter" data-level="11.2.2" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#poisson-regression"><i class="fa fa-check"></i><b>11.2.2</b> Poisson Regression</a></li>
<li class="chapter" data-level="11.2.3" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#incorporating-exposure"><i class="fa fa-check"></i><b>11.2.3</b> Incorporating Exposure</a></li>
<li class="chapter" data-level="11.2.4" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#exercises-5"><i class="fa fa-check"></i><b>11.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#S:CatVarMultiTarriff"><i class="fa fa-check"></i><b>11.3</b> Categorical Variables and Multiplicative Tariff</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#rating-factors-and-tariff"><i class="fa fa-check"></i><b>11.3.1</b> Rating Factors and Tariff</a></li>
<li class="chapter" data-level="11.3.2" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#multiplicative-tariff-model"><i class="fa fa-check"></i><b>11.3.2</b> Multiplicative Tariff Model</a></li>
<li class="chapter" data-level="11.3.3" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#poisson-regression-for-multiplicative-tariff"><i class="fa fa-check"></i><b>11.3.3</b> Poisson Regression for Multiplicative Tariff</a></li>
<li class="chapter" data-level="11.3.4" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#numerical-examples"><i class="fa fa-check"></i><b>11.3.4</b> Numerical Examples</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#risk-classification-vs-discrimination"><i class="fa fa-check"></i><b>11.4</b> Risk classification vs Discrimination</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#economic-commodity-vs-social-good"><i class="fa fa-check"></i><b>11.4.1</b> Economic commodity vs social good</a></li>
<li class="chapter" data-level="11.4.2" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#information-asymmetry"><i class="fa fa-check"></i><b>11.4.2</b> Information asymmetry</a></li>
<li class="chapter" data-level="11.4.3" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#sensitive-variables-and-regulation"><i class="fa fa-check"></i><b>11.4.3</b> Sensitive variables and regulation</a></li>
<li class="chapter" data-level="11.4.4" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#big-data-models-and-proxy-discrimination"><i class="fa fa-check"></i><b>11.4.4</b> Big data models and proxy discrimination</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#RC:further-reading-and-resources"><i class="fa fa-check"></i><b>11.5</b> Further Resources and Contributors</a>
<ul>
<li class="chapter" data-level="" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#ts-10.a.-estimating-poisson-regression-models"><i class="fa fa-check"></i>TS 10.A. Estimating Poisson Regression Models</a></li>
<li class="chapter" data-level="" data-path="ChapRiskClass.html"><a href="ChapRiskClass.html#ts-10.b.-selecting-rating-factors"><i class="fa fa-check"></i>TS 10.B. Selecting Rating Factors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ChapCredibility.html"><a href="ChapCredibility.html"><i class="fa fa-check"></i><b>12</b> Experience Rating Using Credibility Theory</a>
<ul>
<li class="chapter" data-level="12.1" data-path="ChapCredibility.html"><a href="ChapCredibility.html#introduction-to-applications-of-credibility-theory"><i class="fa fa-check"></i><b>12.1</b> Introduction to Applications of Credibility Theory</a></li>
<li class="chapter" data-level="12.2" data-path="ChapCredibility.html"><a href="ChapCredibility.html#S:Cred:Buhlmann"><i class="fa fa-check"></i><b>12.2</b> Bühlmann Credibility</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="ChapCredibility.html"><a href="ChapCredibility.html#S:Cred-Weight"><i class="fa fa-check"></i><b>12.2.1</b> Credibility-Weighted Estimate for the Expected Loss</a></li>
<li class="chapter" data-level="12.2.2" data-path="ChapCredibility.html"><a href="ChapCredibility.html#S:EPV-VHM-Z"><i class="fa fa-check"></i><b>12.2.2</b> Credibility <em>Z</em>, <em>EPV</em>, and <em>VHM</em></a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="ChapCredibility.html"><a href="ChapCredibility.html#S:Cred:BayesInf"><i class="fa fa-check"></i><b>12.3</b> Bayesian Inference and Bühlmann Credibility</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="ChapCredibility.html"><a href="ChapCredibility.html#beta-binomial-model"><i class="fa fa-check"></i><b>12.3.1</b> Beta-Binomial Model</a></li>
<li class="chapter" data-level="12.3.2" data-path="ChapCredibility.html"><a href="ChapCredibility.html#Sec:Cred:gammaPoisson"><i class="fa fa-check"></i><b>12.3.2</b> Gamma-Poisson Model</a></li>
<li class="chapter" data-level="12.3.3" data-path="ChapCredibility.html"><a href="ChapCredibility.html#exact-credibility"><i class="fa fa-check"></i><b>12.3.3</b> Exact Credibility</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="ChapCredibility.html"><a href="ChapCredibility.html#bühlmann-straub-credibility"><i class="fa fa-check"></i><b>12.4</b> Bühlmann-Straub Credibility</a></li>
<li class="chapter" data-level="12.5" data-path="ChapCredibility.html"><a href="ChapCredibility.html#S:EstimateCred"><i class="fa fa-check"></i><b>12.5</b> Estimating Credibility Parameters</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="ChapCredibility.html"><a href="ChapCredibility.html#nonparametric-estimation-for-bühlmann-and-bühlmann-straub-models"><i class="fa fa-check"></i><b>12.5.1</b> Nonparametric Estimation for Bühlmann and Bühlmann-Straub Models</a></li>
<li class="chapter" data-level="12.5.2" data-path="ChapCredibility.html"><a href="ChapCredibility.html#semiparametric-estimation-for-bühlmann-and-bühlmann-straub-models"><i class="fa fa-check"></i><b>12.5.2</b> Semiparametric Estimation for Bühlmann and Bühlmann-Straub Models</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="ChapCredibility.html"><a href="ChapCredibility.html#limited-fluctuation-credibility"><i class="fa fa-check"></i><b>12.6</b> Limited Fluctuation Credibility</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="ChapCredibility.html"><a href="ChapCredibility.html#S:frequency"><i class="fa fa-check"></i><b>12.6.1</b> Full Credibility for Claim Frequency</a></li>
<li class="chapter" data-level="12.6.2" data-path="ChapCredibility.html"><a href="ChapCredibility.html#full-credibility-for-aggregate-losses-and-pure-premium"><i class="fa fa-check"></i><b>12.6.2</b> Full Credibility for Aggregate Losses and Pure Premium</a></li>
<li class="chapter" data-level="12.6.3" data-path="ChapCredibility.html"><a href="ChapCredibility.html#full-credibility-for-severity"><i class="fa fa-check"></i><b>12.6.3</b> Full Credibility for Severity</a></li>
<li class="chapter" data-level="12.6.4" data-path="ChapCredibility.html"><a href="ChapCredibility.html#partial-credibility"><i class="fa fa-check"></i><b>12.6.4</b> Partial Credibility</a></li>
<li class="chapter" data-level="12.6.5" data-path="ChapCredibility.html"><a href="ChapCredibility.html#full-credibility-standard-for-limited-fluctuation-credibility"><i class="fa fa-check"></i><b>12.6.5</b> Full Credibility Standard for Limited Fluctuation Credibility</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="ChapCredibility.html"><a href="ChapCredibility.html#balancing-credibility-estimators"><i class="fa fa-check"></i><b>12.7</b> Balancing Credibility Estimators</a></li>
<li class="chapter" data-level="12.8" data-path="ChapCredibility.html"><a href="ChapCredibility.html#Cred-further-reading-and-resources"><i class="fa fa-check"></i><b>12.8</b> Further Resources and Contributors</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html"><i class="fa fa-check"></i><b>13</b> Insurance Portfolio Management including Reinsurance</a>
<ul>
<li class="chapter" data-level="13.1" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#introduction-to-insurance-portfolios"><i class="fa fa-check"></i><b>13.1</b> Introduction to Insurance Portfolios</a></li>
<li class="chapter" data-level="13.2" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#S:Tails"><i class="fa fa-check"></i><b>13.2</b> Tails of Distributions</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#classification-based-on-moments"><i class="fa fa-check"></i><b>13.2.1</b> Classification Based on Moments</a></li>
<li class="chapter" data-level="13.2.2" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#comparison-based-on-limiting-tail-behavior"><i class="fa fa-check"></i><b>13.2.2</b> Comparison Based on Limiting Tail Behavior</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#S:RiskMeasure"><i class="fa fa-check"></i><b>13.3</b> Risk Measures</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#value-at-risk"><i class="fa fa-check"></i><b>13.3.1</b> Value-at-Risk</a></li>
<li class="chapter" data-level="13.3.2" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#expected-shortfall"><i class="fa fa-check"></i><b>13.3.2</b> Expected Shortfall</a></li>
<li class="chapter" data-level="13.3.3" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#Sec:CoherentRiskMeasure"><i class="fa fa-check"></i><b>13.3.3</b> Coherent Risk Measures</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#S:Reinsurance"><i class="fa fa-check"></i><b>13.4</b> Reinsurance</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#S:ProportionalRe"><i class="fa fa-check"></i><b>13.4.1</b> Proportional Reinsurance</a></li>
<li class="chapter" data-level="13.4.2" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#S:NonProportionalRe"><i class="fa fa-check"></i><b>13.4.2</b> Non-Proportional Reinsurance</a></li>
<li class="chapter" data-level="13.4.3" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#S:AdditionalRe"><i class="fa fa-check"></i><b>13.4.3</b> Additional Reinsurance Treaties</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#Sec:PortfolioFurtherReadings"><i class="fa fa-check"></i><b>13.5</b> Further Resources and Contributors</a></li>
<li class="chapter" data-level="13.6" data-path="ChapPortMgt.html"><a href="ChapPortMgt.html#exercises-7"><i class="fa fa-check"></i><b>13.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html"><i class="fa fa-check"></i><b>14</b> Loss Reserving</a>
<ul>
<li class="chapter" data-level="14.1" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:motivation"><i class="fa fa-check"></i><b>14.1</b> Motivation</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:claim-types"><i class="fa fa-check"></i><b>14.1.1</b> Closed, IBNR, and RBNS Claims</a></li>
<li class="chapter" data-level="14.1.2" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#why-reserving"><i class="fa fa-check"></i><b>14.1.2</b> Why Reserving?</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:Data"><i class="fa fa-check"></i><b>14.2</b> Loss Reserve Data</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#from-micro-to-macro"><i class="fa fa-check"></i><b>14.2.1</b> From Micro to Macro</a></li>
<li class="chapter" data-level="14.2.2" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#run-off-triangles"><i class="fa fa-check"></i><b>14.2.2</b> Run-off Triangles</a></li>
<li class="chapter" data-level="14.2.3" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#loss-reserve-notation"><i class="fa fa-check"></i><b>14.2.3</b> Loss Reserve Notation</a></li>
<li class="chapter" data-level="14.2.4" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:Rcode"><i class="fa fa-check"></i><b>14.2.4</b> R Code to Summarize Loss Reserve Data</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:Chain-ladder"><i class="fa fa-check"></i><b>14.3</b> The Chain-Ladder Method</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:DeterministicCL"><i class="fa fa-check"></i><b>14.3.1</b> The Deterministic Chain-Ladder</a></li>
<li class="chapter" data-level="14.3.2" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#macks-distribution-free-chain-ladder-model"><i class="fa fa-check"></i><b>14.3.2</b> Mack’s Distribution-Free Chain-Ladder Model</a></li>
<li class="chapter" data-level="14.3.3" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#r-code-for-chain-ladder-predictions"><i class="fa fa-check"></i><b>14.3.3</b> R code for Chain-Ladder Predictions</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#S:GLMs"><i class="fa fa-check"></i><b>14.4</b> GLMs and Bootstrap for Loss Reserves</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#model-specification"><i class="fa fa-check"></i><b>14.4.1</b> Model Specification</a></li>
<li class="chapter" data-level="14.4.2" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#model-estimation-and-prediction"><i class="fa fa-check"></i><b>14.4.2</b> Model Estimation and Prediction</a></li>
<li class="chapter" data-level="14.4.3" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#bootstrap"><i class="fa fa-check"></i><b>14.4.3</b> Bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="ChapLossReserves.html"><a href="ChapLossReserves.html#LossRe:further-reading-and-resources"><i class="fa fa-check"></i><b>14.5</b> Further Resources and Contributors</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html"><i class="fa fa-check"></i><b>15</b> Experience Rating using Bonus-Malus</a>
<ul>
<li class="chapter" data-level="15.1" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#S:ERBM:Intro"><i class="fa fa-check"></i><b>15.1</b> Introduction</a></li>
<li class="chapter" data-level="15.2" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#S:ERBM:NCD"><i class="fa fa-check"></i><b>15.2</b> <em>NCD</em> System in Several Countries</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#ncd-system-in-malaysia"><i class="fa fa-check"></i><b>15.2.1</b> <em>NCD</em> System in Malaysia</a></li>
<li class="chapter" data-level="15.2.2" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#ncd-systems-in-other-countries"><i class="fa fa-check"></i><b>15.2.2</b> NCD Systems in Other Countries</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#S:ERBM:BMS"><i class="fa fa-check"></i><b>15.3</b> <em>BMS</em> and Markov Chain Model</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#transition-probability"><i class="fa fa-check"></i><b>15.3.1</b> Transition Probability</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#S:ERBM:StatDist"><i class="fa fa-check"></i><b>15.4</b> <em>BMS</em> and Stationary Distribution</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#stationary-distribution"><i class="fa fa-check"></i><b>15.4.1</b> Stationary Distribution</a></li>
<li class="chapter" data-level="15.4.2" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#r-code-for-a-stationary-distribution"><i class="fa fa-check"></i><b>15.4.2</b> <code>R</code> Code for a Stationary Distribution</a></li>
<li class="chapter" data-level="15.4.3" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#premium-evolution"><i class="fa fa-check"></i><b>15.4.3</b> Premium Evolution</a></li>
<li class="chapter" data-level="15.4.4" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#r-program-for-premium-evolution"><i class="fa fa-check"></i><b>15.4.4</b> <code>R</code> Program for Premium Evolution</a></li>
<li class="chapter" data-level="15.4.5" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#convergence-rate"><i class="fa fa-check"></i><b>15.4.5</b> Convergence Rate</a></li>
<li class="chapter" data-level="15.4.6" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#r-program-for-convergence-rate"><i class="fa fa-check"></i><b>15.4.6</b> <code>R</code> Program for Convergence Rate</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#S:PremRtg"><i class="fa fa-check"></i><b>15.5</b> <em>BMS</em> and Premium Rating</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#premium-rating"><i class="fa fa-check"></i><b>15.5.1</b> Premium Rating</a></li>
<li class="chapter" data-level="15.5.2" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#a-priori-risk-classification"><i class="fa fa-check"></i><b>15.5.2</b> A Priori Risk Classification</a></li>
<li class="chapter" data-level="15.5.3" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#modelling-of-residual-heterogeneity"><i class="fa fa-check"></i><b>15.5.3</b> Modelling of Residual Heterogeneity</a></li>
<li class="chapter" data-level="15.5.4" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#stationary-distribution-allowing-for-residual-heterogeneity"><i class="fa fa-check"></i><b>15.5.4</b> Stationary Distribution Allowing for Residual Heterogeneity</a></li>
<li class="chapter" data-level="15.5.5" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#determination-of-optimal-relativities"><i class="fa fa-check"></i><b>15.5.5</b> Determination of Optimal Relativities</a></li>
<li class="chapter" data-level="15.5.6" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#numerical-illustrations"><i class="fa fa-check"></i><b>15.5.6</b> Numerical Illustrations</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#S:Further"><i class="fa fa-check"></i><b>15.6</b> Further Resources and Contributors</a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="ChapBonusMalus.html"><a href="ChapBonusMalus.html#further-reading-and-references-1"><i class="fa fa-check"></i><b>15.6.1</b> Further Reading and References</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html"><i class="fa fa-check"></i><b>16</b> Dependence Modeling</a>
<ul>
<li class="chapter" data-level="16.1" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#multivariate-variables"><i class="fa fa-check"></i><b>16.1</b> Multivariate Variables</a></li>
<li class="chapter" data-level="16.2" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#S:Measures"><i class="fa fa-check"></i><b>16.2</b> Classic Measures of Scalar Associations</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#association-measures-for-quantitative-variables"><i class="fa fa-check"></i><b>16.2.1</b> Association Measures for Quantitative Variables</a></li>
<li class="chapter" data-level="16.2.2" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#rank-based-measures"><i class="fa fa-check"></i><b>16.2.2</b> Rank Based Measures</a></li>
<li class="chapter" data-level="16.2.3" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#nominal-variables"><i class="fa fa-check"></i><b>16.2.3</b> Nominal Variables</a></li>
<li class="chapter" data-level="16.2.4" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#ordinal-variables"><i class="fa fa-check"></i><b>16.2.4</b> Ordinal Variables</a></li>
<li class="chapter" data-level="16.2.5" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#interval-variables"><i class="fa fa-check"></i><b>16.2.5</b> Interval Variables</a></li>
<li class="chapter" data-level="16.2.6" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#discrete-and-continuous-variables"><i class="fa fa-check"></i><b>16.2.6</b> Discrete and Continuous Variables</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#S:Copula"><i class="fa fa-check"></i><b>16.3</b> Introduction to Copulas</a></li>
<li class="chapter" data-level="16.4" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#S:CopAppl"><i class="fa fa-check"></i><b>16.4</b> Application Using Copulas</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#data-description"><i class="fa fa-check"></i><b>16.4.1</b> Data Description</a></li>
<li class="chapter" data-level="16.4.2" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#marginal-models"><i class="fa fa-check"></i><b>16.4.2</b> Marginal Models</a></li>
<li class="chapter" data-level="16.4.3" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#probability-integral-transformation"><i class="fa fa-check"></i><b>16.4.3</b> Probability Integral Transformation</a></li>
<li class="chapter" data-level="16.4.4" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#joint-modeling-with-copula-function"><i class="fa fa-check"></i><b>16.4.4</b> Joint Modeling with Copula Function</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#S:CopTyp"><i class="fa fa-check"></i><b>16.5</b> Types of Copulas</a>
<ul>
<li class="chapter" data-level="16.5.1" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#normal-gaussian-copulas"><i class="fa fa-check"></i><b>16.5.1</b> Normal (Gaussian) Copulas</a></li>
<li class="chapter" data-level="16.5.2" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#t--and-elliptical-copulas"><i class="fa fa-check"></i><b>16.5.2</b> <em>t</em>- and Elliptical Copulas</a></li>
<li class="chapter" data-level="16.5.3" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#archimedean-copulas"><i class="fa fa-check"></i><b>16.5.3</b> Archimedean Copulas</a></li>
<li class="chapter" data-level="16.5.4" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#properties-of-copulas"><i class="fa fa-check"></i><b>16.5.4</b> Properties of Copulas</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#S:CopImp"><i class="fa fa-check"></i><b>16.6</b> Why is Dependence Modeling Important?</a></li>
<li class="chapter" data-level="16.7" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#Dep:further-reading-and-resources"><i class="fa fa-check"></i><b>16.7</b> Further Resources and Contributors</a>
<ul>
<li class="chapter" data-level="" data-path="ChapDependenceModel.html"><a href="ChapDependenceModel.html#ts-15.a.-other-classic-measures-of-scalar-associations"><i class="fa fa-check"></i>TS 15.A. Other Classic Measures of Scalar Associations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="CAppA.html"><a href="CAppA.html"><i class="fa fa-check"></i><b>17</b> Appendix A: Review of Statistical Inference</a>
<ul>
<li class="chapter" data-level="17.1" data-path="CAppA.html"><a href="CAppA.html#S:AppA:BASIC"><i class="fa fa-check"></i><b>17.1</b> Basic Concepts</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="CAppA.html"><a href="CAppA.html#random-sampling"><i class="fa fa-check"></i><b>17.1.1</b> Random Sampling</a></li>
<li class="chapter" data-level="17.1.2" data-path="CAppA.html"><a href="CAppA.html#sampling-distribution"><i class="fa fa-check"></i><b>17.1.2</b> Sampling Distribution</a></li>
<li class="chapter" data-level="17.1.3" data-path="CAppA.html"><a href="CAppA.html#central-limit-theorem"><i class="fa fa-check"></i><b>17.1.3</b> Central Limit Theorem</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="CAppA.html"><a href="CAppA.html#S:AppA:PE"><i class="fa fa-check"></i><b>17.2</b> Point Estimation and Properties</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="CAppA.html"><a href="CAppA.html#method-of-moments-estimation"><i class="fa fa-check"></i><b>17.2.1</b> Method of Moments Estimation</a></li>
<li class="chapter" data-level="17.2.2" data-path="CAppA.html"><a href="CAppA.html#S:AppA:MLE"><i class="fa fa-check"></i><b>17.2.2</b> Maximum Likelihood Estimation</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="CAppA.html"><a href="CAppA.html#S:AppA:IE"><i class="fa fa-check"></i><b>17.3</b> Interval Estimation</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="CAppA.html"><a href="CAppA.html#S:AppA:IE:ED"><i class="fa fa-check"></i><b>17.3.1</b> Exact Distribution for Normal Sample Mean</a></li>
<li class="chapter" data-level="17.3.2" data-path="CAppA.html"><a href="CAppA.html#large-sample-properties-of-mle"><i class="fa fa-check"></i><b>17.3.2</b> Large-sample Properties of <em>MLE</em></a></li>
<li class="chapter" data-level="17.3.3" data-path="CAppA.html"><a href="CAppA.html#confidence-interval"><i class="fa fa-check"></i><b>17.3.3</b> Confidence Interval</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="CAppA.html"><a href="CAppA.html#S:AppA:HT"><i class="fa fa-check"></i><b>17.4</b> Hypothesis Testing</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="CAppA.html"><a href="CAppA.html#basic-concepts"><i class="fa fa-check"></i><b>17.4.1</b> Basic Concepts</a></li>
<li class="chapter" data-level="17.4.2" data-path="CAppA.html"><a href="CAppA.html#student-t-test-based-on-mle"><i class="fa fa-check"></i><b>17.4.2</b> Student-<em>t</em> test based on <em>mle</em></a></li>
<li class="chapter" data-level="17.4.3" data-path="CAppA.html"><a href="CAppA.html#S:AppA:HT:LRT"><i class="fa fa-check"></i><b>17.4.3</b> Likelihood Ratio Test</a></li>
<li class="chapter" data-level="17.4.4" data-path="CAppA.html"><a href="CAppA.html#S:AppA:HT:IC"><i class="fa fa-check"></i><b>17.4.4</b> Information Criteria</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="CAppB.html"><a href="CAppB.html"><i class="fa fa-check"></i><b>18</b> Appendix B: Iterated Expectations</a>
<ul>
<li class="chapter" data-level="18.1" data-path="CAppB.html"><a href="CAppB.html#S:AppB:CD"><i class="fa fa-check"></i><b>18.1</b> Conditional Distribution and Conditional Expectation</a>
<ul>
<li class="chapter" data-level="18.1.1" data-path="CAppB.html"><a href="CAppB.html#conditional-distribution"><i class="fa fa-check"></i><b>18.1.1</b> Conditional Distribution</a></li>
<li class="chapter" data-level="18.1.2" data-path="CAppB.html"><a href="CAppB.html#conditional-expectation-and-conditional-variance"><i class="fa fa-check"></i><b>18.1.2</b> Conditional Expectation and Conditional Variance</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="CAppB.html"><a href="CAppB.html#S:AppB:IE"><i class="fa fa-check"></i><b>18.2</b> Iterated Expectations and Total Variance</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="CAppB.html"><a href="CAppB.html#S:AppB:LIE"><i class="fa fa-check"></i><b>18.2.1</b> Law of Iterated Expectations</a></li>
<li class="chapter" data-level="18.2.2" data-path="CAppB.html"><a href="CAppB.html#law-of-total-variance"><i class="fa fa-check"></i><b>18.2.2</b> Law of Total Variance</a></li>
<li class="chapter" data-level="18.2.3" data-path="CAppB.html"><a href="CAppB.html#application"><i class="fa fa-check"></i><b>18.2.3</b> Application</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="CAppB.html"><a href="CAppB.html#S:AppConjugateDistributions"><i class="fa fa-check"></i><b>18.3</b> Conjugate Distributions</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="CAppB.html"><a href="CAppB.html#linear-exponential-family"><i class="fa fa-check"></i><b>18.3.1</b> Linear Exponential Family</a></li>
<li class="chapter" data-level="18.3.2" data-path="CAppB.html"><a href="CAppB.html#S:IterExp:Conjugate"><i class="fa fa-check"></i><b>18.3.2</b> Conjugate Distributions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="CAppC.html"><a href="CAppC.html"><i class="fa fa-check"></i><b>19</b> Appendix C: Maximum Likelihood Theory</a>
<ul>
<li class="chapter" data-level="19.1" data-path="CAppC.html"><a href="CAppC.html#S:AppC:LF"><i class="fa fa-check"></i><b>19.1</b> Likelihood Function</a>
<ul>
<li class="chapter" data-level="19.1.1" data-path="CAppC.html"><a href="CAppC.html#likelihood-and-log-likelihood-functions"><i class="fa fa-check"></i><b>19.1.1</b> Likelihood and Log-likelihood Functions</a></li>
<li class="chapter" data-level="19.1.2" data-path="CAppC.html"><a href="CAppC.html#properties-of-likelihood-functions"><i class="fa fa-check"></i><b>19.1.2</b> Properties of Likelihood Functions</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="CAppC.html"><a href="CAppC.html#S:AppC:MLE"><i class="fa fa-check"></i><b>19.2</b> Maximum Likelihood Estimators</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="CAppC.html"><a href="CAppC.html#definition-and-derivation-of-mle"><i class="fa fa-check"></i><b>19.2.1</b> Definition and Derivation of <em>MLE</em></a></li>
<li class="chapter" data-level="19.2.2" data-path="CAppC.html"><a href="CAppC.html#asymptotic-properties-of-mle"><i class="fa fa-check"></i><b>19.2.2</b> Asymptotic Properties of <em>MLE</em></a></li>
<li class="chapter" data-level="19.2.3" data-path="CAppC.html"><a href="CAppC.html#use-of-maximum-likelihood-estimation"><i class="fa fa-check"></i><b>19.2.3</b> Use of Maximum Likelihood Estimation</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="CAppC.html"><a href="CAppC.html#S:AppC:SI"><i class="fa fa-check"></i><b>19.3</b> Statistical Inference Based on Maximum Likelihood Estimation</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="CAppC.html"><a href="CAppC.html#hypothesis-testing"><i class="fa fa-check"></i><b>19.3.1</b> Hypothesis Testing</a></li>
<li class="chapter" data-level="19.3.2" data-path="CAppC.html"><a href="CAppC.html#S:AppC:MLEModelVal"><i class="fa fa-check"></i><b>19.3.2</b> <em>MLE</em> and Model Validation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html"><i class="fa fa-check"></i><b>20</b> Appendix D: Summary of Distributions</a>
<ul>
<li class="chapter" data-level="20.1" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html#S:DiscreteDistributions"><i class="fa fa-check"></i><b>20.1</b> Discrete Distributions</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html#the-ab0-class"><i class="fa fa-check"></i><b>20.1.1</b> The <em>(a,b,0)</em> Class</a></li>
<li class="chapter" data-level="20.1.2" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html#the-ab1-class"><i class="fa fa-check"></i><b>20.1.2</b> The <em>(a,b,1)</em> Class</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html#S:ContinuousDistributions"><i class="fa fa-check"></i><b>20.2</b> Continuous Distributions</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html#one-parameter-distributions"><i class="fa fa-check"></i><b>20.2.1</b> One Parameter Distributions</a></li>
<li class="chapter" data-level="20.2.2" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html#two-parameter-distributions"><i class="fa fa-check"></i><b>20.2.2</b> Two Parameter Distributions</a></li>
<li class="chapter" data-level="20.2.3" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html#three-parameter-distributions"><i class="fa fa-check"></i><b>20.2.3</b> Three Parameter Distributions</a></li>
<li class="chapter" data-level="20.2.4" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html#four-parameter-distribution"><i class="fa fa-check"></i><b>20.2.4</b> Four Parameter Distribution</a></li>
<li class="chapter" data-level="20.2.5" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html#other-distributions"><i class="fa fa-check"></i><b>20.2.5</b> Other Distributions</a></li>
<li class="chapter" data-level="20.2.6" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html#distributions-with-finite-support"><i class="fa fa-check"></i><b>20.2.6</b> Distributions with Finite Support</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="ChapSummaryDistributions.html"><a href="ChapSummaryDistributions.html#limited-expected-values"><i class="fa fa-check"></i><b>20.3</b> Limited Expected Values</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="ChapNotationConvention.html"><a href="ChapNotationConvention.html"><i class="fa fa-check"></i><b>21</b> Appendix E: Conventions for Notation</a>
<ul>
<li class="chapter" data-level="21.1" data-path="ChapNotationConvention.html"><a href="ChapNotationConvention.html#S:General"><i class="fa fa-check"></i><b>21.1</b> General Conventions</a></li>
<li class="chapter" data-level="21.2" data-path="ChapNotationConvention.html"><a href="ChapNotationConvention.html#S:Abbreviations"><i class="fa fa-check"></i><b>21.2</b> Abbreviations</a></li>
<li class="chapter" data-level="21.3" data-path="ChapNotationConvention.html"><a href="ChapNotationConvention.html#S:StatSymbols"><i class="fa fa-check"></i><b>21.3</b> Common Statistical Symbols and Operators</a></li>
<li class="chapter" data-level="21.4" data-path="ChapNotationConvention.html"><a href="ChapNotationConvention.html#S:Symbols"><i class="fa fa-check"></i><b>21.4</b> Common Mathematical Symbols and Functions</a></li>
<li class="chapter" data-level="21.5" data-path="ChapNotationConvention.html"><a href="ChapNotationConvention.html#further-readings"><i class="fa fa-check"></i><b>21.5</b> Further Readings</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="DataResources.html"><a href="DataResources.html"><i class="fa fa-check"></i><b>22</b> Appendix. Data Resources</a>
<ul>
<li class="chapter" data-level="22.1" data-path="DataResources.html"><a href="DataResources.html#S:WiscPropFundA"><i class="fa fa-check"></i><b>22.1</b> Wisconsin Property Fund</a></li>
<li class="chapter" data-level="22.2" data-path="DataResources.html"><a href="DataResources.html#Sec:DataTravel"><i class="fa fa-check"></i><b>22.2</b> ANU Corporate Travel Data</a></li>
<li class="chapter" data-level="22.3" data-path="DataResources.html"><a href="DataResources.html#Sec:DataGPA"><i class="fa fa-check"></i><b>22.3</b> ANU Group Personal Accident Data</a></li>
<li class="chapter" data-level="22.4" data-path="DataResources.html"><a href="DataResources.html#Sec:DataAuto"><i class="fa fa-check"></i><b>22.4</b> ANU Motor Vehicle Data</a></li>
<li class="chapter" data-level="22.5" data-path="DataResources.html"><a href="DataResources.html#spanish-personal-insurance-data"><i class="fa fa-check"></i><b>22.5</b> Spanish Personal Insurance Data</a></li>
<li class="chapter" data-level="22.6" data-path="DataResources.html"><a href="DataResources.html#r-package-casdatasets"><i class="fa fa-check"></i><b>22.6</b> ‘R’ Package CASdatasets</a></li>
<li class="chapter" data-level="22.7" data-path="DataResources.html"><a href="DataResources.html#other-data-sources"><i class="fa fa-check"></i><b>22.7</b> Other Data Sources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bibliography.html"><a href="bibliography.html"><i class="fa fa-check"></i>Bibliography</a></li>
<li class="divider"></li>
<li><a href="https://github.com/OpenActTexts/Loss-Data-Analytics" target="blank">Loss Data Analytics on GitHub</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Loss Data Analytics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ChapDependenceModel" class="section level1 hasAnchor" number="16">
<h1><span class="header-section-number">Chapter 16</span> Dependence Modeling<a href="ChapDependenceModel.html#ChapDependenceModel" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><em>Chapter Preview</em>. In practice, there are many types of variables that one encounters. The first step in dependence modeling is identifying the type of variable to help direct you to the appropriate technique. This chapter introduces readers to variable types and techniques for modeling dependence or association of multivariate distributions. Section <a href="#S:VarTypes15"><strong>??</strong></a> provides an overview of the types of variables. Section <a href="ChapDependenceModel.html#S:Measures">16.2</a> then elaborates basic measures for modeling the dependence between variables.</p>
<p>Section <a href="ChapDependenceModel.html#S:Copula">16.3</a> introduces an approach to modeling dependence using copulas which is reinforced with practical illustrations in Section <a href="ChapDependenceModel.html#S:CopAppl">16.4</a>. The types of copula families and basic properties of copula functions are explained Section <a href="ChapDependenceModel.html#S:CopTyp">16.5</a>. The chapter concludes by explaining why the study of dependence modeling is important in Section <a href="ChapDependenceModel.html#S:CopImp">16.6</a>.</p>
<div id="multivariate-variables" class="section level2 hasAnchor" number="16.1">
<h2><span class="header-section-number">16.1</span> Multivariate Variables<a href="ChapDependenceModel.html#multivariate-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<hr />
<p>In this section, you learn how to:</p>
<ul>
<li>Differentiate between univariate and multivariate data</li>
<li>Handle missing variables</li>
</ul>
<hr />
<p>People, firms, and other entities that we want to understand are described in a dataset by numerical characteristics. As these characteristics vary by entity, they are commonly known as <a href="#" class="tooltip" style="color:green"><em>variables</em><span style="font-size:8pt">A variable is any characteristics, number, or quantity that can be measured or counted.</span></a>. To manage insurance systems, it will be critical to understand the distribution of each variable and how they are associated with one another. It is common for data sets to have many variables (<a href="#" class="tooltip" style="color:green"><em>high dimensional</em><span style="font-size:8pt">Data set is high dimensional when it has many variables. In many applications, the number of variables may be larger than the sample size.</span></a>) and so is useful to begin by classifying them into different types. As will be seen, these classifications are not strict; there is overlap among the groups. Nonetheless, the grouping summarized in <a href="#tab:15.1">Table 15.1</a> and explained in the remainder of this section provides a solid first step in framing a data set.</p>
<p><a id=tab:15.1></a></p>
<p>Table 15.1. <strong>Variable Types</strong></p>
<p><span class="math display">\[
{\small \begin{matrix}
\begin{array}{l|l} \hline
\textbf{Variable Type} &amp; \textbf{Example} \\\hline
Qualitative &amp;            \\
    \text{Binary} &amp;        \text{Sex} \\
\text{Categorical (Unordered, Nominal)} &amp; \text{Territory (e.g., state/province) in which an insured resides} \\
\text{Ordered Category (Ordinal)} &amp; \text{Claimant satisfaction (five point scale ranging from 1=dissatisfied} \\
&amp; ~~~ \text{to 5 =satisfied)} \\\hline
Quantitative &amp;            \\
\text{Continuous} &amp; \text{Policyholder&#39;s age, weight, income} \\
  \text{Discrete} &amp; \text{Amount of deductible  (0, 250, 500, and 1000)} \\
\text{Count} &amp; \text{Number of insurance claims} \\
\text{Combinations of}  &amp; \text{Policy losses, mixture of 0&#39;s (for no loss)}  \\
~~~ \text{Discrete and Continuous} &amp; ~~~\text{and positive claim amount} \\
\text{Interval Variable} &amp; \text{Driver Age: 16-24 (young), 25-54 (intermediate),}  \\
&amp; ~~~\text{55 and over (senior)} \\
\text{Circular Data} &amp; \text{Time of day measures of customer arrival} \\ \hline
Multivariate ~ Variable &amp;            \\
\text{High Dimensional Data} &amp; \text{Characteristics of a firm purchasing worker&#39;s compensation} \\
&amp; ~~~\text{insurance (location of plants, industry, number of employees,} \\
&amp;~~~\text{and so on)} \\
\text{Spatial Data} &amp; \text{Longitude/latitude of the location an insurance hailstorm claim} \\
\text{Missing Data} &amp; \text{Policyholder&#39;s age (continuous/interval) and -99 for} \\
&amp;~~~ `\text{not reported,&#39; that is, missing} \\
\text{Censored and Truncated Data} &amp; \text{Amount of insurance claims in excess of a deductible} \\
\text{Aggregate Claims} &amp; \text{Losses recorded for each claim in a motor vehicle policy.} \\
\text{Stochastic Process Realizations} &amp; \text{The time and amount of each occurrence of an insured loss} \\ \hline
\end{array}
\end{matrix}}
\]</span></p>
<p>In data analysis, it is important to understand what type of variable you are working with. For example, consider a pair of random variables <span class="math inline">\({\tt (Coverage, Claim)}\)</span> from the <em>LGPIF</em> data introduced in Section <a href="ChapIntro.html#S:LGPIF">1.3</a> as displayed in Figure <a href="ChapDependenceModel.html#fig:IntroPlot">16.1</a> below. We would like to know whether the distribution of <span class="math inline">\({\tt Coverage}\)</span> depends on the distribution of <span class="math inline">\({\tt Claim}\)</span> or whether they are statistically independent. We would also want to know how the <span class="math inline">\({\tt Claim}\)</span> distribution depends on the <span class="math inline">\({\tt EntityType}\)</span> variable. Because the <span class="math inline">\({\tt EntityType}\)</span> variable belongs to a different class of variables, modeling the dependence between <span class="math inline">\({\tt Claim}\)</span> and <span class="math inline">\({\tt Coverage}\)</span> may require a different technique from that of <span class="math inline">\({\tt Claim}\)</span> and <span class="math inline">\({\tt EntityType}\)</span>.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:IntroPlot"></span>
<img src="LossDataAnalytics_files/figure-html/IntroPlot-1.png" alt="Scatter Plot of (Coverage,Claim) from LGPIF Data" width="80%" />
<p class="caption">
Figure 16.1: <strong>Scatter Plot of <em>(Coverage,Claim)</em> from LGPIF Data</strong>
</p>
</div>
<p><a href="#" class="tooltip" style="color:green"><em>Circular data</em><span style="font-size:8pt">In a circular data, all values around the circle are equally likely. Example, imagine an analog picture of a clock.</span></a> represent an interesting category typically not analyzed by <a href="#" class="tooltip" style="color:green"><em>insurers</em><span style="font-size:8pt">An insurance company authorized to write insurance under the laws of any state.</span></a>. As an example of circular data, suppose that you monitor calls to your customer service center and would like to know when is the peak time of the day for calls to arrive. In this context, one can think about the time of the day as a variable with realizations on a circle, e.g., imagine an analog picture of a clock. For circular data, the distance between observations at 00:15 and 00:45 are just as close as observations 23:45 and 00:15 (the convention <em>HH:MM</em> means hours and minutes).</p>
<p>Insurance data typically are <a href="#" class="tooltip" style="color:green"><em>multivariate</em><span style="font-size:8pt">Multivariate variable involves taking many measurements on a single entity.</span></a> in the sense that we can take many measurements on a single entity. For example, when studying losses associated with a firm’s <a href="#" class="tooltip" style="color:green"><em>workers’ compensation</em><span style="font-size:8pt"></span></a> plan, we might want to know the location of its manufacturing plants, the industry in which it operates, the number of employees, and so forth. The usual strategy for analyzing multivariate data is to begin by examining each variable in isolation of the others. This is known as a <a href="#" class="tooltip" style="color:green"><em>univariate</em><span style="font-size:8pt">Univariate analysis is the simplest form of analyzing data. “Uni” means “one,” so in other words your data has only one variable.</span></a> approach.</p>
<p>In contrast, for some variables, it makes little sense to only look at one dimensional aspect. For example, insurers typically organize <a href="#" class="tooltip" style="color:green"><em>spatial data</em><span style="font-size:8pt">Data and information having an implicit or explicit association with a location relative to the earth</span></a> by longitude and latitude to analyze the location of weather related insurance claims due to hailstorms. Having only a single number, either longitude or latitude, provides little information in understanding geographic location.</p>
<p>Another special case of a multivariate variable, less obvious, involves coding for <a href="#" class="tooltip" style="color:green"><em>missing data</em><span style="font-size:8pt">Missing data occur when no data value is stored for a variable in an observation. Missing data can occur because of nonresponse: no information is provided for one or more items or for a whole unit or subject.</span></a>. Historically, some statistical packages used a -99 to report when a variable, such as policyholder’s age, was not available or not reported. This led to many unsuspecting analysts providing strange statistics when summarizing a set of data. When data are missing, it is better to think about the variable as having two dimensions, one to indicate whether or not the variable is reported and the second providing the age (if reported). In the same way, insurance data are commonly <a href="#" class="tooltip" style="color:green"><em>censored</em><span style="font-size:8pt">Censored data have unknown values beyond a bound on either end of the number line or both. Here, the data is observed but the values (measurements) are not known completely.</span></a> and <a href="#" class="tooltip" style="color:green"><em>truncated</em><span style="font-size:8pt">Truncation occurs when values beyond a boundary are either excluded when gathered or excluded when analyzed. An object can be detected only if its value is greater than some number.</span></a>. We refer you to Section <a href="#S:MS:ModifiedData"><strong>??</strong></a> for more on censored and truncated data. <a href="#" class="tooltip" style="color:green"><em>Aggregate claims</em><span style="font-size:8pt">The sum of all claims observed in a period of time</span></a>, described in Chapter <a href="ChapAggLossModels.html#ChapAggLossModels">7</a>, can also be coded as another special type of multivariate variable.</p>
<p>Perhaps the most complicated type of multivariate variable is a realization of a <a href="#" class="tooltip" style="color:green"><em>stochastic process</em><span style="font-size:8pt">Stochastic process is defined as a collection of random variables that is indexed by some mathematical set, meaning that each random variable of the stochastic process is uniquely associated with an element in the set.</span></a>. You will recall that a stochastic process is little more than a collection of random variables. For example, in insurance, we might think about the times that claims arrive to an insurance company in a one-year time horizon. This is a high dimensional variable that theoretically is infinite dimensional. Special techniques are required to understand realizations of stochastic processes that will not be addressed here.</p>
<div id="surveyElement141">

</div>
<div id="surveyResult141">

</div>
<h5 style="text-align: center;">
<a id="display.Quiz141.1" href="javascript:toggleQuiz
('display.Quiz141.2','display.Quiz141.1');"><i><strong>Show Quiz Solution</strong></i></a>
</h5>
<div id="display.Quiz141.2" style="display: none">
<p id="Quiz141Soln">
</p>
<hr />
</div>
<script type="text/javascript" src="./Quizzes/QuizJavascript/Quiz141.js">
</script>
</div>
<div id="S:Measures" class="section level2 hasAnchor" number="16.2">
<h2><span class="header-section-number">16.2</span> Classic Measures of Scalar Associations<a href="ChapDependenceModel.html#S:Measures" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<hr />
<p>In this section, you learn how to:</p>
<ul>
<li>Estimate correlation using the Pearson method</li>
<li>Use rank based measures like Spearman, Kendall to estimate correlation</li>
<li>Measure dependence using the odds ratio, Pearson chi-square, and likelihood ratio test statistics</li>
<li>Use normal-based correlations to quantify associations involving ordinal variables</li>
</ul>
<hr />
<div id="association-measures-for-quantitative-variables" class="section level3 hasAnchor" number="16.2.1">
<h3><span class="header-section-number">16.2.1</span> Association Measures for Quantitative Variables<a href="ChapDependenceModel.html#association-measures-for-quantitative-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For this section, consider a pair of random variables <span class="math inline">\((X,Y)\)</span> having joint distribution function <span class="math inline">\(F(\cdot)\)</span> and a random sample <span class="math inline">\((X_i,Y_i), i=1, \ldots, n\)</span>. For the continuous case, suppose that <span class="math inline">\(F(\cdot)\)</span> has absolutely continuous marginals with marginal density functions.</p>
<div id="pearson-correlation" class="section level4 hasAnchor" number="16.2.1.1">
<h4><span class="header-section-number">16.2.1.1</span> Pearson Correlation<a href="ChapDependenceModel.html#pearson-correlation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Define the sample covariance function <span class="math inline">\(\widehat{Cov}(X,Y) = \frac{1}{n} \sum_{i=1}^n (X_i - \bar{X})(Y_i - \bar{Y})\)</span>, where <span class="math inline">\(\bar{X}\)</span> and <span class="math inline">\(\bar{Y}\)</span> are the sample means of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, respectively. Then, the <a href="#" class="tooltip" style="color:green"><em>product-moment (Pearson) correlation</em><span style="font-size:8pt">Pearson correlation, a measure of the linear correlation between two variables</span></a> can be written as</p>
<p><span class="math display">\[
r = \frac{\widehat{Cov}(X,Y)}{\sqrt{\widehat{Cov}(X,X)\widehat{Cov}(Y,Y)}}
= \frac{\widehat{Cov}(X,Y)}{\sqrt{\widehat{Var}(X)}\sqrt{\widehat{Var}(Y)}}.
\]</span></p>
<p>The correlation statistic <span class="math inline">\(r\)</span> is widely used to capture linear association between random variables. It is a (nonparametric) estimator of the correlation parameter <span class="math inline">\(\rho\)</span>, defined to be the covariance divided by the product of standard deviations.</p>
<p>This statistic has several important features. Unlike regression estimators, it is symmetric between random variables, so the correlation between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> equals the correlation between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span>. It is unchanged by linear transformations of random variables (up to sign changes) so that we can multiply random variables or add constants as is helpful for interpretation. The range of the statistic is <span class="math inline">\([-1,1]\)</span> which does not depend on the distribution of either <span class="math inline">\(X\)</span> or <span class="math inline">\(Y\)</span>.</p>
<p>Further, in the case of independence, the correlation coefficient <span class="math inline">\(r\)</span> is 0. However, it is well known that zero correlation does not in general imply independence, one exception is the case of normally distributed random variables. The correlation statistic <span class="math inline">\(r\)</span> is also a (maximum likelihood) estimator of the association parameter for the bivariate normal distribution. So, for normally distributed data, the correlation statistic <span class="math inline">\(r\)</span> can be used to assess independence. For additional interpretations of this well-known statistic, readers will enjoy <span class="citation"><a href="#ref-lee1988thirteen" role="doc-biblioref">Lee Rodgers and Nicewander</a> (<a href="#ref-lee1988thirteen" role="doc-biblioref">1998</a>)</span>.</p>
<p>You can obtain the <a href="#" class="tooltip" style="color:green"><em>Pearson correlation</em><span style="font-size:8pt">A measure of the linear correlation between two variables</span></a> statistic <span class="math inline">\(r\)</span> using the <code>cor()</code> function in <code>R</code> and selecting the <code>pearson</code> method. This is demonstrated below by using the <span class="math inline">\({\tt Coverage}\)</span> rating variable in millions of dollars and <span class="math inline">\({\tt Claim}\)</span> amount variable in dollars from the LGPIF data introduced in chapter 1.</p>
<h5 style="text-align: center;">
<a id="displayCode.pearson.1" href="javascript:togglecode('toggleCode.pearson.1','displayCode.pearson.1');"><i><strong>R Code for Pearson Correlation Statistic</strong></i></a>
</h5>
<div id="toggleCode.pearson.1" style="display: none">
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="ChapDependenceModel.html#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Pearson correlation between Claim and Coverage</span></span>
<span id="cb245-2"><a href="ChapDependenceModel.html#cb245-2" aria-hidden="true" tabindex="-1"></a>r<span class="ot">&lt;-</span><span class="fu">cor</span>(Claim,Coverage, <span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;pearson&quot;</span>))</span>
<span id="cb245-3"><a href="ChapDependenceModel.html#cb245-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(r,<span class="dv">2</span>)</span>
<span id="cb245-4"><a href="ChapDependenceModel.html#cb245-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-5"><a href="ChapDependenceModel.html#cb245-5" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span></span>
<span id="cb245-6"><a href="ChapDependenceModel.html#cb245-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.31</span></span>
<span id="cb245-7"><a href="ChapDependenceModel.html#cb245-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-8"><a href="ChapDependenceModel.html#cb245-8" aria-hidden="true" tabindex="-1"></a><span class="do">### Pearson correlation between Claim and log(Coverage)</span></span>
<span id="cb245-9"><a href="ChapDependenceModel.html#cb245-9" aria-hidden="true" tabindex="-1"></a>r<span class="ot">&lt;-</span><span class="fu">cor</span>(Claim,<span class="fu">log</span>(Coverage), <span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;pearson&quot;</span>))</span>
<span id="cb245-10"><a href="ChapDependenceModel.html#cb245-10" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(r,<span class="dv">2</span>)</span>
<span id="cb245-11"><a href="ChapDependenceModel.html#cb245-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-12"><a href="ChapDependenceModel.html#cb245-12" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span></span>
<span id="cb245-13"><a href="ChapDependenceModel.html#cb245-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.1</span></span></code></pre></div>
</div>
<p>From the <code>R</code> output above, <span class="math inline">\(r=0.31\)</span>, which indicates a positive association between <span class="math inline">\({\tt Claim}\)</span> and <span class="math inline">\({\tt Coverage}\)</span>. This means that as the coverage amount of a policy increases we expect claims to increase.</p>
</div>
</div>
<div id="rank-based-measures" class="section level3 hasAnchor" number="16.2.2">
<h3><span class="header-section-number">16.2.2</span> Rank Based Measures<a href="ChapDependenceModel.html#rank-based-measures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="Sec:Spearman" class="section level4 hasAnchor" number="16.2.2.1">
<h4><span class="header-section-number">16.2.2.1</span> Spearman’s Rho<a href="ChapDependenceModel.html#Sec:Spearman" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The Pearson correlation coefficient does have the drawback that it is not invariant to nonlinear transforms of the data. For example, the correlation between <span class="math inline">\(X\)</span> and <span class="math inline">\(\log Y\)</span> can be quite different from the correlation between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. As we see from the <code>R</code> code for the Pearson correlation statistic above, the correlation statistic <span class="math inline">\(r\)</span> between the <span class="math inline">\({\tt Coverage}\)</span> rating variable in logarithmic millions of dollars and the <span class="math inline">\({\tt Claim}\)</span> amounts variable in dollars is <span class="math inline">\(0.1\)</span> as compared to <span class="math inline">\(0.31\)</span> when we calculate the correlation between the <span class="math inline">\({\tt Coverage}\)</span> rating variable in millions of dollars and the <span class="math inline">\({\tt Claim}\)</span> amounts variable in dollars. This limitation is one reason for considering alternative statistics.</p>
<p>Alternative measures of correlation are based on ranks of the data. Let <span class="math inline">\(R(X_j)\)</span> denote the rank of <span class="math inline">\(X_j\)</span> from the sample <span class="math inline">\(X_1, \ldots, X_n\)</span> and similarly for <span class="math inline">\(R(Y_j)\)</span>. Let <span class="math inline">\(R(X) = \left(R(X_1), \ldots, R(X_n)\right)&#39;\)</span> denote the vector of ranks, and similarly for <span class="math inline">\(R(Y)\)</span>. For example, if <span class="math inline">\(n=3\)</span> and <span class="math inline">\(X=(24, 13, 109)\)</span>, then <span class="math inline">\(R(X)=(2,1,3)\)</span>. A comprehensive introduction of rank statistics can be found in, for example, <span class="citation"><a href="#ref-hettmansperger1984statistical" role="doc-biblioref">Hettmansperger</a> (<a href="#ref-hettmansperger1984statistical" role="doc-biblioref">1984</a>)</span>. Also, ranks can be used to obtain the empirical distribution function, refer to Section <a href="ChapSeverity.html#S:MS:NonParEst">4.4.1</a> for more on the empirical distribution function.</p>
<p>With this, the correlation measure of <span class="citation"><a href="#ref-spearman1904proof" role="doc-biblioref">Spearman</a> (<a href="#ref-spearman1904proof" role="doc-biblioref">1904</a>)</span> is simply the product-moment correlation computed on the ranks:</p>
<p><span class="math display">\[
r_S = \frac{\widehat{Cov}(R(X),R(Y))}{\sqrt{\widehat{Cov}(R(X),R(X))\widehat{Cov}(R(Y),R(Y))}}
= \frac{\widehat{Cov}(R(X),R(Y))}{(n^2-1)/12} .
\]</span></p>
<p>You can obtain the Spearman correlation statistic <span class="math inline">\(r_S\)</span> using the <code>cor()</code> function in <code>R</code> and selecting the <code>spearman</code> method. From below, the Spearman correlation between the <span class="math inline">\({\tt Coverage}\)</span> rating variable in millions of dollars and <span class="math inline">\({\tt Claim}\)</span> amount variable in dollars is <span class="math inline">\(0.41\)</span>.</p>
<h5 style="text-align: center;">
<a id="displayCode.spearman.1" href="javascript:togglecode('toggleCode.spearman.1','displayCode.spearman.1');"><i><strong>R Code for Spearman Correlation Statistic</strong></i></a>
</h5>
<div id="toggleCode.spearman.1" style="display: none">
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="ChapDependenceModel.html#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Spearman correlation between Claim and Coverage </span><span class="al">###</span></span>
<span id="cb246-2"><a href="ChapDependenceModel.html#cb246-2" aria-hidden="true" tabindex="-1"></a>rs<span class="ot">&lt;-</span><span class="fu">cor</span>(Claim,Coverage, <span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;spearman&quot;</span>))</span>
<span id="cb246-3"><a href="ChapDependenceModel.html#cb246-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(rs,<span class="dv">2</span>)</span>
<span id="cb246-4"><a href="ChapDependenceModel.html#cb246-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-5"><a href="ChapDependenceModel.html#cb246-5" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span></span>
<span id="cb246-6"><a href="ChapDependenceModel.html#cb246-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.41</span></span>
<span id="cb246-7"><a href="ChapDependenceModel.html#cb246-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-8"><a href="ChapDependenceModel.html#cb246-8" aria-hidden="true" tabindex="-1"></a><span class="do">### Spearman correlation between Claim and log(Coverage) </span><span class="al">###</span></span>
<span id="cb246-9"><a href="ChapDependenceModel.html#cb246-9" aria-hidden="true" tabindex="-1"></a>rs<span class="ot">&lt;-</span><span class="fu">cor</span>(Claim,<span class="fu">log</span>(Coverage), <span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;spearman&quot;</span>))</span>
<span id="cb246-10"><a href="ChapDependenceModel.html#cb246-10" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(rs,<span class="dv">2</span>)</span>
<span id="cb246-11"><a href="ChapDependenceModel.html#cb246-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb246-12"><a href="ChapDependenceModel.html#cb246-12" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span></span>
<span id="cb246-13"><a href="ChapDependenceModel.html#cb246-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.41</span></span></code></pre></div>
</div>
<p>We can show that the Spearman correlation statistic is invariant under strictly increasing transformations. From the <code>R</code> Code for the Spearman correlation statistic above, <span class="math inline">\(r_S=0.41\)</span> between the <span class="math inline">\({\tt Coverage}\)</span> rating variable in logarithmic millions of dollars and <span class="math inline">\({\tt Claim}\)</span> amount variable in dollars.</p>
</div>
<div id="Sec:Kendall" class="section level4 hasAnchor" number="16.2.2.2">
<h4><span class="header-section-number">16.2.2.2</span> Kendall’s Tau<a href="ChapDependenceModel.html#Sec:Kendall" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>An alternative measure that uses ranks is based on the concept of <em>concordance</em>. An observation pair <span class="math inline">\((X,Y)\)</span> is said to be <a href="#" class="tooltip" style="color:green"><em>concordant</em><span style="font-size:8pt">An observation pair (x,y) is said to be concordant if the observation with a larger value of x has also the larger value of y</span></a> (<a href="#" class="tooltip" style="color:green"><em>discordant</em><span style="font-size:8pt">An observation pair (x,y) is said to be discordant if the observation with a larger value of x has the smaller value of y</span></a>) if the observation with a larger value of <span class="math inline">\(X\)</span> has also the larger (smaller) value of <span class="math inline">\(Y\)</span>. Then <span class="math inline">\(\Pr(concordance) = \Pr[ (X_1-X_2)(Y_1-Y_2) &gt;0 ]\)</span> , <span class="math inline">\(\Pr(discordance) = \Pr[ (X_1-X_2)(Y_1-Y_2) &lt;0 ]\)</span>, <span class="math inline">\(\Pr(tie) = \Pr[ (X_1-X_2)(Y_1-Y_2) =0 ]\)</span> and</p>
<p><span class="math display">\[
\begin{array}{rl}
\tau(X,Y) &amp;= \Pr(concordance) - \Pr(discordance) \\
&amp; = 2\Pr(concordance) - 1 + \Pr(tie).
\end{array}
\]</span></p>
<p>To estimate this, the pairs <span class="math inline">\((X_i,Y_i)\)</span> and <span class="math inline">\((X_j,Y_j)\)</span> are said to be concordant if the product <span class="math inline">\(sgn(X_j-X_i)sgn(Y_j-Y_i)\)</span> equals 1 and discordant if the product equals -1. Here, <span class="math inline">\(sgn(x)=1,0,-1\)</span> as <span class="math inline">\(x&gt;0\)</span>, <span class="math inline">\(x=0\)</span>, <span class="math inline">\(x&lt;0\)</span>, respectively. With this, we can express the association measure of <span class="citation"><a href="#ref-kendall1938new" role="doc-biblioref">Maurice G. Kendall</a> (<a href="#ref-kendall1938new" role="doc-biblioref">1938</a>)</span>, known as <a href="#" class="tooltip" style="color:green"><em>Kendall’s tau</em><span style="font-size:8pt"></span></a>, as</p>
<p><span class="math display">\[
\begin{array}{rl}
\hat{\tau} &amp;= \frac{2}{n(n-1)} \sum_{i&lt;j} ~sgn(X_j-X_i) \times sgn(Y_j-Y_i)\\
&amp;= \frac{2}{n(n-1)} \sum_{i&lt;j} ~sgn(R(X_j)-R(X_i)) \times sgn(R(Y_j)-R(Y_i)) .
\end{array}
\]</span></p>
<p>Interestingly, <span class="citation"><a href="#ref-hougaard2000analysis" role="doc-biblioref">Hougaard</a> (<a href="#ref-hougaard2000analysis" role="doc-biblioref">2000</a>)</span>, page 137, attributes the original discovery of this statistic to <span class="citation"><a href="#ref-fechnerkollektivmasslehre" role="doc-biblioref">Fechner</a> (<a href="#ref-fechnerkollektivmasslehre" role="doc-biblioref">1897</a>)</span>, noting that Kendall’s discovery was independent and more complete than the original work.</p>
<p>You can obtain Kendall’s tau using the <code>cor()</code> function in <code>R</code> and selecting the <code>kendall</code> method. From below, <span class="math inline">\(\hat{\tau}=0.32\)</span> between the <span class="math inline">\({\tt Coverage}\)</span> rating variable in millions of dollars and the <span class="math inline">\({\tt Claim}\)</span> amount variable in dollars. When there are ties in the data, the <code>cor()</code> function computes <em>Kendall’s tau_b</em> as proposed by <span class="citation"><a href="#ref-kendall1945" role="doc-biblioref">M. G. Kendall</a> (<a href="#ref-kendall1945" role="doc-biblioref">1945</a>)</span>.</p>
<h5 style="text-align: center;">
<a id="displayCode.kendall.1" href="javascript:togglecode('toggleCode.kendall.1','displayCode.kendall.1');"><i><strong>R Code for Kendall’s Tau</strong></i></a>
</h5>
<div id="toggleCode.kendall.1" style="display: none">
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="ChapDependenceModel.html#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Kendall&#39;s tau correlation between Claim and Coverage </span><span class="al">###</span></span>
<span id="cb247-2"><a href="ChapDependenceModel.html#cb247-2" aria-hidden="true" tabindex="-1"></a>tau<span class="ot">&lt;-</span><span class="fu">cor</span>(Claim,Coverage, <span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;kendall&quot;</span>))</span>
<span id="cb247-3"><a href="ChapDependenceModel.html#cb247-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(tau,<span class="dv">2</span>)</span>
<span id="cb247-4"><a href="ChapDependenceModel.html#cb247-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-5"><a href="ChapDependenceModel.html#cb247-5" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span></span>
<span id="cb247-6"><a href="ChapDependenceModel.html#cb247-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]  <span class="fl">0.32</span></span>
<span id="cb247-7"><a href="ChapDependenceModel.html#cb247-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-8"><a href="ChapDependenceModel.html#cb247-8" aria-hidden="true" tabindex="-1"></a><span class="do">### Kendall&#39;s tau correlation between Claim and log(Coverage) </span><span class="al">###</span></span>
<span id="cb247-9"><a href="ChapDependenceModel.html#cb247-9" aria-hidden="true" tabindex="-1"></a>tau<span class="ot">&lt;-</span><span class="fu">cor</span>(Claim,<span class="fu">log</span>(Coverage), <span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;kendall&quot;</span>))</span>
<span id="cb247-10"><a href="ChapDependenceModel.html#cb247-10" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(tau,<span class="dv">2</span>)</span>
<span id="cb247-11"><a href="ChapDependenceModel.html#cb247-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-12"><a href="ChapDependenceModel.html#cb247-12" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span></span>
<span id="cb247-13"><a href="ChapDependenceModel.html#cb247-13" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.32</span></span></code></pre></div>
</div>
<p>Also, to show that the Kendall’s tau is invariant under strictly increasing transformations, we see that <span class="math inline">\(\hat{\tau}=0.32\)</span> between the <span class="math inline">\({\tt Coverage}\)</span> rating variable in logarithmic millions of dollars and the <span class="math inline">\({\tt Claim}\)</span> amount variable in dollars.</p>
</div>
</div>
<div id="nominal-variables" class="section level3 hasAnchor" number="16.2.3">
<h3><span class="header-section-number">16.2.3</span> Nominal Variables<a href="ChapDependenceModel.html#nominal-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="bernoulli-variables" class="section level4 hasAnchor" number="16.2.3.1">
<h4><span class="header-section-number">16.2.3.1</span> Bernoulli Variables<a href="ChapDependenceModel.html#bernoulli-variables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To see why dependence measures for continuous variables may not be the best for discrete variables, let us focus on the case of Bernoulli variables that take on simple binary outcomes, 0 and 1. For notation, let <span class="math inline">\(\pi_{jk} = \Pr(X=j, Y=k)\)</span> for <span class="math inline">\(j,k=0,1\)</span> and let <span class="math inline">\(\pi_X=\Pr(X=1)\)</span> and similarly for <span class="math inline">\(\pi_Y\)</span>. Then, the population version of the product-moment (Pearson) correlation can be easily seen to be</p>
<p><span class="math display">\[
\rho = \frac{\pi_{11} - \pi_X \pi_Y}{\sqrt{\pi_X(1-\pi_X)\pi_Y(1-\pi_Y)}} .
\]</span></p>
<p>Unlike the case for continuous data, it is not possible for this measure to achieve the limiting boundaries of the interval <span class="math inline">\([-1,1]\)</span>. To see this, students of probability may recall the Fréchet-Höeffding bounds for a joint distribution that turn out to be <span class="math inline">\(\max\{0, \pi_X+\pi_Y-1\} \le \pi_{11} \le \min\{\pi_X,\pi_Y\}\)</span> for this joint probability. (More discussion of these bounds is in Section <a href="ChapDependenceModel.html#S:Dep:Bounds">16.5.4.1</a>.) This limit on the joint probability imposes an additional restriction on the Pearson correlation. As an illustration, assume equal probabilities <span class="math inline">\(\pi_X =\pi_Y = \pi &gt; 1/2\)</span>. Then, the lower bound is
<span class="math display">\[\begin{eqnarray*}
\frac{2\pi - 1 - \pi^2}{\pi(1-\pi)} = -\frac{1-\pi}{\pi} .
\end{eqnarray*}\]</span>
For example, if <span class="math inline">\(\pi=0.8\)</span>, then the smallest that the Pearson correlation could be is -0.25. More generally, there are bounds on <span class="math inline">\(\rho\)</span> that depend on <span class="math inline">\(\pi_X\)</span> and <span class="math inline">\(\pi_Y\)</span> that make it difficult to interpret this measure.</p>
<p>As noted by <span class="citation"><a href="#ref-bishop1975discrete" role="doc-biblioref">Y. M. Bishop, Fienberg, and Holland</a> (<a href="#ref-bishop1975discrete" role="doc-biblioref">1975</a>)</span> (page 382), squaring this correlation coefficient yields the Pearson chi-square statistic (introduced in Section <a href="#S:goodness-of-fit"><strong>??</strong></a>). Despite the boundary problems described above, this feature makes the Pearson correlation coefficient a good choice for describing dependence with binary data.</p>
<p>As an alternative measure for Bernoulli variables, the <a href="#" class="tooltip" style="color:green"><em>odds ratio</em><span style="font-size:8pt">A statistic quantifying the strength of the association between two events, a and b, which is defined as the ratio of the odds of a in the presence of b and the odds of a in the absence of b</span></a> is given by
<span class="math display">\[\begin{eqnarray*}
OR(\pi_{11}) = \frac{\pi_{11} \pi_{00}}{\pi_{01} \pi_{10}} = \frac{\pi_{11} \left( 1+\pi_{11}-\pi_X -\pi_Y\right)}{(\pi_X-\pi_{11})(\pi_Y- \pi_{11})} .
\end{eqnarray*}\]</span>
Pleasant calculations show that <span class="math inline">\(OR(z)\)</span> is <span class="math inline">\(0\)</span> at the lower Fréchet-Höeffding bound <span class="math inline">\(z= \max\{0, \pi_X+\pi_Y-1\}\)</span> and is <span class="math inline">\(\infty\)</span> at the upper bound <span class="math inline">\(z=\min\{\pi_X,\pi_Y\}\)</span>. Thus, the bounds on this measure do not depend on the marginal probabilities <span class="math inline">\(\pi_X\)</span> and <span class="math inline">\(\pi_Y\)</span>, making it easier to interpret this measure.</p>
<p>As noted by <span class="citation"><a href="#ref-yule1900association" role="doc-biblioref">Yule</a> (<a href="#ref-yule1900association" role="doc-biblioref">1900</a>)</span>, odds ratios are invariant to the labeling of 0 and 1. Further, they are invariant to the marginals in the sense that one can rescale <span class="math inline">\(\pi_X\)</span> and <span class="math inline">\(\pi_Y\)</span> by positive constants and the odds ratio remains unchanged. Specifically, suppose that <span class="math inline">\(a_i\)</span>, <span class="math inline">\(b_j\)</span> are sets of positive constants and that</p>
<p><span class="math display">\[\begin{eqnarray*}
\pi_{ij}^{new} &amp;=&amp; a_i b_j \pi_{ij}
\end{eqnarray*}\]</span>
and <span class="math inline">\(\sum_{ij} \pi_{ij}^{new}=1.\)</span> Then,
<span class="math display">\[\begin{eqnarray*}
OR^{new} = \frac{(a_1 b_1 \pi_{11})( a_0 b_0 \pi_{00})}{(a_0 b_1 \pi_{01})( a_1 b_0\pi_{10})}
= \frac{\pi_{11} \pi_{00}}{\pi_{01} \pi_{10}} =OR^{old} .
\end{eqnarray*}\]</span></p>
<p>For additional help with interpretation, Yule proposed two transforms for the odds ratio, the first in <span class="citation"><a href="#ref-yule1900association" role="doc-biblioref">Yule</a> (<a href="#ref-yule1900association" role="doc-biblioref">1900</a>)</span>,
<span class="math display">\[\begin{eqnarray*}
\frac{OR-1}{OR+1},
\end{eqnarray*}\]</span>
and the second in <span class="citation"><a href="#ref-yule1912methods" role="doc-biblioref">Yule</a> (<a href="#ref-yule1912methods" role="doc-biblioref">1912</a>)</span>,
<span class="math display">\[\begin{eqnarray*}
\frac{\sqrt{OR}-1}{\sqrt{OR}+1}.
\end{eqnarray*}\]</span>
Although these statistics provide the same information as is the original odds ratio <span class="math inline">\(OR\)</span>, they have the advantage of taking values in the interval <span class="math inline">\([-1,1]\)</span>, making them easier to interpret.</p>
<p>In a later section, we will also see that the marginal distributions have no effect on the Fréchet-Höeffding of the <a href="#" class="tooltip" style="color:green"><em>tetrachoric correlation</em><span style="font-size:8pt">A technique for estimating the correlation between two theorised normally distributed continuous latent variables, from two observed binary variables</span></a>, another measure of association, see also, <span class="citation"><a href="#ref-joe2014dependence" role="doc-biblioref">Joe</a> (<a href="#ref-joe2014dependence" role="doc-biblioref">2014</a>)</span>, page 48.</p>
<p>From <a href="#tab:15.2">Table 15.2</a>, <span class="math inline">\(OR(\pi_{11})=\frac{1611(956)}{897(2175)}=0.79\)</span>. You can obtain the <span class="math inline">\(OR(\pi_{11})\)</span>, using the <code>oddsratio()</code> function from the <code>epitools</code> library in <code>R</code>. From the output below, <span class="math inline">\(OR(\pi_{11})=0.79\)</span> for the binary variables <span class="math inline">\({\tt NoClaimCredit}\)</span> and <span class="math inline">\({\tt Fire5}\)</span> from the LGPIF data.</p>
<p><a id=tab:15.2></a></p>
<p>Table 15.2. <strong>2 <span class="math inline">\(\times\)</span> 2 Table of Counts for <span class="math inline">\({\tt Fire5}\)</span> and <span class="math inline">\({\tt NoClaimCredit}\)</span></strong></p>
<p><span class="math display">\[
{\small \begin{matrix}
\begin{array}{l|rr|r} 
    \hline
                  &amp; \text{Fire5} &amp; &amp; \\
\text{NoClaimCredit} &amp; 0     &amp; 1     &amp; \text{Total} \\
  \hline
           0  &amp; 1611  &amp; 2175  &amp; 3786 \\
           1  &amp; 897   &amp; 956   &amp; 1853 \\
    \hline
    \text{Total}    &amp; 2508  &amp; 3131  &amp; 5639 \\
   \hline
\end{array}
\end{matrix}}
\]</span></p>
<h5 style="text-align: center;">
<a id="displayCode.wald.1" href="javascript:togglecode('toggleCode.wald.1','displayCode.wald.1');"><i><strong>R Code for Odds Ratios</strong></i></a>
</h5>
<div id="toggleCode.wald.1" style="display: none">
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="ChapDependenceModel.html#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(epitools)</span>
<span id="cb248-2"><a href="ChapDependenceModel.html#cb248-2" aria-hidden="true" tabindex="-1"></a><span class="fu">oddsratio</span>(NoClaimCredit, Fire5,<span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;wald&quot;</span>))<span class="sc">$</span>measure</span>
<span id="cb248-3"><a href="ChapDependenceModel.html#cb248-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-4"><a href="ChapDependenceModel.html#cb248-4" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span></span>
<span id="cb248-5"><a href="ChapDependenceModel.html#cb248-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]  <span class="fl">0.79</span></span></code></pre></div>
</div>
</div>
<div id="categorical-variables" class="section level4 hasAnchor" number="16.2.3.2">
<h4><span class="header-section-number">16.2.3.2</span> Categorical Variables<a href="ChapDependenceModel.html#categorical-variables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>More generally, let <span class="math inline">\((X,Y)\)</span> be a bivariate pair having <span class="math inline">\(ncat_X\)</span> and <span class="math inline">\(ncat_Y\)</span> numbers of categories, respectively. For a two-way table of counts, let <span class="math inline">\(n_{jk}\)</span> be the number in the <span class="math inline">\(j\)</span>th row, <span class="math inline">\(k\)</span>th column. Let <span class="math inline">\(n_{j\centerdot}\)</span> be the row margin total, <span class="math inline">\(n_{\centerdot k}\)</span> be the column margin total and <span class="math inline">\(n=\sum_{j,k} n_{j,k}\)</span>. Define the <a href="#" class="tooltip" style="color:green"><em>Pearson chi-square statistic</em><span style="font-size:8pt">A statistical test applied to sets of categorical data to evaluate how likely it is that any observed difference between the sets arose by chance</span></a> as
<span class="math display">\[\begin{eqnarray*}
\chi^2 = \sum_{jk} \frac{(n_{jk}- n_{j\centerdot}n_{\centerdot k}/n)^2}{n_{j\centerdot}n_{\centerdot k}/n} .
\end{eqnarray*}\]</span>
The <a href="#" class="tooltip" style="color:green"><em>likelihood ratio test</em><span style="font-size:8pt">A statistical test of the goodness-of-fit between two models</span></a> statistic is
<span class="math display">\[\begin{eqnarray*}
G^2 = 2 \sum_{jk} n_{jk} \log\frac{n_{jk}}{n_{j\centerdot}n_{\centerdot k}/n} .
\end{eqnarray*}\]</span>
Under the assumption of independence, both <span class="math inline">\(\chi^2\)</span> and <span class="math inline">\(G^2\)</span> have an asymptotic chi-square distribution with <span class="math inline">\((ncat_X-1)(ncat_Y-1)\)</span> degrees of freedom.</p>
<p>To help see what these statistics are estimating, let <span class="math inline">\(\pi_{jk} = \Pr(X=j, Y=k)\)</span> and let <span class="math inline">\(\pi_{X,j}=\Pr(X=j)\)</span> and similarly for <span class="math inline">\(\pi_{Y,k}\)</span>. Assuming that <span class="math inline">\(n_{jk}/n \approx \pi_{jk}\)</span> for large <span class="math inline">\(n\)</span> and similarly for the marginal probabilities, we have
<span class="math display">\[\begin{eqnarray*}
\frac{\chi^2}{n} \approx \sum_{jk} \frac{(\pi_{jk}- \pi_{X,j}\pi_{Y,k})^2}{\pi_{X,j}\pi_{Y,k}}
\end{eqnarray*}\]</span>
and
<span class="math display">\[\begin{eqnarray*}
\frac{G^2}{n} \approx 2 \sum_{jk} \pi_{jk} \log\frac{\pi_{jk}}{\pi_{X,j}\pi_{Y,k}} .
\end{eqnarray*}\]</span>
Under the null hypothesis of independence, we have <span class="math inline">\(\pi_{jk} =\pi_{X,j}\pi_{Y,k}\)</span> and it is clear from these approximations that we anticipate that these statistics will be small under this hypothesis.</p>
<p>Classical approaches, as described in <span class="citation"><a href="#ref-bishop1975discrete" role="doc-biblioref">Y. M. Bishop, Fienberg, and Holland</a> (<a href="#ref-bishop1975discrete" role="doc-biblioref">1975</a>)</span> (page 374), distinguish between tests of independence and measures of associations. The former are designed to detect whether a relationship exists whereas the latter are meant to assess the type and extent of a relationship. We acknowledge these differing purposes but also less concerned with this distinction for actuarial applications.</p>
<p><a id=tab:15.3></a></p>
<p>Table 15.3. <strong>Two-way Table of Counts for <span class="math inline">\({\tt EntityType}\)</span> and <span class="math inline">\({\tt NoClaimCredit}\)</span></strong></p>
<p><span class="math display">\[
{\small \begin{matrix}
\begin{array}{l|rr} 
    \hline
                  &amp; \text{NoClaimCredit} &amp;  \\
       \text{EntityType} &amp; 0     &amp; 1      \\
  \hline
            \text{City}    &amp; 644  &amp; 149 \\
          \text{County}    &amp; 310  &amp;  18 \\
            \text{Misc}    &amp; 336  &amp; 273 \\
          \text{School}    &amp; 1103 &amp; 494 \\
           \text{Town}     &amp; 492  &amp; 479 \\
         \text{Village}    &amp; 901  &amp; 440 \\
   \hline
\end{array}
\end{matrix}}
\]</span></p>
<p>You can obtain the Pearson chi-square statistic, using the <code>chisq.test()</code> function from the <code>MASS</code> library in <code>R</code>. Here, we test whether the <span class="math inline">\({\tt EntityType}\)</span> variable is independent of the <span class="math inline">\({\tt NoClaimCredit}\)</span> variable using <a href="#tab:15.3">Table 15.3</a>.</p>
<h5 style="text-align: center;">
<a id="displayCode.chi.1" href="javascript:togglecode('toggleCode.chi.1','displayCode.chi.1');"><i><strong>R Code for Pearson Chi-square Statistic</strong></i></a>
</h5>
<div id="toggleCode.chi.1" style="display: none">
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="ChapDependenceModel.html#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb249-2"><a href="ChapDependenceModel.html#cb249-2" aria-hidden="true" tabindex="-1"></a>table <span class="ot">=</span> <span class="fu">table</span>(EntityType, NoClaimCredit)</span>
<span id="cb249-3"><a href="ChapDependenceModel.html#cb249-3" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(table)</span>
<span id="cb249-4"><a href="ChapDependenceModel.html#cb249-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-5"><a href="ChapDependenceModel.html#cb249-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-6"><a href="ChapDependenceModel.html#cb249-6" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span></span>
<span id="cb249-7"><a href="ChapDependenceModel.html#cb249-7" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------</span></span>
<span id="cb249-8"><a href="ChapDependenceModel.html#cb249-8" aria-hidden="true" tabindex="-1"></a> Test statistic   df     P value    </span>
<span id="cb249-9"><a href="ChapDependenceModel.html#cb249-9" aria-hidden="true" tabindex="-1"></a><span class="sc">----------------</span> <span class="sc">----</span> <span class="sc">--------------</span></span>
<span id="cb249-10"><a href="ChapDependenceModel.html#cb249-10" aria-hidden="true" tabindex="-1"></a>     <span class="fl">344.2</span>        <span class="dv">5</span>   <span class="fl">3.15e-72</span> <span class="sc">*</span> <span class="er">*</span> <span class="er">*</span></span>
<span id="cb249-11"><a href="ChapDependenceModel.html#cb249-11" aria-hidden="true" tabindex="-1"></a><span class="sc">------------------------------------</span></span>
<span id="cb249-12"><a href="ChapDependenceModel.html#cb249-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-13"><a href="ChapDependenceModel.html#cb249-13" aria-hidden="true" tabindex="-1"></a>Table<span class="sc">:</span> Pearson<span class="st">&#39;s Chi-squared test</span></span></code></pre></div>
</div>
<p>As the p-value is less than the .05 significance level, we reject the null hypothesis that <span class="math inline">\({\tt EntityType}\)</span> is independent of <span class="math inline">\({\tt NoClaimCredit}\)</span>.</p>
<p>Furthermore, you can obtain the likelihood ratio test statistic, using the <code>likelihood.test()</code> function from the <code>Deducer</code> library in <code>R</code>. From below, we test whether <span class="math inline">\({\tt EntityType}\)</span> is independent of <span class="math inline">\({\tt NoClaimCredit}\)</span> from the LGPIF data. The same conclusion is drawn as the Pearson chi-square test.</p>
<h5 style="text-align: center;">
<a id="displayCode.lik.1" href="javascript:togglecode('toggleCode.lik.1','displayCode.lik.1');"><i><strong>R Code for Likelihood Ratio Test Statistic</strong></i></a>
</h5>
<div id="toggleCode.lik.1" style="display: none">
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="ChapDependenceModel.html#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Deducer)</span>
<span id="cb250-2"><a href="ChapDependenceModel.html#cb250-2" aria-hidden="true" tabindex="-1"></a><span class="fu">likelihood.test</span>(EntityType, NoClaimCredit)</span>
<span id="cb250-3"><a href="ChapDependenceModel.html#cb250-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-4"><a href="ChapDependenceModel.html#cb250-4" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span></span>
<span id="cb250-5"><a href="ChapDependenceModel.html#cb250-5" aria-hidden="true" tabindex="-1"></a><span class="sc">-----------------------------------------</span></span>
<span id="cb250-6"><a href="ChapDependenceModel.html#cb250-6" aria-hidden="true" tabindex="-1"></a> Test statistic   X<span class="sc">-</span>squared df   P value </span>
<span id="cb250-7"><a href="ChapDependenceModel.html#cb250-7" aria-hidden="true" tabindex="-1"></a><span class="sc">----------------</span> <span class="sc">--------------</span> <span class="sc">---------</span></span>
<span id="cb250-8"><a href="ChapDependenceModel.html#cb250-8" aria-hidden="true" tabindex="-1"></a>     <span class="fl">378.7</span>             <span class="dv">5</span>         <span class="dv">0</span> <span class="sc">*</span> <span class="er">*</span> <span class="er">*</span> </span>
<span id="cb250-9"><a href="ChapDependenceModel.html#cb250-9" aria-hidden="true" tabindex="-1"></a><span class="sc">-----------------------------------------</span></span>
<span id="cb250-10"><a href="ChapDependenceModel.html#cb250-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-11"><a href="ChapDependenceModel.html#cb250-11" aria-hidden="true" tabindex="-1"></a>Table<span class="sc">:</span> Log likelihood <span class="fu">ratio</span> (G<span class="sc">-</span>test) test of independence without correction</span></code></pre></div>
</div>
</div>
</div>
<div id="ordinal-variables" class="section level3 hasAnchor" number="16.2.4">
<h3><span class="header-section-number">16.2.4</span> Ordinal Variables<a href="ChapDependenceModel.html#ordinal-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As the analyst moves from the continuous to the nominal scale, there are two main sources of loss of information <span class="citation"><a href="#ref-bishop1975discrete" role="doc-biblioref">Y. M. Bishop, Fienberg, and Holland</a> (<a href="#ref-bishop1975discrete" role="doc-biblioref">1975</a>)</span> (page 343). The first is breaking the precise continuous measurements into groups. The second is losing the ordering of the groups. So, it is sensible to describe what we can do with variables that are in discrete groups but where the ordering is known.</p>
<p>As described in Section <a href="ChapDataAnalytics.html#S:QuaVar">2.3.1.1</a>, ordinal variables provide a clear ordering of levels of a variable but distances between levels are unknown. Associations have traditionally been quantified parametrically using normal-based correlations and nonparametrically using Spearman correlations with tied ranks.</p>
<div id="parametric-approach-using-normal-based-correlations" class="section level4 hasAnchor" number="16.2.4.1">
<h4><span class="header-section-number">16.2.4.1</span> Parametric Approach Using Normal Based Correlations<a href="ChapDependenceModel.html#parametric-approach-using-normal-based-correlations" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Refer to page 60, Section 2.12.7 of <span class="citation"><a href="#ref-joe2014dependence" role="doc-biblioref">Joe</a> (<a href="#ref-joe2014dependence" role="doc-biblioref">2014</a>)</span>. Let <span class="math inline">\((y_1,y_2)\)</span> be a bivariate pair with discrete values on <span class="math inline">\(m_1, \ldots, m_2\)</span>. For a two-way table of ordinal counts, let <span class="math inline">\(n_{st}\)</span> be the number in the <span class="math inline">\(s\)</span>th row, <span class="math inline">\(t\)</span> column. Let <span class="math inline">\((n_{m_1\centerdot}, \ldots, n_{m_2\centerdot})\)</span> be the row margin total, <span class="math inline">\((n_{\centerdot m_1}, \ldots, n_{\centerdot m_2})\)</span> be the column margin total and <span class="math inline">\(n=\sum_{s,t} n_{s,t}\)</span>.</p>
<p>Let <span class="math inline">\(\hat{\xi}_{1s} = \Phi^{-1}((n_{m_1}+\cdots+n_{s\centerdot})/n)\)</span> for <span class="math inline">\(s=m_1, \ldots, m_2\)</span> be a cutpoint and similarly for <span class="math inline">\(\hat{\xi}_{2t}\)</span>. The <a href="#" class="tooltip" style="color:green"><em>polychoric correlation</em><span style="font-size:8pt">A technique for estimating the correlation between two theorised normally distributed continuous latent variables, from two observed ordinal variables</span></a>, based on a two-step estimation procedure, is</p>
<p><span class="math display">\[
\begin{array}{cr}
  \hat{\rho_N} &amp;=\text{argmax}_{\rho}
  \sum_{s=m_1}^{m_2} \sum_{t=m_1}^{m_2} n_{st} \log\left\{
    \Phi_2(\hat{\xi}_{1s}, \hat{\xi}_{2t};\rho)
    -\Phi_2(\hat{\xi}_{1,s-1}, \hat{\xi}_{2t};\rho) \right.\\
   &amp; \left. -\Phi_2(\hat{\xi}_{1s}, \hat{\xi}_{2,t-1};\rho)
    +\Phi_2(\hat{\xi}_{1,s-1}, \hat{\xi}_{2,t-1};\rho)
    \right\} .
\end{array}
\]</span></p>
<p>It is called a <em>tetrachoric</em> correlation for binary variables.</p>
<p><a id=tab:15.4></a></p>
<p>Table 15.4. <strong>Two-way Table of Counts for <span class="math inline">\({\tt AlarmCredit}\)</span> and <span class="math inline">\({\tt NoClaimCredit}\)</span></strong></p>
<p><span class="math display">\[
{\small \begin{matrix}
\begin{array}{c|rr} 
    \hline
                  &amp; \text{NoClaimCredit} &amp;  \\
\text{AlarmCredit} &amp; 0     &amp; 1      \\
  \hline
          1  &amp; 1669  &amp;  942   \\
          2  &amp;    121 &amp;  118 \\
          3  &amp;  195  &amp;   132 \\
          4 &amp;  1801  &amp;   661 \\
   \hline
\end{array}
\end{matrix}}
\]</span></p>
<p>You can obtain the polychoric or tetrachoric correlation using the <code>polychoric()</code> or <code>tetrachoric()</code> function from the <code>psych</code> library in <code>R</code>. The polychoric correlation is illustrated using <a href="#tab:15.4">Table 15.4</a>. Here, <span class="math inline">\(\hat{\rho}_N=-0.14\)</span>, which means that there is a negative relationship between <span class="math inline">\({\tt AlarmCredit}\)</span> and <span class="math inline">\({\tt NoClaimCredit}\)</span>.</p>
<h5 style="text-align: center;">
<a id="displayCode.poly.1" href="javascript:togglecode('toggleCode.poly.1','displayCode.poly.1');"><i><strong>R Code for Polychoric Correlation</strong></i></a>
</h5>
<div id="toggleCode.poly.1" style="display: none">
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="ChapDependenceModel.html#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb251-2"><a href="ChapDependenceModel.html#cb251-2" aria-hidden="true" tabindex="-1"></a>AlarmCredit<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(<span class="fu">ifelse</span>(Insample<span class="sc">$</span>AC00<span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;1&quot;</span>,</span>
<span id="cb251-3"><a href="ChapDependenceModel.html#cb251-3" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">ifelse</span>(Insample<span class="sc">$</span>AC05<span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;2&quot;</span>,</span>
<span id="cb251-4"><a href="ChapDependenceModel.html#cb251-4" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(Insample<span class="sc">$</span>AC10<span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;3&quot;</span>,</span>
<span id="cb251-5"><a href="ChapDependenceModel.html#cb251-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">ifelse</span>(Insample<span class="sc">$</span>AC15<span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;4&quot;</span>,<span class="dv">0</span>)))))</span>
<span id="cb251-6"><a href="ChapDependenceModel.html#cb251-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">table</span>(AlarmCredit,NoClaimCredit)</span>
<span id="cb251-7"><a href="ChapDependenceModel.html#cb251-7" aria-hidden="true" tabindex="-1"></a>rhoN<span class="ot">&lt;-</span><span class="fu">polychoric</span>(x,<span class="at">correct=</span><span class="cn">FALSE</span>)<span class="sc">$</span>rho</span>
<span id="cb251-8"><a href="ChapDependenceModel.html#cb251-8" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(rhoN,<span class="dv">2</span>)</span>
<span id="cb251-9"><a href="ChapDependenceModel.html#cb251-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-10"><a href="ChapDependenceModel.html#cb251-10" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span></span>
<span id="cb251-11"><a href="ChapDependenceModel.html#cb251-11" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="sc">-</span><span class="fl">0.14</span></span></code></pre></div>
</div>
</div>
</div>
<div id="interval-variables" class="section level3 hasAnchor" number="16.2.5">
<h3><span class="header-section-number">16.2.5</span> Interval Variables<a href="ChapDependenceModel.html#interval-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As described in Section <a href="ChapDataAnalytics.html#S:QuanVar">2.3.1.2</a>, interval variables provide a clear ordering of levels of a variable and the numerical distance between any two levels of the scale can be readily interpretable. For example, driver’s age group variable is an interval variable.</p>
<p>For measuring association, both the continuous variable and ordinal variable approaches make sense. The former takes advantage of knowledge of the ordering although assumes continuity. The latter does not rely on continuity but also does not make use of the information given by the distance between scales.</p>
</div>
<div id="discrete-and-continuous-variables" class="section level3 hasAnchor" number="16.2.6">
<h3><span class="header-section-number">16.2.6</span> Discrete and Continuous Variables<a href="ChapDependenceModel.html#discrete-and-continuous-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <a href="#" class="tooltip" style="color:green"><em>polyserial correlation</em><span style="font-size:8pt">The correlation between two continuous variables with a bivariate normal distribution, where one variable is observed directly, and the other is unobserved</span></a> is defined similarly, when one variable (<span class="math inline">\(y_1\)</span>) is continuous and the other (<span class="math inline">\(y_2\)</span>) ordinal. Define <span class="math inline">\(z\)</span> to be the <a href="#" class="tooltip" style="color:green"><em>normal score</em><span style="font-size:8pt">Transformed data which closely resemble a standard normal distribution</span></a> of <span class="math inline">\(y_1\)</span>. The polyserial correlation is</p>
<p><span class="math display">\[
\hat{\rho_N} = \text{argmax}_{\rho}
\sum_{i=1}^n \log\left\{ \phi(z_{i1})\left[
\Phi\left(\frac{\hat{\xi}_{2,y_{i2}} - \rho z_{i1}}
{(1-\rho^2)^{1/2}}\right)
-\Phi\left(\frac{\hat{\xi}_{2,y_{i2-1}} - \rho z_{i1}}
{(1-\rho^2)^{1/2}}\right)
\right]
\right\} .
\]</span></p>
<p>The <a href="#" class="tooltip" style="color:green"><em>biserial correlation</em><span style="font-size:8pt">A correlation coefficient used when one variable is dichotomous</span></a> is defined similarly, when one variable is continuous and the other binary.</p>
<p><a id=tab:15.5></a></p>
<p>Table 15.5. <strong>Summary of <span class="math inline">\({\tt Claim}\)</span> by <span class="math inline">\({\tt NoClaimCredit}\)</span></strong></p>
<p><span class="math display">\[
{\small \begin{matrix}
\begin{array}{l|r|r} 
    \hline
\text{NoClaimCredit} &amp; \text{Mean}     &amp;\text{Total}       \\
 &amp; \text{Claim}     &amp;\text{Claim}       \\
  \hline
          0  &amp; 22,505  &amp;  85,200,483   \\
          1  &amp;    6,629 &amp;  12,282,618 \\
   \hline
\end{array}
\end{matrix}}
\]</span></p>
<p>You can obtain the polyserial or biserial correlation using the <code>polyserial()</code> or <code>biserial()</code> function, respectively, from the <code>psych</code> library in <code>R</code>. <a href="#tab:15.5">Table 15.5</a> gives the summary of <span class="math inline">\({\tt Claim}\)</span> by <span class="math inline">\({\tt NoClaimCredit}\)</span> and the biserial correlation is illustrated using <code>R</code> code below. The <span class="math inline">\(\hat{\rho}_N=-0.04\)</span> which means that there is a negative correlation between <span class="math inline">\({\tt Claim}\)</span> and <span class="math inline">\({\tt NoClaimCredit}\)</span>.</p>
<h5 style="text-align: center;">
<a id="displayCode.bis.1" href="javascript:togglecode('toggleCode.bis.1','displayCode.bis.1');"><i><strong>R Code for Biserial Correlation</strong></i></a>
</h5>
<div id="toggleCode.bis.1" style="display: none">
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="ChapDependenceModel.html#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb252-2"><a href="ChapDependenceModel.html#cb252-2" aria-hidden="true" tabindex="-1"></a>rhoN<span class="ot">&lt;-</span><span class="fu">biserial</span>(Claim,NoClaimCredit)</span>
<span id="cb252-3"><a href="ChapDependenceModel.html#cb252-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(rhoN,<span class="dv">2</span>)</span>
<span id="cb252-4"><a href="ChapDependenceModel.html#cb252-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-5"><a href="ChapDependenceModel.html#cb252-5" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span></span>
<span id="cb252-6"><a href="ChapDependenceModel.html#cb252-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="sc">-</span><span class="fl">0.04</span></span></code></pre></div>
</div>
<div id="surveyElement142">

</div>
<div id="surveyResult142">

</div>
<h5 style="text-align: center;">
<a id="display.Quiz142.1" href="javascript:toggleQuiz
('display.Quiz142.2','display.Quiz142.1');"><i><strong>Show Quiz Solution</strong></i></a>
</h5>
<div id="display.Quiz142.2" style="display: none">
<p id="Quiz142Soln">
</p>
<hr />
</div>
<script type="text/javascript" src="./Quizzes/QuizJavascript/Quiz142.js">
</script>
</div>
</div>
<div id="S:Copula" class="section level2 hasAnchor" number="16.3">
<h2><span class="header-section-number">16.3</span> Introduction to Copulas<a href="ChapDependenceModel.html#S:Copula" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<hr />
<p>In this section, you learn how to:</p>
<ul>
<li>Describe a multivariate distribution function in terms of a copula function.</li>
</ul>
<hr />
<p>Copulas are widely used in insurance and many other fields to model the dependence among multivariate outcomes. A <a href="#" class="tooltip" style="color:green"><em>copula</em><span style="font-size:8pt">A multivariate distribution function with uniform marginals</span></a> is a multivariate distribution function with uniform marginals. Specifically, let <span class="math inline">\(\{U_1, \ldots, U_p\}\)</span> be <span class="math inline">\(p\)</span> uniform random variables on <span class="math inline">\((0,1)\)</span>. Their distribution function <span class="math display">\[{C}(u_1, \ldots, u_p) = \Pr(U_1 \leq u_1, \ldots, U_p \leq u_p),\]</span></p>
<p>is a copula. We seek to use copulas in applications that are based on more than just uniformly distributed data. Thus, consider arbitrary marginal distribution functions <span class="math inline">\({F}_1(y_1)\)</span>,…,<span class="math inline">\({F}_p(y_p)\)</span>. Then, we can define a multivariate distribution function using the copula such that</p>
<p><span class="math display" id="eq:DFDefined">\[\begin{equation}
{F}(y_1, \ldots, y_p)= {C}({F}_1(y_1), \ldots, {F}_p(y_p)).
\tag{16.1}
\end{equation}\]</span></p>
<p>Here, <span class="math inline">\(F\)</span> is a multivariate distribution function. <span class="citation"><a href="#ref-sklar1959fonctions" role="doc-biblioref">Sklar</a> (<a href="#ref-sklar1959fonctions" role="doc-biblioref">1959</a>)</span> showed that <span class="math inline">\(any\)</span> multivariate distribution function <span class="math inline">\(F\)</span>, can be written in the form of equation <a href="ChapDependenceModel.html#eq:DFDefined">(16.1)</a>, that is, using a copula representation.</p>
<p>Sklar also showed that, if the marginal distributions are continuous, then there is a unique copula representation. In this chapter we focus on copula modeling with continuous variables. For discrete case, readers can see <span class="citation"><a href="#ref-joe2014dependence" role="doc-biblioref">Joe</a> (<a href="#ref-joe2014dependence" role="doc-biblioref">2014</a>)</span> and <span class="citation"><a href="#ref-genest2007methods" role="doc-biblioref">Genest and Nešlohva</a> (<a href="#ref-genest2007methods" role="doc-biblioref">2007</a>)</span>.</p>
<p>For the bivariate case where <span class="math inline">\(p=2\)</span>, we can write a copula and the distribution function of two random variables as</p>
<p><span class="math display">\[
{C}(u_1, \, u_2) = \Pr(U_1 \leq u_1, \, U_2 \leq u_2)
\]</span></p>
<p>and</p>
<p><span class="math display">\[
{F}(y_1, \, y_2)= {C}({F}_1(y_1),  {F}_p(y_2)).
\]</span></p>
<p>As an example, we can look to the copula due to <span class="citation"><a href="#ref-frank1979simultaneous" role="doc-biblioref">Frank</a> (<a href="#ref-frank1979simultaneous" role="doc-biblioref">1979</a>)</span>. The copula (distribution function) is</p>
<p><span class="math display" id="eq:FrankCopula">\[\begin{equation}
{C}(u_1,u_2) = \frac{1}{\gamma} \log \left( 1+ \frac{ (\exp(\gamma
u_1) -1)(\exp(\gamma u_2) -1)} {\exp(\gamma) -1} \right).
\tag{16.2}
\end{equation}\]</span></p>
<p>This is a bivariate distribution function with its domain on the unit square <span class="math inline">\([0,1]^2.\)</span> Here <span class="math inline">\(\gamma\)</span> is dependence parameter, that is, the range of dependence is controlled by the parameter <span class="math inline">\(\gamma\)</span>. Positive association increases as <span class="math inline">\(\gamma\)</span> increases. As we will see, this positive association can be summarized with <a href="#" class="tooltip" style="color:green"><em>Spearman’s rho</em><span style="font-size:8pt"></span></a> (<span class="math inline">\(\rho_S\)</span>) and Kendall’s tau (<span class="math inline">\(\tau\)</span>). Frank’s copula is commonly used. We will see other copula functions in Section <a href="ChapDependenceModel.html#S:CopTyp">16.5</a>.</p>
<div id="surveyElement143">

</div>
<div id="surveyResult143">

</div>
<h5 style="text-align: center;">
<a id="display.Quiz143.1" href="javascript:toggleQuiz
('display.Quiz143.2','display.Quiz143.1');"><i><strong>Show Quiz Solution</strong></i></a>
</h5>
<div id="display.Quiz143.2" style="display: none">
<p id="Quiz143Soln">
</p>
<hr />
</div>
<script type="text/javascript" src="./Quizzes/QuizJavascript/Quiz143.js">
</script>
</div>
<div id="S:CopAppl" class="section level2 hasAnchor" number="16.4">
<h2><span class="header-section-number">16.4</span> Application Using Copulas<a href="ChapDependenceModel.html#S:CopAppl" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<hr />
<p>In this section, you learn how to:</p>
<ul>
<li>Discover dependence structure between random variables</li>
<li>Model the dependence with a copula function</li>
</ul>
<hr />
<p>This section analyzes the insurance losses and expenses data with the statistical program <code>R</code>. The data set was introduced in <span class="citation"><a href="#ref-frees1998understanding" role="doc-biblioref">Edward W. Frees and Valdez</a> (<a href="#ref-frees1998understanding" role="doc-biblioref">1998</a>)</span> and is now readily available in the <code>copula</code> package. The model fitting process is started by marginal modeling of each of the two variables, <span class="math inline">\({\tt LOSS}\)</span> and <span class="math inline">\({\tt ALAE}\)</span>. Then we model the joint distribution of these marginal outcomes.</p>
<div id="data-description" class="section level3 hasAnchor" number="16.4.1">
<h3><span class="header-section-number">16.4.1</span> Data Description<a href="ChapDependenceModel.html#data-description" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We start with a sample (<span class="math inline">\(n = 1500\)</span>) from the whole data. We consider first two variables of the data; <em>losses</em> and <em>expenses</em>.</p>
<ul>
<li><span class="math inline">\({\tt LOSS}\)</span>, general liability claims from the Insurance Services Office, Inc. (ISO)</li>
<li><span class="math inline">\({\tt ALAE}\)</span>, specifically attributable to the settlement of individual claims (e.g. lawyer’s fees, claims investigation expenses)</li>
</ul>
<p>To visualize the relationship between losses and expenses, the scatterplots in Figure <a href="ChapDependenceModel.html#fig:Scatter">16.2</a> are created on dollar and log dollar scales. It is difficult to see any relationship between the two variables in the left-hand panel. Their dependence is more evident when viewed on the log scale, as in the right-hand panel.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Scatter"></span>
<img src="LossDataAnalytics_files/figure-html/Scatter-1.png" alt="Scatter Plot of LOSS and ALAE" width="80%" />
<p class="caption">
Figure 16.2: <strong>Scatter Plot of LOSS and ALAE</strong>
</p>
</div>
<h5 style="text-align: center;">
<a id="displayCode.ScaHis.1" href="javascript:togglecode('toggleCode.ScaHis.1','displayCode.ScaHis.1');"><i><strong>R Code for Loss versus Expense Scatterplots</strong></i></a>
</h5>
<div id="toggleCode.ScaHis.1" style="display: none">
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="ChapDependenceModel.html#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(copula)</span>
<span id="cb253-2"><a href="ChapDependenceModel.html#cb253-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(loss)  <span class="co"># loss data from copula library</span></span>
<span id="cb253-3"><a href="ChapDependenceModel.html#cb253-3" aria-hidden="true" tabindex="-1"></a>LOSS <span class="ot">&lt;-</span> loss<span class="sc">$</span>loss</span>
<span id="cb253-4"><a href="ChapDependenceModel.html#cb253-4" aria-hidden="true" tabindex="-1"></a>ALAE <span class="ot">&lt;-</span> loss<span class="sc">$</span>alae</span>
<span id="cb253-5"><a href="ChapDependenceModel.html#cb253-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb253-6"><a href="ChapDependenceModel.html#cb253-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(LOSS, ALAE, <span class="at">cex =</span> <span class="fl">0.5</span>)  <span class="co"># dollar scale</span></span>
<span id="cb253-7"><a href="ChapDependenceModel.html#cb253-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(LOSS), <span class="fu">log</span>(ALAE), <span class="at">cex =</span> <span class="fl">0.5</span>)  <span class="co"># log scale</span></span></code></pre></div>
</div>
</div>
<div id="marginal-models" class="section level3 hasAnchor" number="16.4.2">
<h3><span class="header-section-number">16.4.2</span> Marginal Models<a href="ChapDependenceModel.html#marginal-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We first examine the <a href="#" class="tooltip" style="color:green"><em>marginal distributions</em><span style="font-size:8pt">The probability distribution of the variables contained in the subset of a collection of random variables</span></a> of losses and expenses before going through the joint modeling. The histograms show that both <span class="math inline">\({\tt LOSS}\)</span> and <span class="math inline">\({\tt ALAE}\)</span> are right-skewed and <a href="#" class="tooltip" style="color:green"><em>fat-tailed</em><span style="font-size:8pt">A fat-tailed distribution is a probability distribution that exhibits a large skewness or kurtosis, relative to that of either a normal distribution or an exponential distribution</span></a>. Because of these features, for both marginal distributions of losses and expenses, we consider a Pareto distribution, distribution function of the form</p>
<p><span class="math display">\[
F(y)=1- \left( 1 + \frac{\theta}{y+ \theta} \right) ^{\alpha}.
\]</span></p>
<p>Here, <span class="math inline">\(\theta\)</span> is a scale parameter and <span class="math inline">\(\alpha\)</span> is a shape parameter. Section <a href="ChapSummaryDistributions.html#S:ContinuousDistributions">20.2</a> provides details of this distribution.</p>
<p>The marginal distributions of losses and expenses are fit using the method of maximum likelihood. Specifically, we use the <code>vglm</code> function from the <code>R VGAM</code> package. Firstly, we fit the marginal distribution of <span class="math inline">\({\tt ALAE}\)</span>. Parameters are summarized in <a href="#tab:15.6">Table 15.6</a>.</p>
<h5 style="text-align: center;">
<a id="displayCode.Reg.1" href="javascript:togglecode('toggleCode.Reg.1','displayCode.Reg.1');"><i><strong>R Code for Pareto Fitting of ALAE</strong></i></a>
</h5>
<div id="toggleCode.Reg.1" style="display: none">
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="ChapDependenceModel.html#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VGAM)</span>
<span id="cb254-2"><a href="ChapDependenceModel.html#cb254-2" aria-hidden="true" tabindex="-1"></a>fit.ALAE <span class="ot">&lt;-</span> <span class="fu">vglm</span>(ALAE <span class="sc">~</span> <span class="dv">1</span>, <span class="fu">paretoII</span>(<span class="at">location=</span><span class="dv">0</span>, <span class="at">lscale=</span><span class="st">&quot;loge&quot;</span>, <span class="at">lshape=</span><span class="st">&quot;loge&quot;</span>)) <span class="co"># fit the model by vlgm function</span></span>
<span id="cb254-3"><a href="ChapDependenceModel.html#cb254-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(fit.ALAE, <span class="at">matrix=</span><span class="cn">TRUE</span>) <span class="co"># extract fitted model coefficients, matrix=TRUE gives logarithm of estimated parameters instead of default normal scale estimates</span></span>
<span id="cb254-4"><a href="ChapDependenceModel.html#cb254-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-5"><a href="ChapDependenceModel.html#cb254-5" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span> </span>
<span id="cb254-6"><a href="ChapDependenceModel.html#cb254-6" aria-hidden="true" tabindex="-1"></a>               <span class="fu">loge</span>(scale) <span class="fu">loge</span>(shape)</span>
<span id="cb254-7"><a href="ChapDependenceModel.html#cb254-7" aria-hidden="true" tabindex="-1"></a> (Intercept)     <span class="fl">9.624673</span>   <span class="fl">0.7988753</span></span>
<span id="cb254-8"><a href="ChapDependenceModel.html#cb254-8" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb254-9"><a href="ChapDependenceModel.html#cb254-9" aria-hidden="true" tabindex="-1"></a>                  scale        shape </span>
<span id="cb254-10"><a href="ChapDependenceModel.html#cb254-10" aria-hidden="true" tabindex="-1"></a> (Intercept)  <span class="fl">15133.603598</span>     <span class="fl">2.223039</span> </span></code></pre></div>
</div>
<p>We repeat this procedure to fit the marginal distribution of the <span class="math inline">\({\tt LOSS}\)</span> variable. Because the loss variable also seems right-skewed and heavy-tailed data, we also model the marginal distribution with the Pareto distribution (although with different parameters).</p>
<h5 style="text-align: center;">
<a id="displayCode.ParFit.1" href="javascript:togglecode('toggleCode.ParFit.1','displayCode.ParFit.1');"><i><strong>R Code for Pareto Fitting of LOSS</strong></i></a>
</h5>
<div id="toggleCode.ParFit.1" style="display: none">
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="ChapDependenceModel.html#cb255-1" aria-hidden="true" tabindex="-1"></a>fit.LOSS <span class="ot">&lt;-</span> <span class="fu">vglm</span>(LOSS <span class="sc">~</span> <span class="dv">1</span>, paretoII, <span class="at">trace=</span><span class="cn">TRUE</span>)</span>
<span id="cb255-2"><a href="ChapDependenceModel.html#cb255-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Coef</span>(fit.LOSS)</span>
<span id="cb255-3"><a href="ChapDependenceModel.html#cb255-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-4"><a href="ChapDependenceModel.html#cb255-4" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span> </span>
<span id="cb255-5"><a href="ChapDependenceModel.html#cb255-5" aria-hidden="true" tabindex="-1"></a>       scale        shape </span>
<span id="cb255-6"><a href="ChapDependenceModel.html#cb255-6" aria-hidden="true" tabindex="-1"></a><span class="fl">16228.14797</span>     <span class="fl">1.23766</span></span></code></pre></div>
</div>
<p><a id=tab:15.6></a></p>
<p>Table 15.6. <strong>Summary of Pareto Maximum Likelihood Fitted Parameters from the LGPIF Data</strong></p>
<p><span class="math display">\[
{\small \begin{matrix}
\begin{array}{l|r|r} 
    \hline
 &amp; \text{Shape } \hat{\theta}     &amp;\text{Scale }    \hat{\alpha}     \\
  \hline
ALAE  &amp; 15133.60360  &amp;  2.22304    \\
LOSS  &amp;    16228.14797  &amp;  1.23766 \\
   \hline
\end{array}
\end{matrix}}
\]</span></p>
<p>To visualize the fitted distribution of <span class="math inline">\({\tt LOSS}\)</span> and <span class="math inline">\({\tt ALAE}\)</span> variables, one can use the estimated parameters and plot the corresponding distribution function and density function. For more details on the selection of marginal models, see Chapter <a href="ChapModelSelection.html#ChapModelSelection">6</a>.</p>
</div>
<div id="probability-integral-transformation" class="section level3 hasAnchor" number="16.4.3">
<h3><span class="header-section-number">16.4.3</span> Probability Integral Transformation<a href="ChapDependenceModel.html#probability-integral-transformation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When studying simulation, in Section <a href="ChapSimulation.html#S:InverseTransform">8.1.2</a> we learned about the <a href="#" class="tooltip" style="color:green"><em>inverse transform method</em><span style="font-size:8pt">Samples a uniform number between 0 and 1 to represent the randomly selected percentile, then uses the inverse of the cumulative density function of the desired distribution to simulate from in order to find the simulated value from the desired distribution</span></a>. This is a way of mapping a <span class="math inline">\(U(0,1)\)</span> random variable into a random variable <span class="math inline">\(X\)</span> with distribution function <span class="math inline">\(F\)</span> via the inverse of the distribution, that is, <span class="math inline">\(X = F^{-1}(U)\)</span>. The <a href="#" class="tooltip" style="color:green"><em>probability integral transformation</em><span style="font-size:8pt">Any continuous variable can be mapped to a uniform random variable via its distribution function</span></a> goes in the other direction, it states that <span class="math inline">\(F(X) = U\)</span>. Although the inverse transform result is available when the underlying random variable is continuous, discrete or a hybrid combination of the two, the probability integral transform is mainly useful when the distribution is continuous. That is the focus of this chapter.</p>
<p>We use the probability integral transform for two purposes: (1) for diagnostic purposes, to check that we have correctly specified a distribution function and (2) as an input into the copula function in equation <a href="ChapDependenceModel.html#eq:DFDefined">(16.1)</a>.</p>
<p>For the first purpose, we can check to see whether the Pareto is a reasonable distribution to model our marginal distributions. Given the fitted Pareto distribution, the variable <span class="math inline">\({\tt ALAE}\)</span> is transformed to the variable <span class="math inline">\(u_1\)</span>, which follows a uniform distribution on <span class="math inline">\([0,1]\)</span>:</p>
<p><span class="math display">\[
u_1 = \hat{F}_{1}^{-1}(ALAE) = 1 - \left( 1 + \frac{ALAE}{\hat{\theta}} \right)^{-\hat{\alpha}}.
\]</span></p>
<p>After applying the probability integral transformation to the <span class="math inline">\({\tt ALAE}\)</span> variable, we plot the histogram of <em>Transformed</em> <span class="math inline">\({\tt ALAE}\)</span> in Figure <a href="ChapDependenceModel.html#fig:Hist">16.3</a>. This plot appears reasonably close to what we expect to see with a uniform distribution, suggesting that the Pareto distribution is a reasonable specification.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Hist"></span>
<img src="LossDataAnalytics_files/figure-html/Hist-1.png" alt="Histogram of Transformed ALAE" width="60%" />
<p class="caption">
Figure 16.3: <strong>Histogram of Transformed ALAE</strong>
</p>
</div>
<p>In the same way, the variable <span class="math inline">\({\tt LOSS}\)</span> is also transformed to the variable <span class="math inline">\(u_2\)</span>, which follows a uniform distribution on <span class="math inline">\([0,1]\)</span>. The left-hand panel of Figure <a href="ChapDependenceModel.html#fig:Hist2">16.4</a> shows a plot the histogram of <em>Transformed</em> <span class="math inline">\({\tt ALAE}\)</span>, again reinforcing the Pareto distribution specification.
For another way of looking at the data, the variable <span class="math inline">\(u_2\)</span> can be transformed to a <em>normal score</em> with the quantile function of standard normal distribution. As we see in Figure <a href="ChapDependenceModel.html#fig:Hist2">16.4</a>, normal scores of the variable <span class="math inline">\({\tt LOSS}\)</span> are approximately marginally standard normal. This figure is helpful because analysts are used to looking for patterns of approximate normality (which seems to be evident in the figure). The logic is that, if the Pareto distribution is correctly specified, then transformed losses <span class="math inline">\(u_2\)</span> should be approximately normal, and the normal scores <span class="math inline">\(\Phi^{-1}(u_2)\)</span>, should be approximately normal. (Here, <span class="math inline">\(\Phi\)</span> is the cumulative standard normal distribution function.)</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Hist2"></span>
<img src="LossDataAnalytics_files/figure-html/Hist2-1.png" alt="Histogram of Transformed Loss. The left-hand panel shows the distribution of probability integral transformed losses. The right-hand panel shows the distribution for the corresponding normal scores." width="80%" />
<p class="caption">
Figure 16.4: <strong>Histogram of Transformed Loss.</strong> The left-hand panel shows the distribution of probability integral transformed losses. The right-hand panel shows the distribution for the corresponding normal scores.
</p>
</div>
<h5 style="text-align: center;">
<a id="displayCode.transalae.1" href="javascript:togglecode('toggleCode.transalae.1','displayCode.transalae.1');"><i><strong>R Code for Histograms of Transformed Variables</strong></i></a>
</h5>
<div id="toggleCode.transalae.1" style="display: none">
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="ChapDependenceModel.html#cb256-1" aria-hidden="true" tabindex="-1"></a>theta.LOSS <span class="ot">=</span> <span class="fu">Coef</span>(fit.LOSS)[<span class="dv">1</span>]</span>
<span id="cb256-2"><a href="ChapDependenceModel.html#cb256-2" aria-hidden="true" tabindex="-1"></a>alpha.LOSS <span class="ot">=</span> <span class="fu">Coef</span>(fit.LOSS)[<span class="dv">2</span>]</span>
<span id="cb256-3"><a href="ChapDependenceModel.html#cb256-3" aria-hidden="true" tabindex="-1"></a>u2 <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">+</span> (LOSS<span class="sc">/</span>theta.LOSS))<span class="sc">^</span>(<span class="sc">-</span>alpha.LOSS)</span>
<span id="cb256-4"><a href="ChapDependenceModel.html#cb256-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb256-5"><a href="ChapDependenceModel.html#cb256-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(u2, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb256-6"><a href="ChapDependenceModel.html#cb256-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">qnorm</span>(u2), <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="joint-modeling-with-copula-function" class="section level3 hasAnchor" number="16.4.4">
<h3><span class="header-section-number">16.4.4</span> Joint Modeling with Copula Function<a href="ChapDependenceModel.html#joint-modeling-with-copula-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Before jointly modeling losses and expenses, we draw the scatterplot of transformed variables <span class="math inline">\((u_1, u_2)\)</span> and the scatterplot of normal scores in Figure <a href="ChapDependenceModel.html#fig:Scatter2">16.5</a>. The left-hand panel is a plot of <span class="math inline">\(u_1\)</span> versus <span class="math inline">\(u_2\)</span>, where <span class="math inline">\(u_1 = \hat{F}_1(ALAE)\)</span> and <span class="math inline">\(u_2=\hat{F}_2(LOSS)\)</span>). Then we transform each one using an inverse standard normal distribution function, <span class="math inline">\(\Phi^{-1}(\cdot)\)</span>, or <code>qnorm</code> in <code>R</code> to get normal scores. As in Figure <a href="ChapDependenceModel.html#fig:Scatter">16.2</a>, it is difficult to see patterns in the left-hand panel. However, with rescaling, patterns are evident in the right-hand panel. To learn more details about normal scores and their applications in copula modeling, see <span class="citation"><a href="#ref-joe2014dependence" role="doc-biblioref">Joe</a> (<a href="#ref-joe2014dependence" role="doc-biblioref">2014</a>)</span>.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Scatter2"></span>
<img src="LossDataAnalytics_files/figure-html/Scatter2-1.png" alt="Left: Scatter plot for transformed variables. Right:Scatter plot for normal scores" width="80%" />
<p class="caption">
Figure 16.5: Left: Scatter plot for transformed variables. Right:Scatter plot for normal scores
</p>
</div>
<h5 style="text-align: center;">
<a id="displayCode.Cor.1" href="javascript:togglecode('toggleCode.Cor.1','displayCode.Cor.1');"><i><strong>R Code for Scatter Plots and Correlation</strong></i></a>
</h5>
<div id="toggleCode.Cor.1" style="display: none">
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="ChapDependenceModel.html#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb257-2"><a href="ChapDependenceModel.html#cb257-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(u1, u2, <span class="at">cex =</span> <span class="fl">0.5</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>), <span class="at">xlab =</span> <span class="st">&quot;Transformed ALAE&quot;</span>,</span>
<span id="cb257-3"><a href="ChapDependenceModel.html#cb257-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Transformed LOSS&quot;</span>)</span>
<span id="cb257-4"><a href="ChapDependenceModel.html#cb257-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">qnorm</span>(u1), <span class="fu">qnorm</span>(u2), <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="fu">qnorm</span>(u[<span class="dv">1</span>])), <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">qnorm</span>(u[<span class="dv">2</span>])))</span></code></pre></div>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="ChapDependenceModel.html#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(u1, u2, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb258-2"><a href="ChapDependenceModel.html#cb258-2" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span> </span>
<span id="cb258-3"><a href="ChapDependenceModel.html#cb258-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-4"><a href="ChapDependenceModel.html#cb258-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.451872</span></span></code></pre></div>
</div>
<p>The right-hand panel of Figure <a href="ChapDependenceModel.html#fig:Scatter">16.2</a> shows us there is a positive dependency between these two random variables. This can be summarized using, for example, Spearman’s rho that turns out to be 0.451. As we learned in Section <a href="ChapDependenceModel.html#Sec:Spearman">16.2.2.1</a>, this statistics depends only on the order of the two variables through their respective ranks. Therefore, the statistic is the same for (1) the original data in Figure <a href="ChapDependenceModel.html#fig:Scatter">16.2</a>, (2) the data transformed to uniform scales in the left-hand panel of Figure <a href="ChapDependenceModel.html#fig:Scatter2">16.5</a>, and (3) the normal scores in the right-hand panel of Figure <a href="ChapDependenceModel.html#fig:Scatter2">16.5</a>.</p>
<p>The next step is to calculate estimates of the copula parameters. One option is to use traditional maximum likelihood and determine all the parameters at the same time which can be computationally burdensome. Even in our simple example, this means maximizing a (log) likelihood function over five parameters, two for the marginal <span class="math inline">\({\tt ALAE}\)</span> distribution, two for the marginal <span class="math inline">\({\tt LOSS}\)</span> distribution, and one for the copula. A widely alternative, known as the <em>inference for margins (IFM)</em> approach, is to simply use the fitted marginal distributions, <span class="math inline">\(u_1\)</span> and <span class="math inline">\(u_2\)</span>, as inputs when determining the copula. This is the approach taken here. In the following code, you will see that it turns how that the fitted copula parameter <span class="math inline">\(\hat{\gamma} = 3.114\)</span>.</p>
<h5 style="text-align: center;">
<a id="displayCode.FrankCopula.1" href="javascript:togglecode('toggleCode.FrankCopula.1','displayCode.FrankCopula.1');"><i><strong>R Code for IFM Fitting with Frank’s Copula</strong></i></a>
</h5>
<div id="toggleCode.FrankCopula.1" style="display: none">
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="ChapDependenceModel.html#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="co"># transformed data matrix uu</span></span>
<span id="cb259-2"><a href="ChapDependenceModel.html#cb259-2" aria-hidden="true" tabindex="-1"></a>uu <span class="ot">=</span> <span class="fu">cbind</span>(u1,u2) </span>
<span id="cb259-3"><a href="ChapDependenceModel.html#cb259-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Frank&#39;s copula object with arbitrary parameter value</span></span>
<span id="cb259-4"><a href="ChapDependenceModel.html#cb259-4" aria-hidden="true" tabindex="-1"></a>frank.cop <span class="ot">&lt;-</span> <span class="fu">archmCopula</span>(<span class="st">&quot;frank&quot;</span>, <span class="at">param=</span> <span class="fu">c</span>(<span class="dv">5</span>), <span class="at">dim =</span> <span class="dv">2</span>) </span>
<span id="cb259-5"><a href="ChapDependenceModel.html#cb259-5" aria-hidden="true" tabindex="-1"></a><span class="co"># fit copula using ML method, starting value 0.4</span></span>
<span id="cb259-6"><a href="ChapDependenceModel.html#cb259-6" aria-hidden="true" tabindex="-1"></a>fit.ml <span class="ot">&lt;-</span> <span class="fu">fitCopula</span>(frank.cop, uu, <span class="at">method=</span><span class="st">&quot;ml&quot;</span>, <span class="at">start=</span><span class="fu">c</span>(<span class="fl">0.4</span>))</span>
<span id="cb259-7"><a href="ChapDependenceModel.html#cb259-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb259-8"><a href="ChapDependenceModel.html#cb259-8" aria-hidden="true" tabindex="-1"></a>Call<span class="sc">:</span> <span class="fu">fitCopula</span>(copula, <span class="at">data =</span> data, <span class="at">method =</span> <span class="st">&quot;ml&quot;</span>, <span class="at">start =</span> ..<span class="dv">2</span>)</span>
<span id="cb259-9"><a href="ChapDependenceModel.html#cb259-9" aria-hidden="true" tabindex="-1"></a>Fit based on <span class="st">&quot;maximum likelihood&quot;</span> and <span class="dv">1500</span> <span class="dv">2</span><span class="sc">-</span>dimensional observations.</span>
<span id="cb259-10"><a href="ChapDependenceModel.html#cb259-10" aria-hidden="true" tabindex="-1"></a>Frank copula, dim. d <span class="ot">=</span> <span class="dv">2</span> </span>
<span id="cb259-11"><a href="ChapDependenceModel.html#cb259-11" aria-hidden="true" tabindex="-1"></a>      Estimate Std. Error</span>
<span id="cb259-12"><a href="ChapDependenceModel.html#cb259-12" aria-hidden="true" tabindex="-1"></a>alpha    <span class="fl">3.114</span>      <span class="fl">0.169</span></span>
<span id="cb259-13"><a href="ChapDependenceModel.html#cb259-13" aria-hidden="true" tabindex="-1"></a>The maximized loglikelihood is <span class="fl">172.6</span> </span></code></pre></div>
</div>
<p>To visualize the fitted Frank’s copula, the distribution function and density function perspective plots are drawn in Figure <a href="ChapDependenceModel.html#fig:FrankCop">16.6</a>.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:FrankCop"></span>
<img src="LossDataAnalytics_files/figure-html/FrankCop-1.png" alt="Left: Plot for distribution function for Franks Copula. Right:Plot for density function for Franks Copula" width="672" />
<p class="caption">
Figure 16.6: Left: Plot for distribution function for Franks Copula. Right:Plot for density function for Franks Copula
</p>
</div>
<h5 style="text-align: center;">
<a id="displayCode.DistriPlot.1" href="javascript:togglecode('toggleCode.DistriPlot.1','displayCode.DistriPlot.1');"><i><strong>R Code for Frank’s Copula Plots</strong></i></a>
</h5>
<div id="toggleCode.DistriPlot.1" style="display: none">
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="ChapDependenceModel.html#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="co"># par(mfrow=c(1,2))</span></span>
<span id="cb260-2"><a href="ChapDependenceModel.html#cb260-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">3.2</span>, <span class="dv">3</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>), <span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb260-3"><a href="ChapDependenceModel.html#cb260-3" aria-hidden="true" tabindex="-1"></a><span class="fu">persp</span>(frank.cop, pCopula, <span class="at">theta =</span> <span class="dv">50</span>, <span class="at">zlab =</span> <span class="st">&quot;C(u,v)&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;u&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;v&quot;</span>, <span class="at">cex.lab =</span> <span class="fl">0.9</span>,</span>
<span id="cb260-4"><a href="ChapDependenceModel.html#cb260-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.axis =</span> <span class="fl">0.5</span>)</span>
<span id="cb260-5"><a href="ChapDependenceModel.html#cb260-5" aria-hidden="true" tabindex="-1"></a><span class="fu">persp</span>(frank.cop, dCopula, <span class="at">theta =</span> <span class="dv">0</span>, <span class="at">zlab =</span> <span class="st">&quot;c(u,v)&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;u&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;v&quot;</span>, <span class="at">cex.lab =</span> <span class="fl">0.9</span>,</span>
<span id="cb260-6"><a href="ChapDependenceModel.html#cb260-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.axis =</span> <span class="fl">0.5</span>)</span></code></pre></div>
</div>
</div>
</div>
<div id="S:CopTyp" class="section level2 hasAnchor" number="16.5">
<h2><span class="header-section-number">16.5</span> Types of Copulas<a href="ChapDependenceModel.html#S:CopTyp" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<hr />
<p>In this section, you learn how to:</p>
<ul>
<li>Define the basic types of copulas, including the normal, <span class="math inline">\(t\)</span>-, elliptical, and Archimedean copulas</li>
<li>Interpret bounds that limit copula distribution functions as the amount of dependence varies</li>
<li>Calculate measures of association for different copulas and interpret their properties</li>
<li>Interpret tail dependency for different copulas</li>
</ul>
<hr />
<p>There are several families of copulas have been described in the literature. Two main families of the copula families are the <strong>Archimedean</strong> and <strong>Elliptical</strong> copulas.</p>
<div id="normal-gaussian-copulas" class="section level3 hasAnchor" number="16.5.1">
<h3><span class="header-section-number">16.5.1</span> Normal (Gaussian) Copulas<a href="ChapDependenceModel.html#normal-gaussian-copulas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We started our study with Frank’s copula in equation <a href="ChapDependenceModel.html#eq:FrankCopula">(16.2)</a> because it can capture both positive and negative dependence and has a readily understood analytic form. However, extensions to multivariate cases where <span class="math inline">\(p&gt;2\)</span> are not easy and so we look to alternatives. In particular, the normal, or Gaussian, distribution has been used for many years in empirical work, starting with Gauss in 1887. So, it is natural to turn to this distribution as a benchmark for understanding multivariate dependencies.</p>
<p>For a multivariate normal distribution, think of <span class="math inline">\(p\)</span> normal random variables, each with mean zero and standard deviation one. Their dependence is controlled by <span class="math inline">\(\boldsymbol \Sigma\)</span>, a <a href="#" class="tooltip" style="color:green"><em>correlation matrix</em><span style="font-size:8pt">A table showing correlation coefficients between variables</span></a>, with ones on the diagonal. The number in the <span class="math inline">\(i\)</span>th row and <span class="math inline">\(j\)</span>th column, say <span class="math inline">\(\boldsymbol \Sigma_{ij}\)</span>, gives the correlation between the <span class="math inline">\(i\)</span>th and <span class="math inline">\(j\)</span>th normal random variables. This collection of random variables has a multivariate normal distribution with probability density function</p>
<p><span class="math display" id="eq:Normalpdf">\[\begin{equation}
\phi_N (\mathbf{z})= \frac{1}{(2 \pi)^{p/2}\sqrt{\det \boldsymbol \Sigma}}
\exp\left( -\frac{1}{2} \mathbf{z}^{\prime} \boldsymbol
\Sigma^{-1}\mathbf{z}\right).
\tag{16.3}
\end{equation}\]</span></p>
<p>To develop the corresponding copula version, it is possible to start with equation <a href="ChapDependenceModel.html#eq:DFDefined">(16.1)</a>, evaluate this using normal variables, and go through a bit of calculus. Instead, we simply state as a definition, the normal (Gaussian) <strong>copula</strong> density function is</p>
<p><span class="math display">\[
c_N(u_1,  \ldots, u_p) = \phi_N \left(\Phi^{-1}(u_1), \ldots, \Phi^{-1}(u_p) \right) \prod_{j=1}^p \frac{1}{\phi(\Phi^{-1}(u_j))}.
\]</span></p>
<p>Here, we use <span class="math inline">\(\Phi\)</span> and <span class="math inline">\(\phi\)</span> to denote the standard normal distribution and density functions. Unlike the usual probability density function <span class="math inline">\(\phi_N\)</span>, the copula density function has its domain on the hyper-cube <span class="math inline">\([0,1]^p\)</span>. For contrast, Figure <a href="ChapDependenceModel.html#fig:NormalPDFCopula">16.7</a> compares these two density functions.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:NormalPDFCopula"></span>
<img src="LossDataAnalytics_files/figure-html/NormalPDFCopula-1.png" alt="Bivariate Normal Probability Density Function Plots. The left-hand panel is a traditional bivariate normal probability density function. The right-hand plot is a plot of the copula density for the normal distribution." width="100%" />
<p class="caption">
Figure 16.7: <strong>Bivariate Normal Probability Density Function Plots.</strong> The left-hand panel is a traditional bivariate normal probability density function. The right-hand plot is a plot of the copula density for the normal distribution.
</p>
</div>
<h5 style="text-align: center;">
<a id="displayCode.DistriPlot.2" href="javascript:togglecode('toggleCode.DistriPlot.2','displayCode.DistriPlot.2');"><i><strong>R Code for Normal pdf and Normal Copula pdf Plots</strong></i></a>
</h5>
<div id="toggleCode.DistriPlot.2" style="display: none">
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="ChapDependenceModel.html#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb261-2"><a href="ChapDependenceModel.html#cb261-2" aria-hidden="true" tabindex="-1"></a><span class="co"># BIVARIATE NORMAL DF WITH RHO = 0.25</span></span>
<span id="cb261-3"><a href="ChapDependenceModel.html#cb261-3" aria-hidden="true" tabindex="-1"></a>norm.pdf <span class="ot">&lt;-</span> <span class="fu">mvdc</span>(<span class="fu">normalCopula</span>(<span class="fl">0.25</span>), <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;norm&quot;</span>), <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb261-4"><a href="ChapDependenceModel.html#cb261-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)))</span>
<span id="cb261-5"><a href="ChapDependenceModel.html#cb261-5" aria-hidden="true" tabindex="-1"></a><span class="fu">persp</span>(norm.pdf, dMvdc, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>), <span class="at">zlab =</span> <span class="fu">expression</span>(<span class="st">&quot;Φ&quot;</span>),</span>
<span id="cb261-6"><a href="ChapDependenceModel.html#cb261-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span>, <span class="at">cex.lab =</span> <span class="fl">0.8</span>, <span class="at">cex.axis =</span> <span class="fl">0.3</span>)</span>
<span id="cb261-7"><a href="ChapDependenceModel.html#cb261-7" aria-hidden="true" tabindex="-1"></a><span class="co"># BIVARIATE NORMAL COPULA WITH RHO = 0.25</span></span>
<span id="cb261-8"><a href="ChapDependenceModel.html#cb261-8" aria-hidden="true" tabindex="-1"></a>norm.cop <span class="ot">&lt;-</span> <span class="fu">ellipCopula</span>(<span class="st">&quot;normal&quot;</span>, <span class="at">param =</span> <span class="fu">c</span>(<span class="fl">0.25</span>), <span class="at">dim =</span> <span class="dv">2</span>, <span class="at">dispstr =</span> <span class="st">&quot;un&quot;</span>)</span>
<span id="cb261-9"><a href="ChapDependenceModel.html#cb261-9" aria-hidden="true" tabindex="-1"></a><span class="fu">persp</span>(norm.cop, dCopula, <span class="at">theta =</span> <span class="dv">30</span>, <span class="at">zlab =</span> <span class="st">&quot;c(u,v)&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;u&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;v&quot;</span>, <span class="at">cex.lab =</span> <span class="fl">0.8</span>,</span>
<span id="cb261-10"><a href="ChapDependenceModel.html#cb261-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">cex.axis =</span> <span class="fl">0.3</span>)</span></code></pre></div>
</div>
</div>
<div id="t--and-elliptical-copulas" class="section level3 hasAnchor" number="16.5.2">
<h3><span class="header-section-number">16.5.2</span> <em>t</em>- and Elliptical Copulas<a href="ChapDependenceModel.html#t--and-elliptical-copulas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Another copula used widely in practice is the <span class="math inline">\(t\)</span>- copula. Both the <span class="math inline">\(t\)</span>- and the normal copula are special cases of a family known as <em>elliptical</em> copulas, so we introduce this general family first, then specialize to the case of the <span class="math inline">\(t\)</span>- copula.</p>
<p>The normal and the <span class="math inline">\(t\)</span>- distributions are examples of symmetric distributions. More generally, <a href="#" class="tooltip" style="color:green"><em>elliptical distributions</em><span style="font-size:8pt">Any member of a broad family of probability distributions that generalize the multivariate normal distribution</span></a> is a class of distributions that are symmetric and can be multivariate. In short, an elliptical distribution is a type of symmetric, multivariate distribution. The multivariate normal and multivariate <span class="math inline">\(t\)</span>- are special types of elliptical distributions.</p>
<p><a href="#" class="tooltip" style="color:green"><em>Elliptical copulas</em><span style="font-size:8pt">The copulas of elliptical distributions</span></a> are constructed from elliptical distributions. This copula decomposes a (multivariate) elliptical distribution into their univariate elliptical marginal distributions by Sklar’s theorem. Properties of elliptical copulas can be obtained from the properties of the corresponding elliptical distributions, see for example, <span class="citation"><a href="#ref-hofertelements" role="doc-biblioref">Hofert et al.</a> (<a href="#ref-hofertelements" role="doc-biblioref">2018</a>)</span>.</p>
<p>In general, a <span class="math inline">\(p\)</span>-dimensional vector of random variables has an <em>elliptical distribution</em> if the density can be written as</p>
<p><span class="math display">\[
h_E (\mathbf{z})= \frac{k_p}{\sqrt{\det \boldsymbol \Sigma}}
g_p \left( \frac{1}{2} (\mathbf{z}- \boldsymbol \mu)^{\prime}
\boldsymbol \Sigma^{-1}(\mathbf{z}- \boldsymbol \mu) \right) ,
\]</span></p>
<p>for <span class="math inline">\(\mathbf{z} \in R^p\)</span> and <span class="math inline">\(k_p\)</span> is a constant, determined so the density integrates to one. The function <span class="math inline">\(g_p(\cdot)\)</span> is called a <em>generator</em> because it can be used to produce different distributions. <a href="#tab:15.7">Table 15.7</a> summarizes a few choices used in actuarial practice. The choice <span class="math inline">\(g_p(x) = \exp(-x)\)</span> gives rises to the normal <em>pdf</em> in equation <a href="ChapDependenceModel.html#eq:Normalpdf">(16.3)</a>. The choice <span class="math inline">\(g_p(x) = \exp(-(1+2x/r)^{-(p+r)/2})\)</span> gives rise to a multivariate <span class="math inline">\(t\)</span>- distribution with <span class="math inline">\(r\)</span> degrees of freedom with <em>pdf</em></p>
<p><span class="math display">\[
h_{t_r} (\mathbf{z})= \frac{k_p}{\sqrt{\det \boldsymbol \Sigma}}
\exp\left[- \left( 1+ \frac{(\mathbf{z}- \boldsymbol \mu)^{\prime} \boldsymbol \Sigma^{-1}(\mathbf{z}- \boldsymbol \mu)}{r} \right)^{-(p+r)/2}\right] .
\]</span></p>
<p><a id=tab:15.7></a></p>
<p>Table 15.7. <strong>Generator Functions (<span class="math inline">\(g_p(\cdot)\)</span>) for Selected Elliptical Distributions</strong></p>
<p><span class="math display">\[
\small\begin{array}{lc}
\hline &amp; Generator \\
 Distribution &amp;  g_p(x)  \\
\hline
 \text{Normal distribution} &amp;  e^{-x}\\
 t-\text{distribution with }r \text{ degrees of freedom} &amp;   (1+2x/r)^{-(p+r)/2}\\
 \text{Cauchy} &amp;  (1+2x)^{-(p+1)/2}\\
\text{Logistic} &amp;  e^{-x}/(1+e^{-x})^2\\
 \text{Exponential power} &amp;   \exp(-rx^s)\\
\hline
\end{array}
\]</span></p>
<p>We can use elliptical distributions to generate copulas. Because copulas are concerned primarily with relationships, we may restrict our considerations to the case where <span class="math inline">\(\mu = \mathbf{0}\)</span> and <span class="math inline">\(\boldsymbol \Sigma\)</span> is a correlation matrix. With these restrictions, the marginal distributions of the multivariate elliptical copula are identical; we use <span class="math inline">\(H\)</span> to refer to this marginal distribution function and <span class="math inline">\(h\)</span> is the corresponding density. This marginal density is <span class="math inline">\(h(z) = k_1 g_1(z^2/2).\)</span> For example, in the normal case we have <span class="math inline">\(H(\cdot)=\Phi(\cdot)\)</span> and <span class="math inline">\(h(\cdot)=\phi(\cdot)\)</span>.</p>
<p>We are now ready to define the <em>pdf</em> of the <em>elliptical copula</em>, a function defined on the unit cube <span class="math inline">\([0,1]^p\)</span> as</p>
<p><span class="math display">\[
{c}_E(u_1,  \ldots, u_p) = h_E \left(H^{-1}(u_1), \ldots,
H^{-1}(u_p) \right) \prod_{j=1}^p \frac{1}{h(H^{-1}(u_j))}.
\]</span></p>
<p>As noted above, most empirical work focuses on the normal copula and <span class="math inline">\(t\)</span>-copula. Specifically, <span class="math inline">\(t\)</span>-copulas are useful for modeling the dependency in the tails of bivariate distributions, especially in financial risk analysis applications. The <span class="math inline">\(t\)</span>-copulas with same association parameter in varying the degrees of freedom parameter show us different tail dependency structures. For more information on about <span class="math inline">\(t\)</span>-copulas readers can see <span class="citation"><a href="#ref-joe2014dependence" role="doc-biblioref">Joe</a> (<a href="#ref-joe2014dependence" role="doc-biblioref">2014</a>)</span> and <span class="citation"><a href="#ref-hofertelements" role="doc-biblioref">Hofert et al.</a> (<a href="#ref-hofertelements" role="doc-biblioref">2018</a>)</span>.</p>
</div>
<div id="archimedean-copulas" class="section level3 hasAnchor" number="16.5.3">
<h3><span class="header-section-number">16.5.3</span> Archimedean Copulas<a href="ChapDependenceModel.html#archimedean-copulas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This class of copulas is also constructed from a <em>generator</em> function. For Archimedean copulas, we assume that <span class="math inline">\(g(\cdot)\)</span> is a convex, decreasing function with domain [0,1] and range <span class="math inline">\([0, \infty)\)</span> such that <span class="math inline">\(g(0)=0\)</span>. Use <span class="math inline">\(g^{-1}\)</span> for the inverse function of <span class="math inline">\(g\)</span>. Then the function</p>
<p><span class="math display">\[
C_g(u_1, \ldots, u_p) = g^{-1} \left(g(u_1)+ \cdots + g(u_p) \right)
\]</span></p>
<p>is said to be an <em>Archimedean</em> copula distribution function.</p>
<p>For the bivariate case, <span class="math inline">\(p=2\)</span>, an Archimedean copula function can be written by the function</p>
<p><span class="math display">\[
C_{g}(u_1, \, u_2) = g^{-1} \left(g(u_1) + g(u_2) \right).
\]</span></p>
<p>Some important special cases of Archimedean copulas include the Frank, Clayton/Cook-Johnson, and Gumbel/Hougaard copulas. Each copula class is derived from different generator functions. As another useful special case, recall the Frank’s copula described in Sections <a href="ChapDependenceModel.html#S:Copula">16.3</a> and <a href="ChapDependenceModel.html#S:CopAppl">16.4</a>. To illustrate, we now provide explicit expressions for the Clayton and Gumbel/Hougaard copulas.</p>
<div id="clayton-copula" class="section level4 unnumbered hasAnchor">
<h4>Clayton Copula<a href="ChapDependenceModel.html#clayton-copula" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For <span class="math inline">\(p=2\)</span>, the Clayton copula is parameterized by <span class="math inline">\(\gamma \in [-1,\infty)\)</span> is defined by</p>
<p><span class="math display">\[
C_{\gamma}^C(u)=\max\{u_1^{-\gamma}+u_2^{-\gamma}-1,0\}^{1/\gamma}, \quad u \in [0,1]^2.
\]</span></p>
<p>This is a bivariate distribution function defined on the unit square <span class="math inline">\([0,1]^2.\)</span> The range of dependence is controlled by the parameter <span class="math inline">\(\gamma\)</span>, similar to Frank’s copula.</p>
</div>
<div id="gumbel-hougaard-copula" class="section level4 unnumbered hasAnchor">
<h4>Gumbel-Hougaard Copula<a href="ChapDependenceModel.html#gumbel-hougaard-copula" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The Gumbel-Hougaard copula is parametrized by <span class="math inline">\(\gamma \in [1,\infty)\)</span> and defined by</p>
<p><span class="math display">\[
C_{\gamma}^{GH}(u)=\exp\left(-\left(\sum_{i=1}^2 (-\log u_i)^{\gamma}\right)^{1/\gamma}\right), \quad u\in[0,1]^2.
\]</span></p>
<p>For more information on Archimedean copulas, see <span class="citation"><a href="#ref-joe2014dependence" role="doc-biblioref">Joe</a> (<a href="#ref-joe2014dependence" role="doc-biblioref">2014</a>)</span>, <span class="citation"><a href="#ref-frees1998understanding" role="doc-biblioref">Edward W. Frees and Valdez</a> (<a href="#ref-frees1998understanding" role="doc-biblioref">1998</a>)</span>, and <span class="citation"><a href="#ref-genest1986bivariate" role="doc-biblioref">Genest and Mackay</a> (<a href="#ref-genest1986bivariate" role="doc-biblioref">1986</a>)</span>.</p>
</div>
</div>
<div id="properties-of-copulas" class="section level3 hasAnchor" number="16.5.4">
<h3><span class="header-section-number">16.5.4</span> Properties of Copulas<a href="ChapDependenceModel.html#properties-of-copulas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With many choices of copulas available, it is helpful for analysts to understand general features of how these alternatives behave.</p>
<div id="S:Dep:Bounds" class="section level4 hasAnchor" number="16.5.4.1">
<h4><span class="header-section-number">16.5.4.1</span> Bounds on Association<a href="ChapDependenceModel.html#S:Dep:Bounds" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Any distribution function is bounded below by zero and from above by one. Additional types of bounds are available in multivariate contexts. These bounds are useful when studying dependencies. That is, as an analyst thinks about variables as being extremely dependent, one has available bounds that cannot be exceeded, regardless of the dependence. The most widely used bounds in dependence modeling are known as the <em>Fréchet-Höeffding</em> bounds, given as</p>
<p><span class="math display">\[
\max( u_1 +\cdots+ u_p + p -1, 0) \leq  C(u_1,  \ldots, u_p) \leq \min (u_1,  \ldots,u_p).
\]</span></p>
<p>To see the right-hand side of this equation, note that</p>
<p><span class="math display">\[
C(u_1,\ldots, u_p) = \Pr(U_1 \leq u_1, \ldots, U_p \leq u_p) \leq  \Pr(U_j \leq u_j),
\]</span></p>
<p>for <span class="math inline">\(j=1,\ldots,p\)</span>. The bound is achieved when <span class="math inline">\(U_1 = \cdots = U_p\)</span>. To see the left-hand side when <span class="math inline">\(p=2\)</span>, consider <span class="math inline">\(U_2=1-U_1\)</span>. In this case, if <span class="math inline">\(1-u_2 &lt; u_1\)</span> then
<span class="math display">\[
\Pr(U_1 \leq u_1, U_2 \leq u_2) = \Pr ( 1-u_2 \leq U_1 &lt; u_1) =u_1+u_2-1.
\]</span>
See, for example, <span class="citation"><a href="#ref-nelsen1997introduction" role="doc-biblioref">Nelson</a> (<a href="#ref-nelsen1997introduction" role="doc-biblioref">1997</a>)</span> for additional discussion.</p>
<p>To see how these bounds relate to the concept of dependence, consider the case of <span class="math inline">\(p=2\)</span>. As a benchmark, first note that the product copula is <span class="math inline">\(C(u_1,u_2)=u_1 \cdot u_2\)</span> is the result of assuming independence between random variables. Now, from the above discussion, we see that the lower bound is achieved when the two random variables are perfectly negatively related (<span class="math inline">\(U_2=1-U_1\)</span>). Further, it is clear that the upper bound is achieved when they are perfectly positively related (<span class="math inline">\(U_2=U_1\)</span>). To emphasize this, the <a href="#" class="tooltip" style="color:green"><em>Frechet-Hoeffding bounds</em><span style="font-size:8pt">Bounds of multivariate distribution functions</span></a> for two random variables appear in Figure <a href="ChapDependenceModel.html#fig:Bounds">16.8</a>.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:Bounds"></span>
<img src="LossDataAnalytics_files/figure-html/Bounds-1.png" alt="Perfect Positive and Perfect Negative Dependence Plots" width="60%" />
<p class="caption">
Figure 16.8: <strong>Perfect Positive and Perfect Negative Dependence Plots</strong>
</p>
</div>
<h5 style="text-align: center;">
<a id="displayCode.plot.1" href="javascript:togglecode('toggleCode.plot.1','displayCode.plot.1');"><i><strong>R Code for the Fréchet-Höeffding Bounds for Two Random Variables</strong></i></a>
</h5>
<div id="toggleCode.plot.1" style="display: none">
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="ChapDependenceModel.html#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1980</span>)</span>
<span id="cb262-2"><a href="ChapDependenceModel.html#cb262-2" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">100</span>)</span>
<span id="cb262-3"><a href="ChapDependenceModel.html#cb262-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb262-4"><a href="ChapDependenceModel.html#cb262-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cbind</span>(U, <span class="dv">1</span> <span class="sc">-</span> U), <span class="at">xlab =</span> <span class="fu">quote</span>(U[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">quote</span>(U[<span class="dv">2</span>]), <span class="at">main =</span> <span class="st">&quot;Perfect Negative Dependency&quot;</span>)  <span class="co"># W for p=2</span></span>
<span id="cb262-5"><a href="ChapDependenceModel.html#cb262-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cbind</span>(U, U), <span class="at">xlab =</span> <span class="fu">quote</span>(U[<span class="dv">1</span>]), <span class="at">ylab =</span> <span class="fu">quote</span>(U[<span class="dv">2</span>]), <span class="at">main =</span> <span class="st">&quot;Perfect Positive Dependency&quot;</span>)  <span class="co">#M for p=2</span></span></code></pre></div>
</div>
</div>
<div id="Sec:MeasuresAssociation" class="section level4 hasAnchor" number="16.5.4.2">
<h4><span class="header-section-number">16.5.4.2</span> Measures of Association<a href="ChapDependenceModel.html#Sec:MeasuresAssociation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Empirical versions of Spearman’s rho and Kendall’s tau were introduced in Sections <a href="ChapDependenceModel.html#Sec:Spearman">16.2.2.1</a> and <a href="ChapDependenceModel.html#Sec:Kendall">16.2.2.2</a>, respectively. The interesting thing about these expressions is that these summary measures of association are based <strong>only</strong> on the ranks of each variable. Thus, any strictly increasing transform does not affect these measures of association. Specifically, consider two random variables, <span class="math inline">\(Y_1\)</span> and <span class="math inline">\(Y_2\)</span>, and let m<span class="math inline">\(_1\)</span> and m<span class="math inline">\(_2\)</span> be strictly increasing functions. Then, the association, when measured by Spearman’s rho or Kendall’s tau, between <span class="math inline">\(m_1(Y_1)\)</span> and <span class="math inline">\(m_2(Y_2)\)</span> does not change regardless of the choice of m<span class="math inline">\(_1\)</span> and m<span class="math inline">\(_2\)</span>. For example, this allows analysts to consider dollars, Euros, or log dollars, and still retain the same essential dependence. As we have seen in Section <a href="ChapDependenceModel.html#S:Measures">16.2</a>, this is not the case with the Pearson’s measure of correlation.</p>
<p><span class="citation"><a href="#ref-schweizer1981nonparametric" role="doc-biblioref">Schweizer, Wolff, and others</a> (<a href="#ref-schweizer1981nonparametric" role="doc-biblioref">1981</a>)</span> established that the copula accounts for all the dependence in the sense that they way <span class="math inline">\(Y_1\)</span> and <span class="math inline">\(Y_2\)</span> “move together” is captured by the copula, regardless of the scale in which each variable is measured. They also showed that (population versions of) the two standard nonparametric measures of association could be expressed solely in terms of the copula function. Spearman’s correlation coefficient is given by</p>
<p><span class="math display" id="eq:TheorySpearman">\[\begin{equation}
\rho_S = 12 \int_0^1 \int_0^1  \left\{C(u,v) - uv \right\} du dv.
\tag{16.4}
\end{equation}\]</span></p>
<p>Kendall’s tau is given by</p>
<p><span class="math display">\[
\tau= 4 \int_0^1  \int_0^1  C(u,v)~dC(u,v) - 1 .
\]</span></p>
<p>For these expressions, we assume that <span class="math inline">\(Y_1\)</span> and <span class="math inline">\(Y_2\)</span> have a jointly continuous distribution function.</p>
<p><strong>Example. Loss versus Expenses</strong>. Earlier, in Section <a href="ChapDependenceModel.html#S:CopAppl">16.4</a>, we saw that the Spearman’s correlation was 0.452, calculated with the <code>rho</code> function. Then, we fit Frank’s copula to these data, and estimated the dependence parameter to be <span class="math inline">\(\hat{\gamma} = 0.452\)</span>. As an alternative, the following code shows how to use the empirical version of equation <a href="ChapDependenceModel.html#eq:TheorySpearman">(16.4)</a>. In this case, the Spearman’s correlation coefficient is 0.462, which is close to the sample Spearman’s correlation coefficient, 0.452.</p>
<h5 style="text-align: center;">
<a id="displayCode.fittedCop.1" href="javascript:togglecode('toggleCode.fittedCop.1','displayCode.fittedCop.1');"><i><strong>R Code for Spearman’s Correlation Using Frank’s Copula</strong></i></a>
</h5>
<div id="toggleCode.fittedCop.1" style="display: none">
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="ChapDependenceModel.html#cb263-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">param =</span> fit.ml<span class="sc">@</span>estimate)</span>
<span id="cb263-2"><a href="ChapDependenceModel.html#cb263-2" aria-hidden="true" tabindex="-1"></a>frank.cop <span class="ot">&lt;-</span> <span class="fu">archmCopula</span>(<span class="st">&quot;frank&quot;</span>, <span class="at">param=</span> param, <span class="at">dim =</span> <span class="dv">2</span>)</span>
<span id="cb263-3"><a href="ChapDependenceModel.html#cb263-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rho</span>(frank.cop) </span>
<span id="cb263-4"><a href="ChapDependenceModel.html#cb263-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-5"><a href="ChapDependenceModel.html#cb263-5" aria-hidden="true" tabindex="-1"></a>Output <span class="sc">:</span> </span>
<span id="cb263-6"><a href="ChapDependenceModel.html#cb263-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.4622722</span></span></code></pre></div>
</div>
</div>
<div id="tail-dependency" class="section level4 hasAnchor" number="16.5.4.3">
<h4><span class="header-section-number">16.5.4.3</span> Tail Dependency<a href="ChapDependenceModel.html#tail-dependency" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>There are applications in which it is useful to distinguish the part of the distribution in which the association is strongest. For example, in insurance it is helpful to understand association among the largest losses, that is, association in the right tails of the data.</p>
<p>To capture this type of dependency, we use the <em>right-tail concentration</em> function, defined as</p>
<p><span class="math display">\[
R(z) = \frac{\Pr(U_1 &gt;z, U_2 &gt; z)}{1-z} =\Pr(U_1 &gt; z | U_2 &gt; z) =\frac{1 - 2z + C(z,z)}{1-z} .
\]</span></p>
<p>As a benchmark, <span class="math inline">\(R(z)\)</span> will be equal to <span class="math inline">\(z\)</span> under independence. Joe (1997) uses the term “upper tail dependence parameter” for <span class="math inline">\(R = \lim_{z \rightarrow 1} R(z)\)</span>.</p>
<p>In the same way, one can define the <em>left-tail concentration</em> function as</p>
<p><span class="math display">\[
L(z) = \frac{\Pr(U_1 \leq z, U_2 \leq z)}{z}=\Pr(U_1 \leq z | U_2 \leq z) =\frac{ C(z,z)}{z},
\]</span></p>
<p>with the lower tail dependence parameter <span class="math inline">\(L = \lim_{z \rightarrow 0} L(z)\)</span>. A <a href="#" class="tooltip" style="color:green"><em>tail dependency</em><span style="font-size:8pt">A measure of their comovements in the tails of the distributions</span></a> concentration function captures the probability of two random variables simultaneously having extreme values.</p>
<p>It is of interest to see how well a given copula can capture tail dependence. To this end, we calculate the left and right tail concentration functions for four different types of copulas; Normal, Frank, Gumbel and <span class="math inline">\(t\)</span>- copulas. The results are summarized for concentration function values for these four copulas in <a href="#tab:15.8">Table 15.8</a>. As in <span class="citation"><a href="#ref-venter2002tails" role="doc-biblioref">Gary G. Venter</a> (<a href="#ref-venter2002tails" role="doc-biblioref">2002</a>)</span>, we show <span class="math inline">\(L(z)\)</span> for <span class="math inline">\(z\leq 0.5\)</span> and <span class="math inline">\(R(z)\)</span> for <span class="math inline">\(z&gt;0.5\)</span> in the tail dependence plot in Figure <a href="ChapDependenceModel.html#fig:DepTails">16.9</a>. We interpret the tail dependence plot to mean that both the Frank and Normal copula exhibit no tail dependence whereas the <span class="math inline">\(t\)</span>- and the Gumbel do so. The <span class="math inline">\(t\)</span>- copula is symmetric in its treatment of upper and lower tails.</p>
<p><a id=tab:15.8></a></p>
<p>Table 15.8. <strong>Tail Dependence Parameters for Four Copulas</strong></p>
<p><span class="math display">\[
{\small \begin{matrix}
\begin{array}{l|rr} 
    \hline
\text{Copula} &amp; \text{Lower}    &amp; \text{Upper}     \\
\hline
\text{Frank}  &amp; 0  &amp; 0   \\
\text{Gumbel}  &amp; 0   &amp; 0.74    \\
\text{Normal}  &amp; 0   &amp; 0    \\
t-  &amp; 0.10   &amp; 0.10    \\
   \hline
\end{array}
\end{matrix}}
\]</span></p>
<h5 style="text-align: center;">
<a id="displayCode.Tail.1" href="javascript:togglecode('toggleCode.Tail.1','displayCode.Tail.1');"><i><strong>R Code for Tail Copula Functions for Different Copulas</strong></i></a>
</h5>
<div id="toggleCode.Tail.1" style="display: none">
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="ChapDependenceModel.html#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(copula)</span>
<span id="cb264-2"><a href="ChapDependenceModel.html#cb264-2" aria-hidden="true" tabindex="-1"></a>U1 <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="at">by =</span> <span class="fl">0.002</span>)</span>
<span id="cb264-3"><a href="ChapDependenceModel.html#cb264-3" aria-hidden="true" tabindex="-1"></a>U2 <span class="ot">=</span> <span class="fu">seq</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.002</span>)</span>
<span id="cb264-4"><a href="ChapDependenceModel.html#cb264-4" aria-hidden="true" tabindex="-1"></a>U <span class="ot">=</span> <span class="fu">rbind</span>(U1, U2)</span>
<span id="cb264-5"><a href="ChapDependenceModel.html#cb264-5" aria-hidden="true" tabindex="-1"></a>TailFunction <span class="ot">&lt;-</span> <span class="cf">function</span>(Tailcop) {</span>
<span id="cb264-6"><a href="ChapDependenceModel.html#cb264-6" aria-hidden="true" tabindex="-1"></a>    lowertail <span class="ot">&lt;-</span> <span class="fu">pCopula</span>(<span class="fu">cbind</span>(U1, U1), Tailcop)<span class="sc">/</span>U1</span>
<span id="cb264-7"><a href="ChapDependenceModel.html#cb264-7" aria-hidden="true" tabindex="-1"></a>    uppertail <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> U2 <span class="sc">+</span> <span class="fu">pCopula</span>(<span class="fu">cbind</span>(U2, U2), Tailcop))<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> U2)</span>
<span id="cb264-8"><a href="ChapDependenceModel.html#cb264-8" aria-hidden="true" tabindex="-1"></a>    jointtail <span class="ot">&lt;-</span> <span class="fu">rbind</span>(lowertail, uppertail)</span>
<span id="cb264-9"><a href="ChapDependenceModel.html#cb264-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb264-10"><a href="ChapDependenceModel.html#cb264-10" aria-hidden="true" tabindex="-1"></a>Tailcop1 <span class="ot">&lt;-</span> <span class="fu">archmCopula</span>(<span class="at">family =</span> <span class="st">&quot;frank&quot;</span>, <span class="at">param =</span> <span class="fu">c</span>(<span class="fl">0.05</span>), <span class="at">dim =</span> <span class="dv">2</span>)</span>
<span id="cb264-11"><a href="ChapDependenceModel.html#cb264-11" aria-hidden="true" tabindex="-1"></a>Tailcop2 <span class="ot">&lt;-</span> <span class="fu">archmCopula</span>(<span class="at">family =</span> <span class="st">&quot;gumbel&quot;</span>, <span class="at">param =</span> <span class="dv">3</span>)</span>
<span id="cb264-12"><a href="ChapDependenceModel.html#cb264-12" aria-hidden="true" tabindex="-1"></a>Tailcop3 <span class="ot">&lt;-</span> <span class="fu">ellipCopula</span>(<span class="st">&quot;normal&quot;</span>, <span class="at">param =</span> <span class="fu">c</span>(<span class="fl">0.25</span>), <span class="at">dim =</span> <span class="dv">2</span>, <span class="at">dispstr =</span> <span class="st">&quot;un&quot;</span>)</span>
<span id="cb264-13"><a href="ChapDependenceModel.html#cb264-13" aria-hidden="true" tabindex="-1"></a>Tailcop4 <span class="ot">&lt;-</span> <span class="fu">ellipCopula</span>(<span class="st">&quot;t&quot;</span>, <span class="at">param =</span> <span class="fu">c</span>(<span class="fl">0.25</span>), <span class="at">dim =</span> <span class="dv">2</span>, <span class="at">dispstr =</span> <span class="st">&quot;un&quot;</span>, <span class="at">df =</span> <span class="dv">5</span>)</span>
<span id="cb264-14"><a href="ChapDependenceModel.html#cb264-14" aria-hidden="true" tabindex="-1"></a>jointtail1 <span class="ot">&lt;-</span> <span class="fu">TailFunction</span>(Tailcop1)</span>
<span id="cb264-15"><a href="ChapDependenceModel.html#cb264-15" aria-hidden="true" tabindex="-1"></a>jointtail2 <span class="ot">&lt;-</span> <span class="fu">TailFunction</span>(Tailcop2)</span>
<span id="cb264-16"><a href="ChapDependenceModel.html#cb264-16" aria-hidden="true" tabindex="-1"></a>jointtail3 <span class="ot">&lt;-</span> <span class="fu">TailFunction</span>(Tailcop3)</span>
<span id="cb264-17"><a href="ChapDependenceModel.html#cb264-17" aria-hidden="true" tabindex="-1"></a>jointtail4 <span class="ot">&lt;-</span> <span class="fu">TailFunction</span>(Tailcop4)</span></code></pre></div>
</div>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:DepTails"></span>
<img src="LossDataAnalytics_files/figure-html/DepTails-1.png" alt="Tail Dependence Plots" width="80%" />
<p class="caption">
Figure 16.9: <strong>Tail Dependence Plots</strong>
</p>
</div>
<h5 style="text-align: center;">
<a id="displayCode.Tailplot.1" href="javascript:togglecode('toggleCode.Tailplot.1','displayCode.Tailplot.1');"><i><strong>R Code for Tail Dependence Plot for Different Copulas</strong></i></a>
</h5>
<div id="toggleCode.Tailplot.1" style="display: none">
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="ChapDependenceModel.html#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(U, jointtail1, <span class="at">cex =</span> <span class="fl">0.2</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ylab =</span> <span class="st">&quot;Tail Dependence&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,</span>
<span id="cb265-2"><a href="ChapDependenceModel.html#cb265-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>))</span>
<span id="cb265-3"><a href="ChapDependenceModel.html#cb265-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(U, jointtail2, <span class="at">type =</span> <span class="st">&quot;p&quot;</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.2</span>)</span>
<span id="cb265-4"><a href="ChapDependenceModel.html#cb265-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(U, jointtail3, <span class="at">type =</span> <span class="st">&quot;p&quot;</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.2</span>)</span>
<span id="cb265-5"><a href="ChapDependenceModel.html#cb265-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(U, jointtail4, <span class="at">type =</span> <span class="st">&quot;p&quot;</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">cex =</span> <span class="fl">0.2</span>)</span>
<span id="cb265-6"><a href="ChapDependenceModel.html#cb265-6" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.75</span>, <span class="fl">0.1</span>, <span class="st">&quot;Frank&quot;</span>, <span class="at">cex =</span> <span class="fl">1.3</span>)  <span class="co">#1</span></span>
<span id="cb265-7"><a href="ChapDependenceModel.html#cb265-7" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.1</span>, <span class="fl">0.8</span>, <span class="st">&quot;Gumbel&quot;</span>, <span class="at">cex =</span> <span class="fl">1.3</span>)  <span class="co">#2</span></span>
<span id="cb265-8"><a href="ChapDependenceModel.html#cb265-8" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.25</span>, <span class="fl">0.1</span>, <span class="st">&quot;normal&quot;</span>, <span class="at">cex =</span> <span class="fl">1.3</span>)  <span class="co">#3</span></span>
<span id="cb265-9"><a href="ChapDependenceModel.html#cb265-9" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="fl">0.17</span>, <span class="fl">0.1</span>, <span class="fl">0.07</span>, <span class="fl">0.12</span>, <span class="at">code =</span> <span class="dv">2</span>, <span class="at">angle =</span> <span class="dv">20</span>, <span class="at">length =</span> <span class="fl">0.1</span>)</span>
<span id="cb265-10"><a href="ChapDependenceModel.html#cb265-10" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.9</span>, <span class="fl">0.4</span>, <span class="st">&quot;t with 5 df&quot;</span>, <span class="at">cex =</span> <span class="fl">1.3</span>)  <span class="co">#4</span></span></code></pre></div>
</div>
<div id="surveyElement145">

</div>
<div id="surveyResult145">

</div>
<h5 style="text-align: center;">
<a id="display.Quiz145.1" href="javascript:toggleQuiz
('display.Quiz145.2','display.Quiz145.1');"><i><strong>Show Quiz Solution</strong></i></a>
</h5>
<div id="display.Quiz145.2" style="display: none">
<p id="Quiz145Soln">
</p>
<hr />
</div>
<script type="text/javascript" src="./Quizzes/QuizJavascript/Quiz145.js">
</script>
</div>
</div>
</div>
<div id="S:CopImp" class="section level2 hasAnchor" number="16.6">
<h2><span class="header-section-number">16.6</span> Why is Dependence Modeling Important?<a href="ChapDependenceModel.html#S:CopImp" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Dependence modeling is important because it enables us to understand the dependence structure by defining the relationship between variables in a dataset. In insurance, ignoring dependence modeling may not impact pricing but could lead to misestimation of required capital to cover losses. For instance, from Section <a href="ChapDependenceModel.html#S:CopAppl">16.4</a> , it is seen that there was a positive relationship between <span class="math inline">\({\tt LOSS}\)</span> and <span class="math inline">\({\tt ALAE}\)</span>. This means that, if there is a large loss then we expect expenses to be large as well and ignoring this relationship could lead to mis-estimation of reserves.</p>
<p>To illustrate the importance of dependence modeling, we refer you back to portfolio management example in Section <a href="ChapPortMgt.html#S:PortMgtExample">13.4.3.3</a> that assumed that the property and liability risks are independent. Now, we incorporate dependence by allowing the four lines of business to depend on one another through a Gaussian copula. In <a href="#tab:15.9">Table 15.9</a>, we show that dependence affects the portfolio quantiles (<span class="math inline">\(VaR_q\)</span>), although not the expected values. For instance, the <span class="math inline">\(VaR_{0.99}\)</span> for total risk which is the amount of capital required to ensure, with a <span class="math inline">\(99\%\)</span> degree of certainty that the firm does not become technically insolvent is higher when we incorporate dependence. This leads to less capital being allocated when dependence is ignored and can cause unexpected solvency problems.</p>
<p><a id=tab:15.9></a></p>
<p>Table 15.9. <strong>Results for Portfolio Expected Value and Quantiles (<span class="math inline">\(VaR_q\)</span>)</strong></p>
<p><span class="math display">\[
{\small \begin{matrix}
\begin{array}{l|rrrr} 
    \hline
 \text{Independent} &amp;\text{Expected}   &amp; VaR_{0.9}  &amp; VaR_{0.95}  &amp; VaR_{0.99}  \\
                   &amp;\text{Value}      &amp;            &amp;             &amp;             \\
     \hline              
\text{Retained}    &amp; 269              &amp;  300       &amp; 300         &amp; 300         \\
\text{Insurer}     &amp; 2,274            &amp;  4,400     &amp; 6,173       &amp; 11,859      \\
\text{Total}       &amp; 2,543            &amp;  4,675     &amp; 6,464       &amp; 12,159      \\
   \hline
\text{Gaussian Copula}&amp;\text{Expected}&amp; VaR_{0.9}  &amp; VaR_{0.95}  &amp; VaR_{0.99}  \\
                      &amp;\text{Value}    &amp;           &amp;             &amp;              \\
     \hline                      
\text{Retained}       &amp; 269            &amp;  300      &amp; 300         &amp;  300         \\
\text{Insurer}        &amp; 2,340          &amp;  4,988    &amp; 7,339       &amp; 14,905       \\
\text{Total}          &amp; 2,609          &amp;  5,288    &amp; 7,639       &amp; 15,205       \\
   \hline
\end{array}
\end{matrix}}
\]</span></p>
<h5 style="text-align: center;">
<a id="displayCode.SimG.1" href="javascript:togglecode('toggleCode.SimG.1','displayCode.SimG.1');"><i><strong>R Code for Simulation Using Gaussian Copula</strong></i></a>
</h5>
<div id="toggleCode.SimG.1" style="display: none">
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="ChapDependenceModel.html#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For the gamma distributions, use</span></span>
<span id="cb266-2"><a href="ChapDependenceModel.html#cb266-2" aria-hidden="true" tabindex="-1"></a>alpha1 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb266-3"><a href="ChapDependenceModel.html#cb266-3" aria-hidden="true" tabindex="-1"></a>theta1 <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb266-4"><a href="ChapDependenceModel.html#cb266-4" aria-hidden="true" tabindex="-1"></a>alpha2 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb266-5"><a href="ChapDependenceModel.html#cb266-5" aria-hidden="true" tabindex="-1"></a>theta2 <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb266-6"><a href="ChapDependenceModel.html#cb266-6" aria-hidden="true" tabindex="-1"></a><span class="co"># For the Pareto distributions, use</span></span>
<span id="cb266-7"><a href="ChapDependenceModel.html#cb266-7" aria-hidden="true" tabindex="-1"></a>alpha3 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb266-8"><a href="ChapDependenceModel.html#cb266-8" aria-hidden="true" tabindex="-1"></a>theta3 <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb266-9"><a href="ChapDependenceModel.html#cb266-9" aria-hidden="true" tabindex="-1"></a>alpha4 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb266-10"><a href="ChapDependenceModel.html#cb266-10" aria-hidden="true" tabindex="-1"></a>theta4 <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb266-11"><a href="ChapDependenceModel.html#cb266-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Deductibles</span></span>
<span id="cb266-12"><a href="ChapDependenceModel.html#cb266-12" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb266-13"><a href="ChapDependenceModel.html#cb266-13" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb266-14"><a href="ChapDependenceModel.html#cb266-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-15"><a href="ChapDependenceModel.html#cb266-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-16"><a href="ChapDependenceModel.html#cb266-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate the risks</span></span>
<span id="cb266-17"><a href="ChapDependenceModel.html#cb266-17" aria-hidden="true" tabindex="-1"></a>nSim <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co">#number of simulations</span></span>
<span id="cb266-18"><a href="ChapDependenceModel.html#cb266-18" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2017</span>)  <span class="co">#set seed to reproduce work </span></span>
<span id="cb266-19"><a href="ChapDependenceModel.html#cb266-19" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(nSim, alpha1, <span class="at">scale =</span> theta1)</span>
<span id="cb266-20"><a href="ChapDependenceModel.html#cb266-20" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(nSim, alpha2, <span class="at">scale =</span> theta2)</span>
<span id="cb266-21"><a href="ChapDependenceModel.html#cb266-21" aria-hidden="true" tabindex="-1"></a><span class="co"># For the Pareto Distribution, use</span></span>
<span id="cb266-22"><a href="ChapDependenceModel.html#cb266-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VGAM)</span>
<span id="cb266-23"><a href="ChapDependenceModel.html#cb266-23" aria-hidden="true" tabindex="-1"></a>X3 <span class="ot">&lt;-</span> <span class="fu">rparetoII</span>(nSim, <span class="at">scale =</span> theta3, <span class="at">shape =</span> alpha3)</span>
<span id="cb266-24"><a href="ChapDependenceModel.html#cb266-24" aria-hidden="true" tabindex="-1"></a>X4 <span class="ot">&lt;-</span> <span class="fu">rparetoII</span>(nSim, <span class="at">scale =</span> theta4, <span class="at">shape =</span> alpha4)</span>
<span id="cb266-25"><a href="ChapDependenceModel.html#cb266-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Portfolio Risks</span></span>
<span id="cb266-26"><a href="ChapDependenceModel.html#cb266-26" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> X3 <span class="sc">+</span> X4</span>
<span id="cb266-27"><a href="ChapDependenceModel.html#cb266-27" aria-hidden="true" tabindex="-1"></a>Sretained <span class="ot">&lt;-</span> <span class="fu">pmin</span>(X1, d1) <span class="sc">+</span> <span class="fu">pmin</span>(X2, d2)</span>
<span id="cb266-28"><a href="ChapDependenceModel.html#cb266-28" aria-hidden="true" tabindex="-1"></a>Sinsurer <span class="ot">&lt;-</span> S <span class="sc">-</span> Sretained</span>
<span id="cb266-29"><a href="ChapDependenceModel.html#cb266-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-30"><a href="ChapDependenceModel.html#cb266-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Expected Claim Amounts</span></span>
<span id="cb266-31"><a href="ChapDependenceModel.html#cb266-31" aria-hidden="true" tabindex="-1"></a>ExpVec <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">mean</span>(Sretained), <span class="fu">mean</span>(Sinsurer), <span class="fu">mean</span>(S))))</span>
<span id="cb266-32"><a href="ChapDependenceModel.html#cb266-32" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ExpVec) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Retained&quot;</span>, <span class="st">&quot;Insurer&quot;</span>, <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb266-33"><a href="ChapDependenceModel.html#cb266-33" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(ExpVec, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb266-34"><a href="ChapDependenceModel.html#cb266-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-35"><a href="ChapDependenceModel.html#cb266-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Quantiles</span></span>
<span id="cb266-36"><a href="ChapDependenceModel.html#cb266-36" aria-hidden="true" tabindex="-1"></a>quantMat <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">quantile</span>(Sretained, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span>)), <span class="fu">quantile</span>(Sinsurer,</span>
<span id="cb266-37"><a href="ChapDependenceModel.html#cb266-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span>)), <span class="fu">quantile</span>(S, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span>)))</span>
<span id="cb266-38"><a href="ChapDependenceModel.html#cb266-38" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(quantMat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Retained&quot;</span>, <span class="st">&quot;Insurer&quot;</span>, <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb266-39"><a href="ChapDependenceModel.html#cb266-39" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(quantMat, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb266-40"><a href="ChapDependenceModel.html#cb266-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-41"><a href="ChapDependenceModel.html#cb266-41" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(S), <span class="at">main =</span> <span class="st">&quot;Density of Total Portfolio Risk S&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;S&quot;</span>)</span>
<span id="cb266-42"><a href="ChapDependenceModel.html#cb266-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-43"><a href="ChapDependenceModel.html#cb266-43" aria-hidden="true" tabindex="-1"></a><span class="do">### Normal Copula ##</span></span>
<span id="cb266-44"><a href="ChapDependenceModel.html#cb266-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(VGAM)</span>
<span id="cb266-45"><a href="ChapDependenceModel.html#cb266-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(copula)</span>
<span id="cb266-46"><a href="ChapDependenceModel.html#cb266-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GB2)</span>
<span id="cb266-47"><a href="ChapDependenceModel.html#cb266-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statmod)</span>
<span id="cb266-48"><a href="ChapDependenceModel.html#cb266-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(numDeriv)</span>
<span id="cb266-49"><a href="ChapDependenceModel.html#cb266-49" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2017</span>)</span>
<span id="cb266-50"><a href="ChapDependenceModel.html#cb266-50" aria-hidden="true" tabindex="-1"></a>parm <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>)</span>
<span id="cb266-51"><a href="ChapDependenceModel.html#cb266-51" aria-hidden="true" tabindex="-1"></a>nc <span class="ot">&lt;-</span> <span class="fu">normalCopula</span>(parm, <span class="at">dim =</span> <span class="dv">4</span>, <span class="at">dispstr =</span> <span class="st">&quot;un&quot;</span>)</span>
<span id="cb266-52"><a href="ChapDependenceModel.html#cb266-52" aria-hidden="true" tabindex="-1"></a>mcc <span class="ot">&lt;-</span> <span class="fu">mvdc</span>(nc, <span class="at">margins =</span> <span class="fu">c</span>(<span class="st">&quot;gamma&quot;</span>, <span class="st">&quot;gamma&quot;</span>, <span class="st">&quot;paretoII&quot;</span>, <span class="st">&quot;paretoII&quot;</span>), <span class="at">paramMargins =</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">scale =</span> theta1,</span>
<span id="cb266-53"><a href="ChapDependenceModel.html#cb266-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> alpha1), <span class="fu">list</span>(<span class="at">scale =</span> theta2, <span class="at">shape =</span> alpha2), <span class="fu">list</span>(<span class="at">scale =</span> theta3, <span class="at">shape =</span> alpha3),</span>
<span id="cb266-54"><a href="ChapDependenceModel.html#cb266-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">scale =</span> theta4, <span class="at">shape =</span> alpha4)))</span>
<span id="cb266-55"><a href="ChapDependenceModel.html#cb266-55" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rMvdc</span>(nSim, <span class="at">mvdc =</span> mcc)</span>
<span id="cb266-56"><a href="ChapDependenceModel.html#cb266-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-57"><a href="ChapDependenceModel.html#cb266-57" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> X[, <span class="dv">1</span>]</span>
<span id="cb266-58"><a href="ChapDependenceModel.html#cb266-58" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> X[, <span class="dv">2</span>]</span>
<span id="cb266-59"><a href="ChapDependenceModel.html#cb266-59" aria-hidden="true" tabindex="-1"></a>X3 <span class="ot">&lt;-</span> X[, <span class="dv">3</span>]</span>
<span id="cb266-60"><a href="ChapDependenceModel.html#cb266-60" aria-hidden="true" tabindex="-1"></a>X4 <span class="ot">&lt;-</span> X[, <span class="dv">4</span>]</span>
<span id="cb266-61"><a href="ChapDependenceModel.html#cb266-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-62"><a href="ChapDependenceModel.html#cb266-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Portfolio Risks</span></span>
<span id="cb266-63"><a href="ChapDependenceModel.html#cb266-63" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> X3 <span class="sc">+</span> X4</span>
<span id="cb266-64"><a href="ChapDependenceModel.html#cb266-64" aria-hidden="true" tabindex="-1"></a>Sretained <span class="ot">&lt;-</span> <span class="fu">pmin</span>(X1, d1) <span class="sc">+</span> <span class="fu">pmin</span>(X2, d2)</span>
<span id="cb266-65"><a href="ChapDependenceModel.html#cb266-65" aria-hidden="true" tabindex="-1"></a>Sinsurer <span class="ot">&lt;-</span> S <span class="sc">-</span> Sretained</span>
<span id="cb266-66"><a href="ChapDependenceModel.html#cb266-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-67"><a href="ChapDependenceModel.html#cb266-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Expected Claim Amounts</span></span>
<span id="cb266-68"><a href="ChapDependenceModel.html#cb266-68" aria-hidden="true" tabindex="-1"></a>ExpVec <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">mean</span>(Sretained), <span class="fu">mean</span>(Sinsurer), <span class="fu">mean</span>(S))))</span>
<span id="cb266-69"><a href="ChapDependenceModel.html#cb266-69" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ExpVec) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Retained&quot;</span>, <span class="st">&quot;Insurer&quot;</span>, <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb266-70"><a href="ChapDependenceModel.html#cb266-70" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(ExpVec, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb266-71"><a href="ChapDependenceModel.html#cb266-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-72"><a href="ChapDependenceModel.html#cb266-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Quantiles</span></span>
<span id="cb266-73"><a href="ChapDependenceModel.html#cb266-73" aria-hidden="true" tabindex="-1"></a>quantMat <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">quantile</span>(Sretained, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span>)), <span class="fu">quantile</span>(Sinsurer,</span>
<span id="cb266-74"><a href="ChapDependenceModel.html#cb266-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span>)), <span class="fu">quantile</span>(S, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.95</span>, <span class="fl">0.99</span>)))</span>
<span id="cb266-75"><a href="ChapDependenceModel.html#cb266-75" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(quantMat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Retained&quot;</span>, <span class="st">&quot;Insurer&quot;</span>, <span class="st">&quot;Total&quot;</span>)</span>
<span id="cb266-76"><a href="ChapDependenceModel.html#cb266-76" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(quantMat, <span class="at">digits =</span> <span class="dv">2</span>)</span>
<span id="cb266-77"><a href="ChapDependenceModel.html#cb266-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-78"><a href="ChapDependenceModel.html#cb266-78" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(S), <span class="at">main =</span> <span class="st">&quot;Density of Total Portfolio Risk S&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;S&quot;</span>)</span></code></pre></div>
</div>
<div id="surveyElement146">

</div>
<div id="surveyResult146">

</div>
<h5 style="text-align: center;">
<a id="display.Quiz146.1" href="javascript:toggleQuiz
('display.Quiz146.2','display.Quiz146.1');"><i><strong>Show Quiz Solution</strong></i></a>
</h5>
<div id="display.Quiz146.2" style="display: none">
<p id="Quiz146Soln">
</p>
<hr />
</div>
<script type="text/javascript" src="./Quizzes/QuizJavascript/Quiz146.js">
</script>
</div>
<div id="Dep:further-reading-and-resources" class="section level2 hasAnchor" number="16.7">
<h2><span class="header-section-number">16.7</span> Further Resources and Contributors<a href="ChapDependenceModel.html#Dep:further-reading-and-resources" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="contributors-12" class="section level4 unnumbered hasAnchor">
<h4>Contributors<a href="ChapDependenceModel.html#contributors-12" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><strong>Edward W. (Jed) Frees</strong> and <strong>Nii-Armah Okine</strong>, University of Wisconsin-Madison, and <strong>Emine Selin Sarıdaş</strong>, Mimar Sinan University, are the principal authors of the initial version of this chapter. Email: <a href="mailto:jfrees@bus.wisc.edu" class="email">jfrees@bus.wisc.edu</a> for chapter comments and suggested improvements.</li>
<li>Chapter reviewers include: Runhuan Feng, Fei Huang, Himchan Jeong, Min Ji, and Toby White.</li>
</ul>
</div>
<div id="ts-15.a.-other-classic-measures-of-scalar-associations" class="section level3 unnumbered hasAnchor">
<h3>TS 15.A. Other Classic Measures of Scalar Associations<a href="ChapDependenceModel.html#ts-15.a.-other-classic-measures-of-scalar-associations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="ts-15.a.1.-blomqvists-beta" class="section level4 unnumbered hasAnchor">
<h4>TS 15.A.1. Blomqvist’s Beta<a href="ChapDependenceModel.html#ts-15.a.1.-blomqvists-beta" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="citation"><a href="#ref-blomqvist1950measure" role="doc-biblioref">Blomqvist</a> (<a href="#ref-blomqvist1950measure" role="doc-biblioref">1950</a>)</span> developed a measure of dependence now known as <a href="#" class="tooltip" style="color:green"><em>Blomqvist’s beta</em><span style="font-size:8pt"></span></a>, also called the <em>median concordance coefficient</em> and the <em>medial correlation coefficient</em>. Using distribution functions, this parameter can be expressed as</p>
<p><span class="math display">\[\begin{equation*}
\beta_B = 4F\left(F^{-1}_X(1/2),F^{-1}_Y(1/2) \right) - 1.
\end{equation*}\]</span></p>
<p>That is, first evaluate each marginal at its median (<span class="math inline">\(F^{-1}_X(1/2)\)</span> and <span class="math inline">\(F^{-1}_Y(1/2)\)</span>, respectively). Then, evaluate the bivariate distribution function at the two medians. After rescaling (multiplying by 4 and subtracting 1), the coefficient turns out to have a range of <span class="math inline">\([-1,1]\)</span>, where 0 occurs under independence.</p>
<p>Like Spearman’s rho and Kendall’s tau, an estimator based on ranks is easy to provide. First write <span class="math inline">\(\beta_B = 4C(1/2,1/2)-1 = 2\Pr((U_1-1/2)(U_2-1/2))-1\)</span> where <span class="math inline">\(U_1, U_2\)</span> are uniform random variables. Then, define</p>
<p><span class="math display">\[
\hat{\beta}_B = \frac{2}{n} \sum_{i=1}^n I\left( (R(X_{i})-\frac{n+1}{2})(R(Y_{i})-\frac{n+1}{2}) \ge 0 \right)-1 .
\]</span></p>
<p>See, for example, <span class="citation"><a href="#ref-joe2014dependence" role="doc-biblioref">Joe</a> (<a href="#ref-joe2014dependence" role="doc-biblioref">2014</a>)</span>, page 57 or <span class="citation"><a href="#ref-hougaard2000analysis" role="doc-biblioref">Hougaard</a> (<a href="#ref-hougaard2000analysis" role="doc-biblioref">2000</a>)</span>, page 135, for more details.</p>
<p>Because Blomqvist’s parameter is based on the center of the distribution, it is particularly useful when data are censored; in this case, information in extreme parts of the distribution are not always reliable. How does this affect a choice of association measures? First, recall that association measures are based on a bivariate distribution function. So, if one has knowledge of a good approximation of the distribution function, then calculation of an association measure is straightforward in principle. Second, for censored data, bivariate extensions of the univariate Kaplan-Meier distribution function estimator are available. For example, the version introduced in <span class="citation"><a href="#ref-dabrowska1988kaplan" role="doc-biblioref">Dabrowska</a> (<a href="#ref-dabrowska1988kaplan" role="doc-biblioref">1988</a>)</span> is appealing. However, because of instances when large masses of data appear at the upper range of the data, this and other estimators of the bivariate distribution function are unreliable. This means that, summary measures of the estimated distribution function based on Spearman’s rho or Kendall’s tau can be unreliable. For this situation, Blomqvist’s beta appears to be a better choice as it focuses on the center of the distribution. <span class="citation"><a href="#ref-hougaard2000analysis" role="doc-biblioref">Hougaard</a> (<a href="#ref-hougaard2000analysis" role="doc-biblioref">2000</a>)</span>, Chapter 14, provides additional discussion.</p>
<p>You can obtain the Blomqvist’s beta, using the <code>betan()</code> function from the <code>copula</code> library in <code>R</code>. From below, <span class="math inline">\(\beta_B=0.3\)</span> between the <span class="math inline">\({\tt Coverage}\)</span> rating variable in millions of dollars and <span class="math inline">\({\tt Claim}\)</span> amount variable in dollars.</p>
<h5 style="text-align: center;">
<a id="displayCode.beta.1" href="javascript:togglecode('toggleCode.beta.1','displayCode.beta.1');"><i><strong>R Code for Blomqvist’s Beta</strong></i></a>
</h5>
<div id="toggleCode.beta.1" style="display: none">
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="ChapDependenceModel.html#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Blomqvist&#39;s beta correlation between Claim and Coverage </span><span class="al">###</span></span>
<span id="cb267-2"><a href="ChapDependenceModel.html#cb267-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(copula)</span>
<span id="cb267-3"><a href="ChapDependenceModel.html#cb267-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">length</span>(Claim)</span>
<span id="cb267-4"><a href="ChapDependenceModel.html#cb267-4" aria-hidden="true" tabindex="-1"></a>U<span class="ot">&lt;-</span><span class="fu">cbind</span>(((n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>n<span class="sc">*</span><span class="fu">pobs</span>(Claim)),((n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>n<span class="sc">*</span><span class="fu">pobs</span>(Coverage)))</span>
<span id="cb267-5"><a href="ChapDependenceModel.html#cb267-5" aria-hidden="true" tabindex="-1"></a>beta<span class="ot">&lt;-</span><span class="fu">betan</span>(U, <span class="at">scaling=</span><span class="cn">FALSE</span>)</span>
<span id="cb267-6"><a href="ChapDependenceModel.html#cb267-6" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(beta,<span class="dv">2</span>)</span>
<span id="cb267-7"><a href="ChapDependenceModel.html#cb267-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-8"><a href="ChapDependenceModel.html#cb267-8" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span></span>
<span id="cb267-9"><a href="ChapDependenceModel.html#cb267-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]  <span class="fl">0.3</span></span>
<span id="cb267-10"><a href="ChapDependenceModel.html#cb267-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-11"><a href="ChapDependenceModel.html#cb267-11" aria-hidden="true" tabindex="-1"></a><span class="do">### Blomqvist&#39;s beta correlation between Claim and log(Coverage) </span><span class="al">###</span></span>
<span id="cb267-12"><a href="ChapDependenceModel.html#cb267-12" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">length</span>(Claim)</span>
<span id="cb267-13"><a href="ChapDependenceModel.html#cb267-13" aria-hidden="true" tabindex="-1"></a>Fx<span class="ot">&lt;-</span><span class="fu">cbind</span>(((n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>n<span class="sc">*</span><span class="fu">pobs</span>(Claim)),((n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>n<span class="sc">*</span><span class="fu">pobs</span>(<span class="fu">log</span>(Coverage))))</span>
<span id="cb267-14"><a href="ChapDependenceModel.html#cb267-14" aria-hidden="true" tabindex="-1"></a>beta<span class="ot">&lt;-</span><span class="fu">betan</span>(Fx, <span class="at">scaling=</span><span class="cn">FALSE</span>)</span>
<span id="cb267-15"><a href="ChapDependenceModel.html#cb267-15" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(beta,<span class="dv">2</span>)</span>
<span id="cb267-16"><a href="ChapDependenceModel.html#cb267-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-17"><a href="ChapDependenceModel.html#cb267-17" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span></span>
<span id="cb267-18"><a href="ChapDependenceModel.html#cb267-18" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>]  <span class="fl">0.3</span></span></code></pre></div>
</div>
<p>In addition, to show that the Blomqvist’s beta is invariant under strictly increasing transformations, <span class="math inline">\(\beta_B=0.3\)</span> between the <span class="math inline">\({\tt Coverage}\)</span> rating variable in logarithmic millions of dollars and <span class="math inline">\({\tt Claim}\)</span> amount variable in dollars.</p>
</div>
<div id="ts-15.a.2.-nonparametric-approach-using-spearman-correlation-with-tied-ranks" class="section level4 unnumbered hasAnchor">
<h4>TS 15.A.2. Nonparametric Approach Using Spearman Correlation with Tied Ranks<a href="ChapDependenceModel.html#ts-15.a.2.-nonparametric-approach-using-spearman-correlation-with-tied-ranks" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For the first variable, the average rank of observations in the <span class="math inline">\(s\)</span>th row is</p>
<p><span class="math display">\[\begin{equation*}
r_{1s} = n_{m_1\centerdot}+ \cdots+ n_{s-1,\centerdot}+ \frac{1}{2} \left(1+ n_{s\centerdot}\right)
\end{equation*}\]</span>
and similarly <span class="math inline">\(r_{2t} = \frac{1}{2} \left[(n_{\centerdot m_1}+ \cdots+ n_{\centerdot,s-1}+1)+ (n_{\centerdot m_1}+ \cdots+ n_{\centerdot s})\right]\)</span>. With this, we have Spearman’s rho with tied rank is
<span class="math display">\[\begin{equation*}
\hat{\rho}_S = \frac{\sum_{s=m_1}^{m_2} \sum_{t=m_1}^{m_2} n_{st}(r_{1s} - \bar{r})(r_{2t} - \bar{r})}
{\left[\sum_{s=m_1}^{m_2}n_{s \centerdot}(r_{1s} - \bar{r})^2 \sum_{t=m_1}^{m_2} n_{\centerdot t}(r_{2t} - \bar{r})^2
\right]^2}
\end{equation*}\]</span></p>
<p>where the average rank is <span class="math inline">\(\bar{r} = (n+1)/2\)</span>.</p>
<h5 style="text-align: center;">
<a id="displayCode.Thry.1" href="javascript:togglecode('toggleCode.Thry.1','displayCode.Thry.1');"><i><strong>Click to Show Proof for Special Case: Binary Data.</strong></i></a>
</h5>
<div id="toggleCode.Thry.1" style="display: none">
<p>Special Case: Binary Data. Here, <span class="math inline">\(m_1=0\)</span> and <span class="math inline">\(m_2=1\)</span>. For the first variable ranks, we have <span class="math inline">\(r_{10} = (1+n_{0\centerdot})/2\)</span> and <span class="math inline">\(r_{11} = (n_{0\centerdot}+1+n)/2\)</span>. Thus, <span class="math inline">\(r_{10} -\bar{r}= (n_{0\centerdot}-n)/2\)</span> and <span class="math inline">\(r_{11}-\bar{r} = n_{0\centerdot}/2\)</span>.
This means that we have <span class="math inline">\(\sum_{s=0}^{1}n_{s\centerdot}(r_{1s} - \bar{r})^2 = n (n-n_{0\centerdot})n_{0\centerdot}/4\)</span> and similarly for the second variable. For the numerator, we have
<span class="math display">\[\begin{eqnarray*}
\sum_{s=0}^{1}  \sum_{t=0}^{1} &amp;&amp; n_{st}(r_{1s} - \bar{r})(r_{2t} - \bar{r})\\
&amp;=&amp; n_{00} \frac{n_{0\centerdot}-n}{2} \frac{n_{\centerdot 0}-n}{2}
+n_{01} \frac{n_{0\centerdot}-n}{2} \frac{n_{\centerdot 0}}{2}
+n_{10} \frac{n_{0\centerdot}}{2} \frac{n_{\centerdot 0}-n}{2}
+n_{11} \frac{n_{0\centerdot}}{2} \frac{n_{\centerdot 0}}{2} \\
&amp;=&amp; \frac{1}{4}(n_{00} (n_{0\centerdot}-n) (n_{\centerdot 0}-n)
+(n_{0\centerdot}-n_{00}) (n_{0\centerdot}-n)n_{\centerdot 0} \\
&amp;&amp;  ~ ~ ~ +(n_{\centerdot 0}-n_{00})  n_{0\centerdot}(n_{\centerdot 0}-n)
+(n-n_{\centerdot 0}-n_{0\centerdot}+n_{00}) n_{0\centerdot}n_{\centerdot 0} ) \\
&amp;=&amp; \frac{1}{4}(n_{00} n^2
- n_{0\centerdot} (n_{0\centerdot}-n)n_{\centerdot 0} \\
&amp;&amp; ~ ~ ~ +n_{\centerdot 0}  n_{0\centerdot}(n_{\centerdot 0}-n)
+(n-n_{\centerdot 0}-n_{0\centerdot}) n_{0\centerdot}n_{\centerdot 0} ) \\
&amp;=&amp; \frac{1}{4}(n_{00} n^2
- n_{0\centerdot}n_{\centerdot 0} (n_{0\centerdot}-n +n_{\centerdot 0}-n
+n-n_{\centerdot 0}-n_{0\centerdot}) \\
&amp;=&amp; \frac{n}{4}(n n_{00} - n_{0\centerdot}n_{\centerdot 0}) .
\end{eqnarray*}\]</span></p>
<p>This yields
<span class="math display">\[\begin{eqnarray*}
\hat{\rho}_S &amp;=&amp; \frac{n(n n_{00} - n_{0\centerdot}n_{\centerdot 0})}
{4\sqrt{(n (n-n_{0\centerdot})n_{0\centerdot}/4)(n (n-n_{\centerdot 0})n_{\centerdot 0}/4)}} \\
&amp;=&amp; \frac{n n_{00} - n_{0\centerdot}n_{\centerdot 0}}
{\sqrt{ n_{0\centerdot} n_{\centerdot 0}(n-n_{0\centerdot}) (n-n_{\centerdot 0})}} \\
&amp;=&amp; \frac{n_{00} - n (1-\hat{\pi}_X)(1- \hat{\pi}_Y)}
{\sqrt{\hat{\pi}_X(1-\hat{\pi}_X)\hat{\pi}_Y(1-\hat{\pi}_Y) }}
\end{eqnarray*}\]</span>
where <span class="math inline">\(\hat{\pi}_X = (n-n_{0\centerdot})/n\)</span> and similarly for <span class="math inline">\(\hat{\pi}_Y\)</span>. Note that this is same form as the Pearson measure. From this, we see that the joint count <span class="math inline">\(n_{00}\)</span> drives this association measure.</p>
</div>
<p>You can obtain the ties-corrected Spearman correlation statistic <span class="math inline">\(r_S\)</span> using the <code>cor()</code> function in <code>R</code> and selecting the <code>spearman</code> method. From below <span class="math inline">\(\hat{\rho}_S=-0.09\)</span>.</p>
<h5 style="text-align: center;">
<a id="displayCode.spearT.1" href="javascript:togglecode('toggleCode.spearT.1','displayCode.spearT.1');"><i><strong>R Code for Ties-corrected Spearman Correlation</strong></i></a>
</h5>
<div id="toggleCode.spearT.1" style="display: none">
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="ChapDependenceModel.html#cb268-1" aria-hidden="true" tabindex="-1"></a>rs_ties<span class="ot">&lt;-</span><span class="fu">cor</span>(AlarmCredit,NoClaimCredit, <span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;spearman&quot;</span>))</span>
<span id="cb268-2"><a href="ChapDependenceModel.html#cb268-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(rs_ties,<span class="dv">2</span>)</span>
<span id="cb268-3"><a href="ChapDependenceModel.html#cb268-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-4"><a href="ChapDependenceModel.html#cb268-4" aria-hidden="true" tabindex="-1"></a>Output<span class="sc">:</span></span>
<span id="cb268-5"><a href="ChapDependenceModel.html#cb268-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="sc">-</span><span class="fl">0.09</span></span></code></pre></div>
</div>

</div>
</div>
</div>
</div>
<h3>Bibliography<a href="bibliography.html#bibliography" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-bishop1975discrete" class="csl-entry">
Bishop, Yvonne M., Stephen E. Fienberg, and Paul W. Holland. 1975. <em>Discrete Multivariate Analysis: Theory and Practice</em>. Cambridge [etc.]: MIT.
</div>
<div id="ref-blomqvist1950measure" class="csl-entry">
Blomqvist, Nils. 1950. <span>“On a Measure of Dependence Between Two Random Variables.”</span> <em>The Annals of Mathematical Statistic</em>, 593–600.
</div>
<div id="ref-dabrowska1988kaplan" class="csl-entry">
Dabrowska, Dorota M. 1988. <span>“Kaplan-Meier Estimate on the Plane.”</span> <em>The Annals of Statistics</em>, 1475–89.
</div>
<div id="ref-fechnerkollektivmasslehre" class="csl-entry">
Fechner, G. T. 1897. <span>“Kollektivmasslehre.”</span> <em>Wilhelm Englemann, Leipzig</em>.
</div>
<div id="ref-frank1979simultaneous" class="csl-entry">
Frank, Maurice J. 1979. <span>“On the Simultaneous Associativity of f(x, y) and x+y-f(x, y).”</span> <em>Aequationes Mathematicae</em> 19 (1): 194–226.
</div>
<div id="ref-frees1998understanding" class="csl-entry">
Frees, Edward W., and Emiliano A. Valdez. 1998. <span>“Understanding Relationships Using Copulas.”</span> <em>North American Actuarial Journal</em> 2 (01): 1–25.
</div>
<div id="ref-genest1986bivariate" class="csl-entry">
Genest, Christian, and Josh Mackay. 1986. <span>“The Joy of Copulas: Bivariate Distributions with Uniform Marginals.”</span> <em>The American Statistician</em> 40: 280–83.
</div>
<div id="ref-genest2007methods" class="csl-entry">
Genest, Christian, and Johanna Nešlohva. 2007. <span>“A Primer on Copulas for Count Data.”</span> <em>Journal of the Royal Statistical Society</em>, 475–515.
</div>
<div id="ref-hettmansperger1984statistical" class="csl-entry">
Hettmansperger, T. P. 1984. <em>Statistical Inference Based on Ranks</em>. Wiley.
</div>
<div id="ref-hofertelements" class="csl-entry">
Hofert, Marius, Ivan Kojadinovic, Martin Mächler, and Jun Yan. 2018. <em>Elements of Copula Modeling with r</em>. Springer.
</div>
<div id="ref-hougaard2000analysis" class="csl-entry">
Hougaard, P. 2000. <em>Analysis of Multivariate Survival Data</em>. Springer New York.
</div>
<div id="ref-joe2014dependence" class="csl-entry">
Joe, Harry. 2014. <em>Dependence Modeling with Copulas</em>. CRC Press.
</div>
<div id="ref-kendall1945" class="csl-entry">
Kendall, M. G. 1945. <span>“The Treatment of Ties in Ranking Problems.”</span> <em>Biometrika</em> 33(3): 239–51.
</div>
<div id="ref-kendall1938new" class="csl-entry">
Kendall, Maurice G. 1938. <span>“A New Measure of Rank Correlation.”</span> <em>Biometrika</em>, 81–93.
</div>
<div id="ref-lee1988thirteen" class="csl-entry">
Lee Rodgers, J, and W. A Nicewander. 1998. <span>“Thirteen Ways to Look at the Correlation Coeffeicient.”</span> <em>The American Statistician</em> 42 (01): 59–66.
</div>
<div id="ref-nelsen1997introduction" class="csl-entry">
Nelson, Roger B. 1997. <em>An Introduction to Copulas</em>. Lecture Notes in Statistics 139.
</div>
<div id="ref-schweizer1981nonparametric" class="csl-entry">
Schweizer, Berthold, Edward F Wolff, and others. 1981. <span>“On Nonparametric Measures of Dependence for Random Variables.”</span> <em>The Annals of Statistics</em> 9 (4): 879–85.
</div>
<div id="ref-sklar1959fonctions" class="csl-entry">
Sklar, M. 1959. <span>“Fonctions de Repartition a n Dimensions Et Leurs Marges.”</span> <em>Publ. Inst. Statist. Univ. Paris</em> 8: 229–31.
</div>
<div id="ref-spearman1904proof" class="csl-entry">
Spearman, C. 1904. <span>“The Proof and Measurement of Association Between Two Things.”</span> <em>The American Journal of Psychology</em> 15 (01): 72–101.
</div>
<div id="ref-venter2002tails" class="csl-entry">
Venter, Gary G. 2002. <span>“Tails of Copulas.”</span> In <em>Proceedings of the Casualty Actuarial Society</em>, 89:68–113. 171.
</div>
<div id="ref-yule1900association" class="csl-entry">
Yule, G. Udny. 1900. <span>“On the Association of Attributes in Statistics: With Illustrations from the Material of the Childhood Society.”</span> <em>Philosophical Transactions of the Royal Society of London. Series A, Containing Papers of a Mathematical or Physical Character</em>, 257–319.
</div>
<div id="ref-yule1912methods" class="csl-entry">
———. 1912. <span>“On the Methods of Measuring Association Between Two Attributes.”</span> <em>Journal of the Royal Statistical Society</em>, 579–652.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ChapBonusMalus.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="CAppA.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["LossDataAnalytics.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
